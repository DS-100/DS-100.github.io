<!DOCTYPE html>
<html>
<head>
  <meta name="databricks-html-version" content="1">
<title>Linear Regression - Databricks</title>

<meta charset="utf-8">
<meta name="google" content="notranslate">
<meta name="robots" content="nofollow">
<meta http-equiv="Content-Language" content="en">
<meta http-equiv="Content-Type" content="text/html; charset=UTF8">
<link rel="stylesheet"
  href="https://fonts.googleapis.com/css?family=Source+Code+Pro:400,700">

<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/lib/css/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/lib/jquery-ui-bundle/jquery-ui.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/css/main.css">
<link rel="stylesheet" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/css/print.css" media="print">
<link rel="icon" type="image/png" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/img/favicon.ico"/>
<script>window.settings = {"enableSshKeyUI":false,"defaultInteractivePricePerDBU":0.4,"enableOnDemandClusterType":true,"enableAutoCompleteAsYouType":[],"devTierName":"Community Edition","enableJobsPrefetching":true,"workspaceFeaturedLinks":[{"linkURI":"https://docs.databricks.com/index.html","displayName":"Documentation","icon":"question"},{"linkURI":"https://docs.databricks.com/release-notes/product/index.html","displayName":"Release Notes","icon":"code"},{"linkURI":"https://docs.databricks.com/spark/latest/training/index.html","displayName":"Training & Tutorials","icon":"graduation-cap"}],"enableClearStateFeature":false,"dbcForumURL":"http://forums.databricks.com/","enableProtoClusterInfoDeltaPublisher":true,"maxCustomTags":45,"enableInstanceProfilesUIInJobs":true,"nodeInfo":{"node_types":[{"support_ssh":false,"spark_heap_memory":4800,"instance_type_id":"r3.2xlarge","spark_core_oversubscription_factor":8.0,"node_type_id":"dev-tier-node","description":"Community Optimized","support_cluster_tags":false,"container_memory_mb":6000,"node_instance_type":{"instance_type_id":"r3.2xlarge","provider":"AWS","compute_units":26.0,"number_of_ips":15,"local_disks":1,"reserved_compute_units":3.64,"memory_mb":62464,"num_cores":8,"reserved_memory_mb":4800},"memory_mb":6144,"is_hidden":false,"category":"Community Edition","num_cores":0.88,"support_ebs_volumes":false,"is_deprecated":false}],"default_node_type_id":"dev-tier-node"},"enableClusterAcls":true,"notebookRevisionVisibilityHorizon":999999,"enableTableHandler":true,"maxEbsVolumesPerInstance":10,"isAdmin":true,"deltaProcessingBatchSize":1000,"enableLargeResultDownload":true,"zoneInfos":[{"id":"us-west-2c","isDefault":true},{"id":"us-west-2b","isDefault":false},{"id":"us-west-2a","isDefault":false}],"enableCustomSpotPricingUIByTier":false,"enableEBSVolumesUIForJobs":true,"enablePublishNotebooks":true,"enableMaxConcurrentRuns":true,"enableJobAclsConfig":false,"enableFullTextSearch":false,"enableElasticSparkUI":false,"enableNewClustersCreate":true,"clusters":true,"allowRunOnPendingClusters":true,"fileStoreBase":"FileStore","enableSshKeyUIInJobs":true,"enableDetachAndAttachSubMenu":false,"configurableSparkOptionsSpec":[{"keyPattern":"spark\\.kryo(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.kryo.*","valuePatternDisplay":"*","description":"Configuration options for Kryo serialization"},{"keyPattern":"spark\\.io\\.compression\\.codec","valuePattern":"(lzf|snappy|org\\.apache\\.spark\\.io\\.LZFCompressionCodec|org\\.apache\\.spark\\.io\\.SnappyCompressionCodec)","keyPatternDisplay":"spark.io.compression.codec","valuePatternDisplay":"snappy|lzf","description":"The codec used to compress internal data such as RDD partitions, broadcast variables and shuffle outputs."},{"keyPattern":"spark\\.serializer","valuePattern":"(org\\.apache\\.spark\\.serializer\\.JavaSerializer|org\\.apache\\.spark\\.serializer\\.KryoSerializer)","keyPatternDisplay":"spark.serializer","valuePatternDisplay":"org.apache.spark.serializer.JavaSerializer|org.apache.spark.serializer.KryoSerializer","description":"Class to use for serializing objects that will be sent over the network or need to be cached in serialized form."},{"keyPattern":"spark\\.rdd\\.compress","valuePattern":"(true|false)","keyPatternDisplay":"spark.rdd.compress","valuePatternDisplay":"true|false","description":"Whether to compress serialized RDD partitions (e.g. for StorageLevel.MEMORY_ONLY_SER). Can save substantial space at the cost of some extra CPU time."},{"keyPattern":"spark\\.speculation","valuePattern":"(true|false)","keyPatternDisplay":"spark.speculation","valuePatternDisplay":"true|false","description":"Whether to use speculation (recommended off for streaming)"},{"keyPattern":"spark\\.es(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"es(\\.([^\\.]+))+","valuePattern":".*","keyPatternDisplay":"es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"spark\\.(storage|shuffle)\\.memoryFraction","valuePattern":"0?\\.0*([1-9])([0-9])*","keyPatternDisplay":"spark.(storage|shuffle).memoryFraction","valuePatternDisplay":"(0.0,1.0)","description":"Fraction of Java heap to use for Spark's shuffle or storage"},{"keyPattern":"spark\\.streaming\\.backpressure\\.enabled","valuePattern":"(true|false)","keyPatternDisplay":"spark.streaming.backpressure.enabled","valuePatternDisplay":"true|false","description":"Enables or disables Spark Streaming's internal backpressure mechanism (since 1.5). This enables the Spark Streaming to control the receiving rate based on the current batch scheduling delays and processing times so that the system receives only as fast as the system can process. Internally, this dynamically sets the maximum receiving rate of receivers. This rate is upper bounded by the values `spark.streaming.receiver.maxRate` and `spark.streaming.kafka.maxRatePerPartition` if they are set."},{"keyPattern":"spark\\.streaming\\.receiver\\.maxRate","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.receiver.maxRate","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which each receiver will receive data. Effectively, each stream will consume at most this number of records per second. Setting this configuration to 0 or a negative number will put no limit on the rate. See the deployment guide in the Spark Streaming programing guide for mode details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRatePerPartition","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRatePerPartition","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which data will be read from each Kafka partition when using the Kafka direct stream API introduced in Spark 1.3. See the Kafka Integration guide for more details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRetries","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRetries","valuePatternDisplay":"numeric","description":"Maximum number of consecutive retries the driver will make in order to find the latest offsets on the leader of each partition (a default value of 1 means that the driver will make a maximum of 2 attempts). Only applies to the Kafka direct stream API introduced in Spark 1.3."},{"keyPattern":"spark\\.streaming\\.ui\\.retainedBatches","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.ui.retainedBatches","valuePatternDisplay":"numeric","description":"How many batches the Spark Streaming UI and status APIs remember before garbage collecting."}],"enableReactNotebookComments":true,"enableAdminPasswordReset":false,"enableResetPassword":true,"maxClusterTagValueLength":255,"enableJobsSparkUpgrade":true,"enableNotebookCommandNumbers":true,"sparkVersions":[{"key":"1.6.3-db2-hadoop2-scala2.10","displayName":"Spark 1.6.3-db2 (Hadoop 2, Scala 2.10)","packageLabel":"spark-image-aba860a0ffce4f3471fb14aefdcb1d768ac66a53a5ad884c48745ef98aeb9d67","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.x-ubuntu15.10","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"1.4.x-ubuntu15.10","displayName":"Spark 1.4.1 (Hadoop 1)","packageLabel":"spark-image-f710650fb8aaade8e4e812368ea87c45cd8cd0b5e6894ca6c94f3354e8daa6dc","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.2.x-scala2.11","displayName":"Spark Master Branch (Experimental, Scala 2.11)","packageLabel":"spark-image-b2166ecda59b5d648306cc8a0923aa3a3bf4f25ea0d47bb42449010086f1f910","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.0-db2-scala2.11","displayName":"Spark 2.1.0-db2 (Scala 2.11)","packageLabel":"spark-image-267c4490a3ab8a39acdbbd9f1d36f6decdecebf013e30dd677faff50f1d9cf8b","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.0-ubuntu15.10-scala2.10","displayName":"Spark 2.0.0 (Scala 2.10)","packageLabel":"spark-image-073c1b52ace74f251fae2680624a0d8d184a8b57096d1c21c5ce56c29be6a37a","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.2-db3-scala2.10","displayName":"Spark 2.0.2-db3 (Scala 2.10)","packageLabel":"spark-image-584091dedb690de20e8cf22d9e02fdcce1281edda99eedb441a418d50e28088f","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.0-db1-scala2.11","displayName":"Spark 2.1.0-db1 (Scala 2.11)","packageLabel":"spark-image-e8ad5b72cf0f899dcf2b4720c1f572ab0e87a311d6113b943b4e1d4a7edb77eb","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.1.1-db4-scala2.11","displayName":"Spark 2.1.1-db4 RC4 (Scala 2.11)","packageLabel":"spark-image-a44721b88b7cb3adbd583dc391c856090f1d08f5e5702025343eef7b11fcf11d","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"2.1.0-db2-scala2.10","displayName":"Spark 2.1.0-db2 (Scala 2.10)","packageLabel":"spark-image-a2ca4f6b58c95f78dca91b1340305ab3fe32673bd894da2fa8e1dc8a9f8d0478","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.x-ubuntu15.10-hadoop1","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"2.0.2-db4-scala2.11","displayName":"Spark 2.0.2-db4 (Scala 2.11)","packageLabel":"spark-image-7dbc7583e8271765b8a1508cb9e832768e35489bbde2c4c790bc6766aee2fd7f","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.1-ubuntu15.10-hadoop1","displayName":"Spark 1.6.1 (Hadoop 1)","packageLabel":"spark-image-21d1cac181b7b8856dd1b4214a3a734f95b5289089349db9d9c926cb87d843db","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.x-gpu-scala2.11","displayName":"Spark 2.0 (Auto-updating, GPU, Scala 2.11 experimental)","packageLabel":"spark-image-968b89f1d0ec32e1ee4dacd04838cae25ef44370a441224177a37980d539d83a","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.2-ubuntu15.10-hadoop1","displayName":"Spark 1.6.2 (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"1.6.3-db1-hadoop2-scala2.10","displayName":"Spark 1.6.3-db1 (Hadoop 2, Scala 2.10)","packageLabel":"spark-image-eaa8d9b990015a14e032fb2e2e15be0b8d5af9627cd01d855df728b67969d5d9","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.3-db2-hadoop1-scala2.10","displayName":"Spark 1.6.3-db2 (Hadoop 1, Scala 2.10)","packageLabel":"spark-image-14112ea0645bea94333a571a150819ce85573cf5541167d905b7e6588645cf3b","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.2-ubuntu15.10-hadoop2","displayName":"Spark 1.6.2 (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"1.6.1-ubuntu15.10-hadoop2","displayName":"Spark 1.6.1 (Hadoop 2)","packageLabel":"spark-image-4cafdf8bc6cba8edad12f441e3b3f0a8ea27da35c896bc8290e16b41fd15496a","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.2-db2-scala2.10","displayName":"Spark 2.0.2-db2 (Scala 2.10)","packageLabel":"spark-image-36d48f22cca7a907538e07df71847dd22aaf84a852c2eeea2dcefe24c681602f","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.x-ubuntu15.10-scala2.11","displayName":"Spark 2.0 (Ubuntu 15.10, Scala 2.11, deprecated)","packageLabel":"spark-image-8e1c50d626a52eac5a6c8129e09ae206ba9890f4523775f77af4ad6d99a64c44","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.x-scala2.10","displayName":"Spark 2.0 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-859e88079f97f58d50e25163b39a1943d1eeac0b6939c5a65faba986477e311a","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.1-db4-scala2.10","displayName":"Spark 2.1.1-db4 RC4 (Scala 2.10)","packageLabel":"spark-image-00d828cd393fda30b92d472cf0f5e13ff9ba2af84382e69abd37934ff71be0e6","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"2.0.2-db1-scala2.11","displayName":"Spark 2.0.2-db1 (Scala 2.11)","packageLabel":"spark-image-c2d623f03dd44097493c01aa54a941fc31978ebe6d759b36c75b716b2ff6ab9c","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.2-db4-scala2.10","displayName":"Spark 2.0.2-db4 (Scala 2.10)","packageLabel":"spark-image-859e88079f97f58d50e25163b39a1943d1eeac0b6939c5a65faba986477e311a","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.5.x-ubuntu15.10","displayName":"Spark 1.5.2 (Hadoop 1)","packageLabel":"spark-image-c9d2a8abf41f157a4acc6d52bc721090346f6fea2de356f3a66e388f54481698","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.x-scala2.11","displayName":"Spark 2.0 (Auto-updating, Scala 2.11)","packageLabel":"spark-image-7dbc7583e8271765b8a1508cb9e832768e35489bbde2c4c790bc6766aee2fd7f","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.x-scala2.10","displayName":"Spark 2.1 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-25a17d070af155f10c4232dcc6248e36a2eb48c24f8d4fc00f34041b86bd1626","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.0-db3-scala2.10","displayName":"Spark 2.1.0-db3 (Scala 2.10)","packageLabel":"spark-image-25a17d070af155f10c4232dcc6248e36a2eb48c24f8d4fc00f34041b86bd1626","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.2-db2-scala2.11","displayName":"Spark 2.0.2-db2 (Scala 2.11)","packageLabel":"spark-image-4fa852ba378e97815083b96c9cada7b962a513ec23554a5fc849f7f1dd8c065a","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"1.3.x-ubuntu15.10","displayName":"Spark 1.3.0 (Hadoop 1)","packageLabel":"spark-image-40d2842670bc3dc178b14042501847d76171437ccf70613fa397a7a24c48b912","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.1-db1-scala2.11","displayName":"Spark 2.0.1-db1 (Scala 2.11)","packageLabel":"spark-image-10ab19f634bbfdb860446c326a9f76dc25bfa87de6403b980566279142a289ea","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.2-db3-scala2.11","displayName":"Spark 2.0.2-db3 (Scala 2.11)","packageLabel":"spark-image-7fd7aaa89d55692e429115ae7eac3b1a1dc4de705d50510995f34306b39c2397","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.3-db1-hadoop1-scala2.10","displayName":"Spark 1.6.3-db1 (Hadoop 1, Scala 2.10)","packageLabel":"spark-image-d50af1032799546b8ccbeeb76889a20c819ebc2a0e68ea20920cb30d3895d3ae","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.2-db1-scala2.10","displayName":"Spark 2.0.2-db1 (Scala 2.10)","packageLabel":"spark-image-654bdd6e9bad70079491987d853b4b7abf3b736fff099701501acaabe0e75c41","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.x-ubuntu15.10","displayName":"Spark 2.0 (Ubuntu 15.10, Scala 2.10, deprecated)","packageLabel":"spark-image-a659f3909d51b38d297b20532fc807ecf708cfb7440ce9b090c406ab0c1e4b7e","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.1-db1-scala2.10","displayName":"Spark 2.0.1-db1 (Scala 2.10)","packageLabel":"spark-image-5a13c2db3091986a4e7363006cc185c5b1108c7761ef5d0218506cf2e6643840","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.1.x-scala2.11","displayName":"Spark 2.1 (Auto-updating, Scala 2.11)","packageLabel":"spark-image-ccbc6b73f158e2001fc1fb8c827bfdde425d8bd6d65cb7b3269784c28bb72c16","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.0-db1-scala2.10","displayName":"Spark 2.1.0-db1 (Scala 2.10)","packageLabel":"spark-image-f0ab82a5deb7908e0d159e9af066ba05fb56e1edb35bdad41b7ad2fd62a9b546","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"1.6.0-ubuntu15.10","displayName":"Spark 1.6.0 (Hadoop 1)","packageLabel":"spark-image-10ef758029b8c7e19cd7f4fb52fff9180d75db92ca071bd94c47f3c1171a7cb5","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"1.6.x-ubuntu15.10-hadoop2","displayName":"Spark 1.6.x (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"2.0.0-ubuntu15.10-scala2.11","displayName":"Spark 2.0.0 (Scala 2.11)","packageLabel":"spark-image-b4ec141e751f201399f8358a82efee202560f7ed05e1a04a2ae8778f6324b909","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.1.0-db3-scala2.11","displayName":"Spark 2.1.0-db3 (Scala 2.11)","packageLabel":"spark-image-ccbc6b73f158e2001fc1fb8c827bfdde425d8bd6d65cb7b3269784c28bb72c16","upgradable":true,"deprecated":false,"customerVisible":true}],"enableRestrictedClusterCreation":true,"enableFeedback":true,"enableClusterAutoScaling":false,"enableUserVisibleDefaultTags":true,"defaultNumWorkers":0,"serverContinuationTimeoutMillis":10000,"driverStderrFilePrefix":"stderr","enableNotebookRefresh":false,"accountsOwnerUrl":"https://accounts.cloud.databricks.com/registration.html#login","driverStdoutFilePrefix":"stdout","defaultNodeTypeToPricingUnitsMap":{"r3.2xlarge":2,"class-node":1,"m4.2xlarge":0.5,"r4.xlarge":1,"m4.4xlarge":0.5,"r4.16xlarge":8,"p2.8xlarge":16,"m4.10xlarge":0.5,"r3.8xlarge":8,"r4.4xlarge":4,"dev-tier-node":1,"c3.8xlarge":4,"r3.4xlarge":4,"i2.4xlarge":6,"m4.xlarge":0.5,"r4.8xlarge":8,"r4.large":0.5,"development-node":1,"i2.2xlarge":3,"g2.8xlarge":6,"memory-optimized":1,"m4.large":0.5,"p2.16xlarge":24,"c3.2xlarge":1,"c4.2xlarge":1,"i2.xlarge":1.5,"compute-optimized":1,"c4.4xlarge":2,"c3.4xlarge":2,"g2.2xlarge":1.5,"p2.xlarge":2,"m4.16xlarge":0.5,"c4.8xlarge":4,"r3.xlarge":1,"r4.2xlarge":2,"i2.8xlarge":12},"enableSparkDocsSearch":true,"sparkHistoryServerEnabled":true,"enableEBSVolumesUI":false,"sanitizeMarkdownHtml":true,"enableIPythonImportExport":true,"enableClusterTagsUIForJobs":true,"enableClusterTagsUI":false,"enableNotebookHistoryDiffing":true,"branch":"2.43","accountsLimit":3,"enableSparkEnvironmentVariables":true,"enableX509Authentication":false,"enableNotebookGitBranching":true,"local":false,"enableClusterAutoScalingForJobs":false,"enableStrongPassword":false,"displayDefaultContainerMemoryGB":6,"enableNotebookCommandMode":true,"disableS3TableImport":false,"deploymentMode":"production","useSpotForWorkers":true,"enableUserInviteWorkflow":true,"enableStaticNotebooks":true,"enableCssTransitions":true,"minClusterTagKeyLength":1,"showHomepageFeaturedLinks":true,"pricingURL":"https://databricks.com/product/pricing","enableClusterAclsConfig":false,"useTempS3UrlForTableUpload":false,"notifyLastLogin":false,"enableSshKeyUIByTier":false,"defaultAutomatedPricePerDBU":0.2,"enableNotebookGitVersioning":true,"files":"files/","feedbackEmail":"feedback@databricks.com","enableDriverLogsUI":true,"enableWorkspaceAclsConfig":false,"dropzoneMaxFileSize":2047,"enableNewClustersList":false,"enableNewDashboardViews":true,"driverLog4jFilePrefix":"log4j","enableSingleSignOn":true,"enableMavenLibraries":true,"displayRowLimit":1000,"deltaProcessingAsyncEnabled":true,"enableSparkEnvironmentVariablesUI":false,"defaultSparkVersion":{"key":"2.1.x-scala2.10","displayName":"Spark 2.1 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-25a17d070af155f10c4232dcc6248e36a2eb48c24f8d4fc00f34041b86bd1626","upgradable":true,"deprecated":false,"customerVisible":true},"enableCustomSpotPricing":false,"enableMountAclsConfig":false,"useDevTierHomePage":true,"enableClusterClone":true,"enableNotebookLineNumbers":true,"enablePublishHub":false,"notebookHubUrl":"http://hub.dev.databricks.com/","showSqlEndpoints":false,"enableClusterAclsByTier":false,"databricksDocsBaseUrl":"https://docs.databricks.com/","cloud":"AWS","disallowAddingAdmins":true,"enableSparkConfUI":true,"featureTier":"DEVELOPER_BASIC_TIER","mavenCentralSearchEndpoint":"http://search.maven.org/solrsearch/select","enableOrgSwitcherUI":true,"clustersLimit":1,"enableJdbcImport":true,"logfiles":"logfiles/","enableWebappSharding":true,"enableClusterDeltaUpdates":true,"enableSingleSignOnLogin":false,"ebsVolumeSizeLimitGB":{"GENERAL_PURPOSE_SSD":[100,4096],"THROUGHPUT_OPTIMIZED_HDD":[500,4096]},"enableMountAcls":false,"requireEmailUserName":true,"dbcFeedbackURL":"mailto:feedback@databricks.com","enableMountAclService":true,"enableWorkspaceAcls":false,"maxClusterTagKeyLength":127,"gitHash":"f02f6a43e613f2d87429ffc62e757066894de04f","showWorkspaceFeaturedLinks":true,"signupUrl":"https://databricks.com/try-databricks","allowFeedbackForumAccess":true,"enableImportFromUrl":true,"enableMiniClusters":true,"enableNewTableUI":true,"enableDebugUI":false,"enableStreamingMetricsDashboard":true,"allowNonAdminUsers":true,"enableSingleSignOnByTier":false,"enableJobsRetryOnTimeout":true,"useStandardTierUpgradeTooltips":true,"staticNotebookResourceUrl":"https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/","enableSpotClusterType":true,"enableSparkPackages":true,"dynamicSparkVersions":true,"enableClusterTagsUIByTier":false,"enableNotebookHistoryUI":true,"enableClusterLoggingUI":true,"enableDatabaseDropdownInTableUI":false,"showDebugCounters":false,"enableInstanceProfilesUI":false,"enableFolderHtmlExport":true,"homepageFeaturedLinks":[{"linkURI":"https://docs.databricks.com/_static/notebooks/gentle-introduction-to-apache-spark.html","displayName":"Introduction to Apache Spark on Databricks","icon":"img/home/Python_icon.svg"},{"linkURI":"https://docs.databricks.com/_static/notebooks/databricks-for-data-scientists.html","displayName":"Databricks for Data Scientists","icon":"img/home/Scala_icon.svg"},{"linkURI":"https://docs.databricks.com/_static/notebooks/structured-streaming-python.html","displayName":"Introduction to Structured Streaming","icon":"img/home/Python_icon.svg"}],"enableClusterStart":false,"enableEBSVolumesUIByTier":false,"upgradeURL":"https://accounts.cloud.databricks.com/registration.html#login","notebookLoadingBackground":"#fff","sshContainerForwardedPort":2200,"enableServerAutoComplete":true,"enableStaticHtmlImport":true,"enableInstanceProfilesByTier":false,"defaultMemoryPerContainerMB":6000,"enablePresenceUI":true,"accounts":true,"useOnDemandClustersByDefault":true,"useFramedStaticNotebooks":false,"enableNewProgressReportUI":true,"defaultCoresPerContainer":4,"showTerminationReason":true,"enableNewClustersGet":true,"showPricePerDBU":false,"showSqlProxyUI":true};</script>
<script>var __DATABRICKS_NOTEBOOK_MODEL = {"version":"NotebookV1","origId":2580593937400002,"name":"Linear Regression","language":"python","commands":[{"version":"CommandV1","origId":2580593937400004,"guid":"ccfe35a6-c5e5-45c6-b7c1-f71c122fa5e6","subtype":"command","commandType":"auto","position":1.0,"command":"%md\n# Least Squares Regression\n\nThis notebook explains how to implement least squares regression using PySpark Map-Reduce.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1492492952577,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e8de95c9-f283-4f79-9d63-e6846ae82490"},{"version":"CommandV1","origId":2580593937400005,"guid":"a7d41f5a-4a19-4373-bf9b-048c5f044d11","subtype":"command","commandType":"auto","position":3.625,"command":"%md\n\nSpark exposes two interfaces to data:\n\n1. An [RDD](http://spark.apache.org/docs/2.1.0/api/python/pyspark.html#pyspark.RDD) interface which represents a collection of rows which can be any python object.\n1. A [dataframe](http://spark.apache.org/docs/2.1.0/api/python/pyspark.sql.html) interface which is similar to Pandas (but with less functionality) and built on top of the RDD interface\n\nToday Spark users are encouraged to try to use the dataframe interface which provides additional system performance optimizations. However, in the homework and in this notebook we will use a bit of both to get some exposure the the low-level side of distributed data processing.\n","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1492492952590,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"78b16b66-2506-49a6-a78a-03fa540229d1"},{"version":"CommandV1","origId":2580593937400006,"guid":"4a4f7edf-b3c0-4989-b5b5-13c8b08cf67d","subtype":"command","commandType":"auto","position":4.9375,"command":"%md\n\n## Loading the Diamond Dataset\n\nWe begin by loading data describing diamonds.  We will load this data using the dataframe interface to Spark.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1492492952612,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"23654f30-46d0-4588-b72b-63185e1e3a69"},{"version":"CommandV1","origId":2580593937400007,"guid":"d59456ac-e09f-4e14-bb2c-711e3a34fbc6","subtype":"command","commandType":"auto","position":6.25,"command":"diamonds = (\n  sqlContext.read.format('csv')\n    .options(header='true', inferSchema='true')\n    .load('/databricks-datasets/Rdatasets/data-001/csv/ggplot2/diamonds.csv')\n    .cache()\n  )","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1492492953452,"submitTime":1492492952639,"finishTime":1492492955162,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"612992c8-0dff-4267-9ad4-5f2d864c12e5"},{"version":"CommandV1","origId":2580593937400008,"guid":"5365519f-d410-47f6-b291-1a8acacb0c02","subtype":"command","commandType":"auto","position":6.3125,"command":"%md\n\nWe can take a look at a table summarizing this data:","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1492492952659,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ce604c5f-a025-4b56-9355-8d8f77bc7088"},{"version":"CommandV1","origId":2580593937400009,"guid":"a789fc4f-c2cf-422b-ba9e-69b979f4e056","subtype":"command","commandType":"auto","position":6.375,"command":"display(diamonds)","commandVersion":0,"state":"finished","results":{"type":"table","data":[[1,0.23,"Ideal","E","SI2",61.5,55.0,326,3.95,3.98,2.43],[2,0.21,"Premium","E","SI1",59.8,61.0,326,3.89,3.84,2.31],[3,0.23,"Good","E","VS1",56.9,65.0,327,4.05,4.07,2.31],[4,0.29,"Premium","I","VS2",62.4,58.0,334,4.2,4.23,2.63],[5,0.31,"Good","J","SI2",63.3,58.0,335,4.34,4.35,2.75],[6,0.24,"Very Good","J","VVS2",62.8,57.0,336,3.94,3.96,2.48],[7,0.24,"Very Good","I","VVS1",62.3,57.0,336,3.95,3.98,2.47],[8,0.26,"Very Good","H","SI1",61.9,55.0,337,4.07,4.11,2.53],[9,0.22,"Fair","E","VS2",65.1,61.0,337,3.87,3.78,2.49],[10,0.23,"Very Good","H","VS1",59.4,61.0,338,4.0,4.05,2.39],[11,0.3,"Good","J","SI1",64.0,55.0,339,4.25,4.28,2.73],[12,0.23,"Ideal","J","VS1",62.8,56.0,340,3.93,3.9,2.46],[13,0.22,"Premium","F","SI1",60.4,61.0,342,3.88,3.84,2.33],[14,0.31,"Ideal","J","SI2",62.2,54.0,344,4.35,4.37,2.71],[15,0.2,"Premium","E","SI2",60.2,62.0,345,3.79,3.75,2.27],[16,0.32,"Premium","E","I1",60.9,58.0,345,4.38,4.42,2.68],[17,0.3,"Ideal","I","SI2",62.0,54.0,348,4.31,4.34,2.68],[18,0.3,"Good","J","SI1",63.4,54.0,351,4.23,4.29,2.7],[19,0.3,"Good","J","SI1",63.8,56.0,351,4.23,4.26,2.71],[20,0.3,"Very Good","J","SI1",62.7,59.0,351,4.21,4.27,2.66],[21,0.3,"Good","I","SI2",63.3,56.0,351,4.26,4.3,2.71],[22,0.23,"Very Good","E","VS2",63.8,55.0,352,3.85,3.92,2.48],[23,0.23,"Very Good","H","VS1",61.0,57.0,353,3.94,3.96,2.41],[24,0.31,"Very Good","J","SI1",59.4,62.0,353,4.39,4.43,2.62],[25,0.31,"Very Good","J","SI1",58.1,62.0,353,4.44,4.47,2.59],[26,0.23,"Very Good","G","VVS2",60.4,58.0,354,3.97,4.01,2.41],[27,0.24,"Premium","I","VS1",62.5,57.0,355,3.97,3.94,2.47],[28,0.3,"Very Good","J","VS2",62.2,57.0,357,4.28,4.3,2.67],[29,0.23,"Very Good","D","VS2",60.5,61.0,357,3.96,3.97,2.4],[30,0.23,"Very Good","F","VS1",60.9,57.0,357,3.96,3.99,2.42],[31,0.23,"Very Good","F","VS1",60.0,57.0,402,4.0,4.03,2.41],[32,0.23,"Very Good","F","VS1",59.8,57.0,402,4.04,4.06,2.42],[33,0.23,"Very Good","E","VS1",60.7,59.0,402,3.97,4.01,2.42],[34,0.23,"Very Good","E","VS1",59.5,58.0,402,4.01,4.06,2.4],[35,0.23,"Very Good","D","VS1",61.9,58.0,402,3.92,3.96,2.44],[36,0.23,"Good","F","VS1",58.2,59.0,402,4.06,4.08,2.37],[37,0.23,"Good","E","VS1",64.1,59.0,402,3.83,3.85,2.46],[38,0.31,"Good","H","SI1",64.0,54.0,402,4.29,4.31,2.75],[39,0.26,"Very Good","D","VS2",60.8,59.0,403,4.13,4.16,2.52],[40,0.33,"Ideal","I","SI2",61.8,55.0,403,4.49,4.51,2.78],[41,0.33,"Ideal","I","SI2",61.2,56.0,403,4.49,4.5,2.75],[42,0.33,"Ideal","J","SI1",61.1,56.0,403,4.49,4.55,2.76],[43,0.26,"Good","D","VS2",65.2,56.0,403,3.99,4.02,2.61],[44,0.26,"Good","D","VS1",58.4,63.0,403,4.19,4.24,2.46],[45,0.32,"Good","H","SI2",63.1,56.0,403,4.34,4.37,2.75],[46,0.29,"Premium","F","SI1",62.4,58.0,403,4.24,4.26,2.65],[47,0.32,"Very Good","H","SI2",61.8,55.0,403,4.35,4.42,2.71],[48,0.32,"Good","H","SI2",63.8,56.0,403,4.36,4.38,2.79],[49,0.25,"Very Good","E","VS2",63.3,60.0,404,4.0,4.03,2.54],[50,0.29,"Very Good","H","SI2",60.7,60.0,404,4.33,4.37,2.64],[51,0.24,"Very Good","F","SI1",60.9,61.0,404,4.02,4.03,2.45],[52,0.23,"Ideal","G","VS1",61.9,54.0,404,3.93,3.95,2.44],[53,0.32,"Ideal","I","SI1",60.9,55.0,404,4.45,4.48,2.72],[54,0.22,"Premium","E","VS2",61.6,58.0,404,3.93,3.89,2.41],[55,0.22,"Premium","D","VS2",59.3,62.0,404,3.91,3.88,2.31],[56,0.3,"Ideal","I","SI2",61.0,59.0,405,4.3,4.33,2.63],[57,0.3,"Premium","J","SI2",59.3,61.0,405,4.43,4.38,2.61],[58,0.3,"Very Good","I","SI1",62.6,57.0,405,4.25,4.28,2.67],[59,0.3,"Very Good","I","SI1",63.0,57.0,405,4.28,4.32,2.71],[60,0.3,"Good","I","SI1",63.2,55.0,405,4.25,4.29,2.7],[61,0.35,"Ideal","I","VS1",60.9,57.0,552,4.54,4.59,2.78],[62,0.3,"Premium","D","SI1",62.6,59.0,552,4.23,4.27,2.66],[63,0.3,"Ideal","D","SI1",62.5,57.0,552,4.29,4.32,2.69],[64,0.3,"Ideal","D","SI1",62.1,56.0,552,4.3,4.33,2.68],[65,0.42,"Premium","I","SI2",61.5,59.0,552,4.78,4.84,2.96],[66,0.28,"Ideal","G","VVS2",61.4,56.0,553,4.19,4.22,2.58],[67,0.32,"Ideal","I","VVS1",62.0,55.3,553,4.39,4.42,2.73],[68,0.31,"Very Good","G","SI1",63.3,57.0,553,4.33,4.3,2.73],[69,0.31,"Premium","G","SI1",61.8,58.0,553,4.35,4.32,2.68],[70,0.24,"Premium","E","VVS1",60.7,58.0,553,4.01,4.03,2.44],[71,0.24,"Very Good","D","VVS1",61.5,60.0,553,3.97,4.0,2.45],[72,0.3,"Very Good","H","SI1",63.1,56.0,554,4.29,4.27,2.7],[73,0.3,"Premium","H","SI1",62.9,59.0,554,4.28,4.24,2.68],[74,0.3,"Premium","H","SI1",62.5,57.0,554,4.29,4.25,2.67],[75,0.3,"Good","H","SI1",63.7,57.0,554,4.28,4.26,2.72],[76,0.26,"Very Good","F","VVS2",59.2,60.0,554,4.19,4.22,2.49],[77,0.26,"Very Good","E","VVS2",59.9,58.0,554,4.15,4.23,2.51],[78,0.26,"Very Good","D","VVS2",62.4,54.0,554,4.08,4.13,2.56],[79,0.26,"Very Good","D","VVS2",62.8,60.0,554,4.01,4.05,2.53],[80,0.26,"Very Good","E","VVS1",62.6,59.0,554,4.06,4.09,2.55],[81,0.26,"Very Good","E","VVS1",63.4,59.0,554,4.0,4.04,2.55],[82,0.26,"Very Good","D","VVS1",62.1,60.0,554,4.03,4.12,2.53],[83,0.26,"Ideal","E","VVS2",62.9,58.0,554,4.02,4.06,2.54],[84,0.38,"Ideal","I","SI2",61.6,56.0,554,4.65,4.67,2.87],[85,0.26,"Good","E","VVS1",57.9,60.0,554,4.22,4.25,2.45],[86,0.24,"Premium","G","VVS1",62.3,59.0,554,3.95,3.92,2.45],[87,0.24,"Premium","H","VVS1",61.2,58.0,554,4.01,3.96,2.44],[88,0.24,"Premium","H","VVS1",60.8,59.0,554,4.02,4.0,2.44],[89,0.24,"Premium","H","VVS2",60.7,58.0,554,4.07,4.04,2.46],[90,0.32,"Premium","I","SI1",62.9,58.0,554,4.35,4.33,2.73],[91,0.7,"Ideal","E","SI1",62.5,57.0,2757,5.7,5.72,3.57],[92,0.86,"Fair","E","SI2",55.1,69.0,2757,6.45,6.33,3.52],[93,0.7,"Ideal","G","VS2",61.6,56.0,2757,5.7,5.67,3.5],[94,0.71,"Very Good","E","VS2",62.4,57.0,2759,5.68,5.73,3.56],[95,0.78,"Very Good","G","SI2",63.8,56.0,2759,5.81,5.85,3.72],[96,0.7,"Good","E","VS2",57.5,58.0,2759,5.85,5.9,3.38],[97,0.7,"Good","F","VS1",59.4,62.0,2759,5.71,5.76,3.4],[98,0.96,"Fair","F","SI2",66.3,62.0,2759,6.27,5.95,4.07],[99,0.73,"Very Good","E","SI1",61.6,59.0,2760,5.77,5.78,3.56],[100,0.8,"Premium","H","SI1",61.5,58.0,2760,5.97,5.93,3.66],[101,0.75,"Very Good","D","SI1",63.2,56.0,2760,5.8,5.75,3.65],[102,0.75,"Premium","E","SI1",59.9,54.0,2760,6.0,5.96,3.58],[103,0.74,"Ideal","G","SI1",61.6,55.0,2760,5.8,5.85,3.59],[104,0.75,"Premium","G","VS2",61.7,58.0,2760,5.85,5.79,3.59],[105,0.8,"Ideal","I","VS1",62.9,56.0,2760,5.94,5.87,3.72],[106,0.75,"Ideal","G","SI1",62.2,55.0,2760,5.87,5.8,3.63],[107,0.8,"Premium","G","SI1",63.0,59.0,2760,5.9,5.81,3.69],[108,0.74,"Ideal","I","VVS2",62.3,55.0,2761,5.77,5.81,3.61],[109,0.81,"Ideal","F","SI2",58.8,57.0,2761,6.14,6.11,3.6],[110,0.59,"Ideal","E","VVS2",62.0,55.0,2761,5.38,5.43,3.35],[111,0.8,"Ideal","F","SI2",61.4,57.0,2761,5.96,6.0,3.67],[112,0.74,"Ideal","E","SI2",62.2,56.0,2761,5.8,5.84,3.62],[113,0.9,"Premium","I","VS2",63.0,58.0,2761,6.16,6.12,3.87],[114,0.74,"Very Good","G","SI1",62.2,59.0,2762,5.73,5.82,3.59],[115,0.73,"Ideal","F","VS2",62.6,56.0,2762,5.77,5.74,3.6],[116,0.73,"Ideal","F","VS2",62.7,53.0,2762,5.8,5.75,3.62],[117,0.8,"Premium","F","SI2",61.7,58.0,2762,5.98,5.94,3.68],[118,0.71,"Ideal","G","VS2",62.4,54.0,2762,5.72,5.76,3.58],[119,0.7,"Ideal","E","VS2",60.7,58.0,2762,5.73,5.76,3.49],[120,0.8,"Ideal","F","SI2",59.9,59.0,2762,6.01,6.07,3.62],[121,0.71,"Ideal","D","SI2",62.3,56.0,2762,5.73,5.69,3.56],[122,0.74,"Ideal","E","SI1",62.3,54.0,2762,5.8,5.83,3.62],[123,0.7,"Very Good","F","VS2",61.7,63.0,2762,5.64,5.61,3.47],[124,0.7,"Fair","F","VS2",64.5,57.0,2762,5.57,5.53,3.58],[125,0.7,"Fair","F","VS2",65.3,55.0,2762,5.63,5.58,3.66],[126,0.7,"Premium","F","VS2",61.6,60.0,2762,5.65,5.59,3.46],[127,0.91,"Premium","H","SI1",61.4,56.0,2763,6.09,5.97,3.7],[128,0.61,"Very Good","D","VVS2",59.6,57.0,2763,5.56,5.58,3.32],[129,0.91,"Fair","H","SI2",64.4,57.0,2763,6.11,6.09,3.93],[130,0.91,"Fair","H","SI2",65.7,60.0,2763,6.03,5.99,3.95],[131,0.77,"Ideal","H","VS2",62.0,56.0,2763,5.89,5.86,3.64],[132,0.71,"Very Good","D","SI1",63.6,58.0,2764,5.64,5.68,3.6],[133,0.71,"Ideal","D","SI1",61.9,59.0,2764,5.69,5.72,3.53],[134,0.7,"Very Good","E","VS2",62.6,60.0,2765,5.62,5.65,3.53],[135,0.77,"Very Good","H","VS1",61.3,60.0,2765,5.88,5.9,3.61],[136,0.63,"Premium","E","VVS1",60.9,60.0,2765,5.52,5.55,3.37],[137,0.71,"Very Good","F","VS1",60.1,62.0,2765,5.74,5.77,3.46],[138,0.71,"Premium","F","VS1",61.8,59.0,2765,5.69,5.73,3.53],[139,0.76,"Ideal","H","SI1",61.2,57.0,2765,5.88,5.91,3.61],[140,0.64,"Ideal","G","VVS1",61.9,56.0,2766,5.53,5.56,3.43],[141,0.71,"Premium","G","VS2",60.9,57.0,2766,5.78,5.75,3.51],[142,0.71,"Premium","G","VS2",59.8,56.0,2766,5.89,5.81,3.5],[143,0.7,"Very Good","D","VS2",61.8,55.0,2767,5.68,5.72,3.52],[144,0.7,"Very Good","F","VS1",60.0,57.0,2767,5.8,5.87,3.5],[145,0.71,"Ideal","D","SI2",61.6,55.0,2767,5.74,5.76,3.54],[146,0.7,"Good","H","VVS2",62.1,64.0,2767,5.62,5.65,3.5],[147,0.71,"Very Good","G","VS1",63.3,59.0,2768,5.52,5.61,3.52],[148,0.73,"Very Good","D","SI1",60.2,56.0,2768,5.83,5.87,3.52],[149,0.7,"Very Good","D","SI1",61.1,58.0,2768,5.66,5.73,3.48],[150,0.7,"Ideal","E","SI1",60.9,57.0,2768,5.73,5.76,3.5],[151,0.71,"Premium","D","SI2",61.7,59.0,2768,5.71,5.67,3.51],[152,0.74,"Ideal","I","SI1",61.3,56.0,2769,5.82,5.86,3.57],[153,0.71,"Premium","D","VS2",62.5,60.0,2770,5.65,5.61,3.52],[154,0.73,"Premium","G","VS2",61.4,59.0,2770,5.83,5.76,3.56],[155,0.76,"Very Good","F","SI1",62.9,57.0,2770,5.79,5.81,3.65],[156,0.76,"Ideal","D","SI2",62.4,57.0,2770,5.78,5.83,3.62],[157,0.71,"Ideal","F","SI1",60.7,56.0,2770,5.77,5.8,3.51],[158,0.73,"Premium","G","VS2",60.7,58.0,2770,5.87,5.82,3.55],[159,0.73,"Premium","G","VS1",61.5,58.0,2770,5.79,5.75,3.55],[160,0.73,"Ideal","D","SI2",59.9,57.0,2770,5.92,5.89,3.54],[161,0.73,"Premium","G","VS2",59.2,59.0,2770,5.92,5.87,3.49],[162,0.72,"Very Good","H","VVS2",60.3,56.0,2771,5.81,5.83,3.51],[163,0.73,"Very Good","F","SI1",61.7,60.0,2771,5.79,5.82,3.58],[164,0.71,"Ideal","G","VS2",61.9,57.0,2771,5.73,5.77,3.56],[165,0.79,"Ideal","F","SI2",61.9,55.0,2771,5.97,5.92,3.68],[166,0.73,"Very Good","H","VVS1",60.4,59.0,2772,5.83,5.89,3.54],[167,0.8,"Very Good","F","SI2",61.0,57.0,2772,6.01,6.03,3.67],[168,0.58,"Ideal","G","VVS1",61.5,55.0,2772,5.39,5.44,3.33],[169,0.58,"Ideal","F","VVS1",61.7,56.0,2772,5.33,5.37,3.3],[170,0.71,"Good","E","VS2",59.2,61.0,2772,5.8,5.88,3.46],[171,0.75,"Ideal","D","SI2",61.3,56.0,2773,5.85,5.89,3.6],[172,0.7,"Premium","D","VS2",58.0,62.0,2773,5.87,5.78,3.38],[173,1.17,"Very Good","J","I1",60.2,61.0,2774,6.83,6.9,4.13],[174,0.6,"Ideal","E","VS1",61.7,55.0,2774,5.41,5.44,3.35],[175,0.7,"Ideal","E","SI1",62.7,55.0,2774,5.68,5.74,3.58],[176,0.83,"Good","I","VS2",64.6,54.0,2774,5.85,5.88,3.79],[177,0.74,"Very Good","F","VS2",61.3,61.0,2775,5.8,5.84,3.57],[178,0.72,"Very Good","G","VS2",63.7,56.4,2776,5.62,5.69,3.61],[179,0.71,"Premium","E","VS2",62.7,58.0,2776,5.74,5.68,3.58],[180,0.71,"Ideal","E","VS2",62.2,57.0,2776,5.79,5.62,3.55],[181,0.54,"Ideal","E","VVS2",61.6,56.0,2776,5.25,5.27,3.24],[182,0.54,"Ideal","E","VVS2",61.5,57.0,2776,5.24,5.26,3.23],[183,0.72,"Ideal","G","SI1",61.8,56.0,2776,5.72,5.75,3.55],[184,0.72,"Ideal","G","SI1",60.7,56.0,2776,5.79,5.82,3.53],[185,0.72,"Good","G","VS2",59.7,60.5,2776,5.8,5.84,3.47],[186,0.71,"Ideal","G","SI1",60.5,56.0,2776,5.8,5.76,3.5],[187,0.7,"Very Good","D","VS1",62.7,58.0,2777,5.66,5.73,3.57],[188,0.71,"Premium","F","VS2",62.1,58.0,2777,5.67,5.7,3.53],[189,0.71,"Very Good","F","VS2",62.8,57.0,2777,5.64,5.69,3.56],[190,0.71,"Good","F","VS2",63.8,58.0,2777,5.61,5.64,3.59],[191,0.71,"Good","F","VS2",57.8,60.0,2777,5.87,5.9,3.4],[192,0.7,"Ideal","E","VS2",62.1,55.0,2777,5.7,5.67,3.53],[193,0.7,"Premium","E","VS2",61.1,60.0,2777,5.71,5.64,3.47],[194,0.7,"Premium","E","SI1",60.0,59.0,2777,5.79,5.75,3.46],[195,0.7,"Premium","E","SI1",61.2,57.0,2777,5.73,5.68,3.49],[196,0.7,"Premium","E","SI1",62.7,59.0,2777,5.67,5.63,3.54],[197,0.7,"Premium","E","SI1",61.0,57.0,2777,5.73,5.68,3.48],[198,0.7,"Premium","E","SI1",61.0,58.0,2777,5.78,5.72,3.51],[199,0.7,"Ideal","E","SI1",61.4,57.0,2777,5.76,5.7,3.52],[200,0.72,"Premium","F","SI1",61.8,61.0,2777,5.82,5.71,3.56],[201,0.7,"Very Good","E","SI1",59.9,63.0,2777,5.76,5.7,3.43],[202,0.7,"Premium","E","SI1",61.3,58.0,2777,5.71,5.68,3.49],[203,0.7,"Premium","E","SI1",60.5,58.0,2777,5.77,5.74,3.48],[204,0.7,"Good","E","VS2",64.1,59.0,2777,5.64,5.59,3.6],[205,0.98,"Fair","H","SI2",67.9,60.0,2777,6.05,5.97,4.08],[206,0.78,"Premium","F","SI1",62.4,58.0,2777,5.83,5.8,3.63],[207,0.7,"Very Good","E","SI1",63.2,60.0,2777,5.6,5.51,3.51],[208,0.52,"Ideal","F","VVS1",61.3,55.0,2778,5.19,5.22,3.19],[209,0.73,"Very Good","H","VS2",60.8,56.0,2779,5.82,5.84,3.55],[210,0.74,"Ideal","E","SI1",61.7,56.0,2779,5.84,5.8,3.59],[211,0.7,"Very Good","F","VS2",63.6,57.0,2780,5.61,5.65,3.58],[212,0.77,"Premium","G","VS2",61.2,58.0,2780,5.9,5.93,3.62],[213,0.71,"Ideal","F","VS2",62.1,54.0,2780,5.68,5.72,3.54],[214,0.74,"Ideal","G","VS1",61.5,55.0,2780,5.81,5.86,3.59],[215,0.7,"Ideal","G","VS1",61.4,59.0,2780,5.64,5.73,3.49],[216,1.01,"Premium","F","I1",61.8,60.0,2781,6.39,6.36,3.94],[217,0.77,"Ideal","H","SI1",62.2,56.0,2781,5.83,5.88,3.64],[218,0.78,"Ideal","H","SI1",61.2,56.0,2781,5.92,5.99,3.64],[219,0.72,"Very Good","H","VS1",60.6,63.0,2782,5.83,5.76,3.51],[220,0.53,"Very Good","D","VVS2",57.5,64.0,2782,5.34,5.37,3.08],[221,0.76,"Ideal","G","VS2",61.3,56.0,2782,5.9,5.94,3.63],[222,0.7,"Good","E","VS1",57.2,62.0,2782,5.81,5.77,3.31],[223,0.7,"Premium","E","VS1",62.9,60.0,2782,5.62,5.54,3.51],[224,0.75,"Very Good","D","SI2",63.1,58.0,2782,5.78,5.73,3.63],[225,0.72,"Ideal","D","SI1",60.8,57.0,2782,5.76,5.75,3.5],[226,0.72,"Premium","D","SI1",62.7,59.0,2782,5.73,5.69,3.58],[227,0.7,"Premium","D","SI1",62.8,60.0,2782,5.68,5.66,3.56],[228,0.84,"Fair","G","SI1",55.1,67.0,2782,6.39,6.2,3.47],[229,0.75,"Premium","F","SI1",61.4,59.0,2782,5.88,5.85,3.6],[230,0.52,"Ideal","F","IF",62.2,55.0,2783,5.14,5.18,3.21],[231,0.72,"Very Good","F","VS2",63.0,54.0,2784,5.69,5.73,3.6],[232,0.79,"Very Good","H","VS1",63.7,56.0,2784,5.85,5.92,3.75],[233,0.72,"Very Good","F","VS2",63.6,58.0,2787,5.66,5.69,3.61],[234,0.51,"Ideal","F","VVS1",62.0,57.0,2787,5.11,5.15,3.18],[235,0.64,"Ideal","D","VS1",61.5,56.0,2787,5.54,5.55,3.41],[236,0.7,"Very Good","H","VVS1",60.5,60.0,2788,5.74,5.77,3.48],[237,0.83,"Very Good","I","VS1",61.1,60.0,2788,6.07,6.1,3.72],[238,0.76,"Ideal","I","VVS2",61.8,56.0,2788,5.85,5.87,3.62],[239,0.71,"Good","D","VS2",63.3,56.0,2788,5.64,5.68,3.58],[240,0.77,"Good","G","VS1",59.4,64.0,2788,5.97,5.92,3.53],[241,0.71,"Ideal","F","SI1",62.5,55.0,2788,5.71,5.65,3.55],[242,1.01,"Fair","E","I1",64.5,58.0,2788,6.29,6.21,4.03],[243,1.01,"Premium","H","SI2",62.7,59.0,2788,6.31,6.22,3.93],[244,0.77,"Good","F","SI1",64.2,52.0,2789,5.81,5.77,3.72],[245,0.76,"Good","E","SI1",63.7,54.0,2789,5.76,5.85,3.7],[246,0.76,"Premium","E","SI1",60.4,58.0,2789,5.92,5.94,3.58],[247,0.76,"Premium","E","SI1",61.8,58.0,2789,5.82,5.86,3.61],[248,1.05,"Very Good","J","SI2",63.2,56.0,2789,6.49,6.45,4.09],[249,0.81,"Ideal","G","SI2",61.6,56.0,2789,5.97,6.01,3.69],[250,0.7,"Ideal","E","SI1",61.6,56.0,2789,5.72,5.75,3.53],[251,0.55,"Ideal","G","IF",60.9,57.0,2789,5.28,5.3,3.22],[252,0.81,"Good","G","SI2",61.0,61.0,2789,5.94,5.99,3.64],[253,0.63,"Premium","E","VVS2",62.1,57.0,2789,5.48,5.41,3.38],[254,0.63,"Premium","E","VVS1",60.9,60.0,2789,5.55,5.52,3.37],[255,0.77,"Premium","H","VS1",61.3,60.0,2789,5.9,5.88,3.61],[256,1.05,"Fair","J","SI2",65.8,59.0,2789,6.41,6.27,4.18],[257,0.64,"Ideal","G","IF",61.3,56.0,2790,5.54,5.58,3.41],[258,0.76,"Premium","I","VVS1",58.8,59.0,2790,6.0,5.94,3.51],[259,0.83,"Ideal","F","SI2",62.3,55.0,2790,6.02,6.05,3.76],[260,0.71,"Premium","F","VS1",60.1,62.0,2790,5.77,5.74,3.46],[261,0.71,"Premium","F","VS1",61.8,59.0,2790,5.73,5.69,3.53],[262,0.87,"Very Good","I","SI1",63.6,55.8,2791,6.07,6.1,3.87],[263,0.73,"Ideal","E","SI1",62.2,56.0,2791,5.74,5.78,3.58],[264,0.71,"Premium","E","SI1",59.2,59.0,2792,5.83,5.86,3.46],[265,0.71,"Premium","E","SI1",61.8,59.0,2792,5.7,5.75,3.54],[266,0.71,"Ideal","E","SI1",61.3,55.0,2792,5.72,5.77,3.52],[267,0.7,"Premium","F","VS1",62.1,60.0,2792,5.71,5.65,3.53],[268,0.7,"Premium","F","VS1",60.7,60.0,2792,5.78,5.75,3.5],[269,0.76,"Premium","H","VVS2",59.6,57.0,2792,5.91,5.86,3.51],[270,0.7,"Ideal","F","VS1",62.2,56.0,2792,5.73,5.68,3.55],[271,0.79,"Very Good","G","SI1",60.6,57.0,2793,5.98,6.06,3.65],[272,0.7,"Very Good","E","VS2",62.9,57.0,2793,5.66,5.69,3.57],[273,0.7,"Good","E","VS2",64.1,55.0,2793,5.6,5.66,3.61],[274,0.76,"Ideal","I","VS2",61.3,56.0,2793,5.87,5.91,3.61],[275,0.73,"Ideal","H","VS2",62.7,55.0,2793,5.72,5.76,3.6],[276,0.79,"Very Good","E","SI1",63.2,56.0,2794,5.91,5.86,3.72],[277,0.71,"Very Good","E","VS2",60.7,56.0,2795,5.81,5.82,3.53],[278,0.81,"Premium","I","VVS2",61.9,60.0,2795,5.91,5.86,3.64],[279,0.81,"Ideal","F","SI2",62.6,55.0,2795,5.92,5.96,3.72],[280,0.72,"Good","F","VS1",60.7,60.0,2795,5.74,5.72,3.48],[281,0.72,"Premium","D","SI2",62.0,60.0,2795,5.73,5.69,3.54],[282,0.72,"Premium","I","IF",63.0,57.0,2795,5.72,5.7,3.6],[283,0.81,"Premium","H","VS2",58.0,59.0,2795,6.17,6.13,3.57],[284,0.72,"Premium","G","VS2",62.9,57.0,2795,5.73,5.65,3.58],[285,1.0,"Premium","I","SI2",58.2,60.0,2795,6.61,6.55,3.83],[286,0.73,"Good","E","SI1",63.2,58.0,2796,5.7,5.76,3.62],[287,0.81,"Very Good","H","SI2",61.3,59.0,2797,5.94,6.01,3.66],[288,0.81,"Very Good","E","SI1",60.3,60.0,2797,6.07,6.1,3.67],[289,0.71,"Premium","D","SI1",62.7,60.0,2797,5.67,5.71,3.57],[290,0.71,"Premium","D","SI1",61.3,58.0,2797,5.73,5.75,3.52],[291,0.71,"Premium","D","SI1",61.6,60.0,2797,5.74,5.69,3.52],[292,0.57,"Ideal","F","VVS2",61.9,55.0,2797,5.34,5.35,3.31],[293,0.51,"Ideal","D","VVS1",61.7,56.0,2797,5.12,5.16,3.17],[294,0.72,"Ideal","G","VS2",61.9,58.0,2797,5.72,5.75,3.55],[295,0.74,"Ideal","H","VS1",61.8,58.0,2797,5.77,5.81,3.58],[296,0.74,"Ideal","H","VS1",61.6,56.0,2797,5.81,5.82,3.58],[297,0.7,"Fair","G","VVS1",58.8,66.0,2797,5.81,5.9,3.44],[298,0.8,"Premium","F","SI2",61.0,57.0,2797,6.03,6.01,3.67],[299,1.01,"Fair","E","SI2",67.4,60.0,2797,6.19,6.05,4.13],[300,0.8,"Very Good","H","VS2",63.4,60.0,2797,5.92,5.82,3.72],[301,0.77,"Ideal","I","VS1",61.5,59.0,2798,5.87,5.91,3.62],[302,0.83,"Very Good","E","SI2",58.0,62.0,2799,6.19,6.25,3.61],[303,0.82,"Ideal","F","SI2",62.4,54.0,2799,5.97,6.02,3.74],[304,0.78,"Ideal","D","SI1",61.9,57.0,2799,5.91,5.86,3.64],[305,0.6,"Very Good","G","IF",61.6,56.0,2800,5.43,5.46,3.35],[306,0.9,"Good","I","SI2",62.2,59.0,2800,6.07,6.11,3.79],[307,0.7,"Premium","E","VS1",62.2,58.0,2800,5.6,5.66,3.5],[308,0.9,"Very Good","I","SI2",61.3,56.0,2800,6.17,6.23,3.8],[309,0.83,"Ideal","G","SI1",62.3,57.0,2800,5.99,6.08,3.76],[310,0.83,"Ideal","G","SI1",61.8,57.0,2800,6.03,6.07,3.74],[311,0.83,"Very Good","H","SI1",62.5,59.0,2800,5.95,6.02,3.74],[312,0.74,"Premium","G","VS1",62.9,60.0,2800,5.74,5.68,3.59],[313,0.79,"Ideal","I","VS1",61.8,59.0,2800,5.92,5.95,3.67],[314,0.61,"Ideal","G","IF",62.3,56.0,2800,5.43,5.45,3.39],[315,0.76,"Fair","G","VS1",59.0,70.0,2800,5.89,5.8,3.46],[316,0.96,"Ideal","F","I1",60.7,55.0,2801,6.37,6.41,3.88],[317,0.73,"Ideal","F","VS2",62.5,55.0,2801,5.8,5.76,3.61],[318,0.73,"Premium","F","VS2",62.7,58.0,2801,5.76,5.7,3.59],[319,0.75,"Ideal","H","SI1",60.4,57.0,2801,5.93,5.96,3.59],[320,0.71,"Premium","F","VS2",62.1,58.0,2801,5.7,5.67,3.53],[321,0.71,"Good","F","VS2",57.8,60.0,2801,5.9,5.87,3.4],[322,0.71,"Good","F","VS2",63.8,58.0,2801,5.64,5.61,3.59],[323,0.71,"Premium","F","VS2",62.8,57.0,2801,5.69,5.64,3.56],[324,1.04,"Premium","G","I1",62.2,58.0,2801,6.46,6.41,4.0],[325,1.0,"Premium","J","SI2",62.3,58.0,2801,6.45,6.34,3.98],[326,0.87,"Very Good","G","SI2",59.9,58.0,2802,6.19,6.23,3.72],[327,0.53,"Ideal","F","IF",61.9,54.0,2802,5.22,5.25,3.24],[328,0.72,"Premium","E","VS2",63.0,55.0,2802,5.79,5.61,3.59],[329,0.72,"Premium","F","VS1",62.4,58.0,2802,5.83,5.7,3.6],[330,0.7,"Very Good","F","VS2",62.9,58.0,2803,5.63,5.65,3.55],[331,0.74,"Very Good","E","SI1",63.5,56.0,2803,5.74,5.79,3.66],[332,0.71,"Ideal","G","VS2",61.3,56.0,2803,5.75,5.71,3.51],[333,0.73,"Ideal","E","SI1",60.6,54.0,2803,5.84,5.89,3.55],[334,0.7,"Good","G","VS1",65.1,58.0,2803,5.56,5.59,3.63],[335,0.71,"Premium","F","VS2",62.6,58.0,2803,5.7,5.67,3.56],[336,0.71,"Premium","F","VS2",58.0,62.0,2803,5.85,5.81,3.38],[337,0.71,"Premium","G","VS1",62.4,61.0,2803,5.7,5.65,3.54],[338,0.77,"Premium","G","VS2",61.3,57.0,2803,5.93,5.88,3.62],[339,0.71,"Premium","G","VS2",59.9,60.0,2803,5.81,5.77,3.47],[340,0.78,"Premium","G","VS2",60.8,58.0,2803,6.03,5.95,3.64],[341,0.71,"Very Good","G","VS1",63.5,55.0,2803,5.66,5.64,3.59],[342,0.91,"Ideal","D","SI2",62.2,57.0,2803,6.21,6.15,3.85],[343,0.71,"Very Good","E","VS2",63.8,58.0,2804,5.62,5.66,3.6],[344,0.71,"Very Good","E","VS2",64.0,57.0,2804,5.66,5.68,3.63],[345,0.8,"Very Good","E","SI2",62.5,56.0,2804,5.88,5.96,3.7],[346,0.7,"Very Good","D","SI1",62.3,58.0,2804,5.69,5.73,3.56],[347,0.72,"Ideal","F","VS1",61.7,57.0,2804,5.74,5.77,3.55],[348,0.72,"Very Good","F","VS1",62.2,58.0,2804,5.75,5.7,3.56],[349,0.82,"Ideal","H","VS2",61.5,56.0,2804,6.01,6.08,3.72],[350,0.7,"Ideal","D","SI1",61.0,59.0,2804,5.68,5.7,3.47],[351,0.72,"Ideal","D","SI1",62.2,56.0,2804,5.74,5.77,3.58],[352,0.72,"Ideal","D","SI1",61.5,54.0,2804,5.77,5.8,3.56],[353,0.9,"Fair","I","SI1",67.3,59.0,2804,5.93,5.84,3.96],[354,0.74,"Premium","F","VS2",61.7,58.0,2805,5.85,5.78,3.59],[355,0.74,"Premium","F","VS2",61.9,56.0,2805,5.8,5.77,3.58],[356,0.73,"Ideal","E","SI2",61.8,58.0,2805,5.77,5.81,3.58],[357,0.57,"Fair","E","VVS1",58.7,66.0,2805,5.34,5.43,3.16],[358,0.73,"Premium","F","VS2",62.5,57.0,2805,5.75,5.7,3.58],[359,0.72,"Ideal","G","VS2",62.8,56.0,2805,5.74,5.7,3.59],[360,0.74,"Fair","F","VS2",61.1,68.0,2805,5.82,5.75,3.53],[361,0.82,"Good","G","VS2",64.0,57.0,2805,5.92,5.89,3.78],[362,0.81,"Very Good","G","SI1",62.5,60.0,2806,5.89,5.94,3.69],[363,0.75,"Very Good","H","VVS1",60.6,58.0,2806,5.85,5.9,3.56],[364,0.7,"Ideal","F","SI1",61.6,55.0,2806,5.72,5.74,3.53],[365,0.71,"Very Good","F","VS1",62.2,58.0,2807,5.66,5.72,3.54],[366,0.71,"Very Good","F","VS1",60.0,57.0,2807,5.84,5.9,3.52],[367,0.93,"Premium","J","SI2",61.9,57.0,2807,6.21,6.19,3.84],[368,0.8,"Very Good","H","VS2",62.8,57.0,2808,5.87,5.91,3.7],[369,0.7,"Very Good","F","VS1",62.0,57.0,2808,5.64,5.71,3.52],[370,1.0,"Fair","G","I1",66.4,59.0,2808,6.16,6.09,4.07],[371,0.75,"Very Good","G","VS2",63.4,56.0,2808,5.78,5.74,3.65],[372,0.58,"Ideal","E","VVS2",60.9,56.0,2808,5.41,5.43,3.3],[373,0.73,"Very Good","D","SI1",63.1,57.0,2808,5.74,5.7,3.61],[374,0.81,"Very Good","F","SI1",63.1,59.0,2809,5.85,5.79,3.67],[375,0.81,"Premium","D","SI2",59.2,57.0,2809,6.15,6.05,3.61],[376,0.71,"Premium","F","SI1",60.7,54.0,2809,5.84,5.8,3.53],[377,1.2,"Fair","F","I1",64.6,56.0,2809,6.73,6.66,4.33],[378,0.7,"Very Good","F","VS1",61.8,56.0,2810,5.63,5.7,3.5],[379,0.7,"Very Good","F","VS1",59.9,60.0,2810,5.77,5.84,3.48],[380,0.74,"Ideal","D","SI2",61.7,55.0,2810,5.81,5.85,3.6],[381,0.7,"Good","F","VS1",62.8,61.0,2810,5.57,5.61,3.51],[382,0.8,"Good","G","SI1",62.7,57.0,2810,5.84,5.93,3.69],[383,0.75,"Very Good","F","SI1",63.4,58.0,2811,5.72,5.76,3.64],[384,0.83,"Very Good","D","SI1",63.5,54.0,2811,5.98,5.95,3.79],[385,1.0,"Fair","J","VS2",65.7,59.0,2811,6.14,6.07,4.01],[386,0.99,"Fair","I","SI2",68.1,56.0,2811,6.21,6.06,4.18],[387,0.7,"Very Good","G","VS1",63.0,60.0,2812,5.57,5.64,3.53],[388,0.7,"Very Good","F","VS2",59.5,58.0,2812,5.75,5.85,3.45],[389,0.7,"Good","E","SI1",63.5,59.0,2812,5.49,5.53,3.5],[390,0.7,"Very Good","F","VS2",61.7,58.0,2812,5.63,5.69,3.49],[391,0.32,"Premium","I","SI1",62.7,58.0,554,4.37,4.34,2.73],[392,0.32,"Premium","I","SI1",62.8,58.0,554,4.39,4.34,2.74],[393,0.32,"Ideal","I","SI1",62.4,57.0,554,4.37,4.35,2.72],[394,0.32,"Premium","I","SI1",61.0,59.0,554,4.39,4.36,2.67],[395,0.32,"Very Good","I","SI1",63.1,56.0,554,4.39,4.36,2.76],[396,0.32,"Ideal","I","SI1",60.7,57.0,554,4.47,4.42,2.7],[397,0.3,"Premium","H","SI1",60.9,59.0,554,4.31,4.29,2.62],[398,0.3,"Premium","H","SI1",60.1,55.0,554,4.41,4.38,2.64],[399,0.3,"Premium","H","SI1",62.9,58.0,554,4.28,4.24,2.68],[400,0.3,"Very Good","H","SI1",63.3,56.0,554,4.29,4.27,2.71],[401,0.3,"Good","H","SI1",63.8,55.0,554,4.26,4.2,2.7],[402,0.3,"Ideal","H","SI1",62.9,57.0,554,4.27,4.22,2.67],[403,0.3,"Very Good","H","SI1",63.4,60.0,554,4.25,4.23,2.69],[404,0.32,"Good","I","SI1",63.9,55.0,554,4.36,4.34,2.78],[405,0.33,"Ideal","H","SI2",61.4,56.0,554,4.85,4.79,2.95],[406,0.29,"Very Good","E","VS1",61.9,55.0,555,4.28,4.33,2.66],[407,0.29,"Very Good","E","VS1",62.4,55.0,555,4.2,4.25,2.63],[408,0.31,"Very Good","F","SI1",61.8,58.0,555,4.32,4.35,2.68],[409,0.34,"Ideal","H","VS2",61.5,56.0,555,4.47,4.5,2.76],[410,0.34,"Ideal","H","VS2",60.4,57.0,555,4.54,4.57,2.75],[411,0.34,"Ideal","I","VS1",61.8,55.0,555,4.48,4.52,2.78],[412,0.34,"Ideal","I","VS1",62.0,56.0,555,4.5,4.53,2.8],[413,0.3,"Ideal","G","VS1",62.3,56.0,555,4.29,4.31,2.68],[414,0.29,"Ideal","F","VS1",61.6,56.0,555,4.26,4.31,2.64],[415,0.35,"Ideal","G","SI1",60.6,56.0,555,4.56,4.58,2.77],[416,0.43,"Very Good","E","I1",58.4,62.0,555,4.94,5.0,2.9],[417,0.32,"Very Good","F","VS2",61.4,58.0,556,4.37,4.42,2.7],[418,0.36,"Ideal","I","VS2",61.9,56.0,556,4.54,4.57,2.82],[419,0.3,"Ideal","G","VS2",62.0,56.0,556,4.28,4.3,2.66],[420,0.26,"Ideal","E","VS1",61.5,57.0,556,4.09,4.12,2.52],[421,0.7,"Very Good","F","VS2",62.3,58.0,2812,5.64,5.72,3.54],[422,0.7,"Very Good","F","VS2",60.9,61.0,2812,5.66,5.71,3.46],[423,0.71,"Ideal","D","SI1",62.4,57.0,2812,5.69,5.72,3.56],[424,0.99,"Fair","J","SI1",55.0,61.0,2812,6.72,6.67,3.68],[425,0.73,"Premium","E","VS2",58.6,60.0,2812,5.92,5.89,3.46],[426,0.51,"Ideal","F","VVS1",62.0,57.0,2812,5.15,5.11,3.18],[427,0.91,"Premium","G","SI2",59.8,58.0,2813,6.3,6.29,3.77],[428,0.84,"Very Good","E","SI1",63.4,55.0,2813,6.0,5.95,3.79],[429,0.91,"Good","I","VS2",64.3,58.0,2813,6.09,6.05,3.9],[430,0.76,"Premium","E","SI1",62.2,59.0,2814,5.86,5.81,3.63],[431,0.76,"Ideal","E","SI1",61.7,57.0,2814,5.88,5.85,3.62],[432,0.75,"Premium","E","SI1",61.1,59.0,2814,5.86,5.83,3.57],[433,0.55,"Very Good","D","VVS1",61.5,56.0,2815,5.23,5.27,3.23],[434,0.76,"Very Good","F","SI2",58.5,62.0,2815,5.93,6.01,3.49],[435,0.74,"Premium","G","VS1",61.7,58.0,2815,5.79,5.81,3.58],[436,0.7,"Ideal","H","SI1",60.4,56.0,2815,5.75,5.81,3.49],[437,0.7,"Ideal","H","SI1",61.4,56.0,2815,5.7,5.76,3.52],[438,0.7,"Ideal","H","SI1",61.5,55.0,2815,5.73,5.79,3.54],[439,0.7,"Ideal","H","SI1",61.4,56.0,2815,5.72,5.77,3.53],[440,0.9,"Fair","J","VS2",65.0,56.0,2815,6.08,6.04,3.94],[441,0.95,"Fair","F","SI2",56.0,60.0,2815,6.62,6.53,3.68],[442,0.89,"Premium","H","SI2",60.2,59.0,2815,6.26,6.23,3.76],[443,0.72,"Premium","E","VS2",58.3,58.0,2815,5.99,5.92,3.47],[444,0.96,"Fair","E","SI2",53.1,63.0,2815,6.73,6.65,3.55],[445,1.02,"Premium","G","I1",60.3,58.0,2815,6.55,6.5,3.94],[446,0.78,"Very Good","I","VVS2",61.4,56.0,2816,5.91,5.95,3.64],[447,0.61,"Ideal","G","VVS2",60.1,57.0,2816,5.52,5.54,3.32],[448,0.71,"Good","D","VS1",63.4,55.0,2816,5.61,5.69,3.58],[449,0.78,"Premium","F","SI1",61.5,59.0,2816,5.96,5.88,3.64],[450,0.87,"Ideal","H","SI2",62.7,56.0,2816,6.16,6.13,3.85],[451,0.83,"Ideal","H","SI1",62.5,55.0,2816,6.04,6.0,3.76],[452,0.71,"Premium","E","SI1",61.3,56.0,2817,5.78,5.73,3.53],[453,0.71,"Ideal","I","VVS2",60.2,56.0,2817,5.84,5.89,3.53],[454,0.71,"Ideal","E","VS2",62.7,57.0,2817,5.66,5.64,3.54],[455,0.71,"Premium","E","VS2",62.3,58.0,2817,5.69,5.65,3.53],[456,0.63,"Ideal","F","VVS2",61.5,56.0,2817,5.48,5.52,3.38],[457,0.71,"Premium","E","SI1",59.2,59.0,2817,5.86,5.83,3.46],[458,0.71,"Premium","E","SI1",61.8,59.0,2817,5.75,5.7,3.54],[459,0.71,"Ideal","E","SI1",61.3,55.0,2817,5.77,5.72,3.52],[460,0.71,"Premium","E","SI1",61.4,58.0,2817,5.77,5.73,3.53],[461,0.9,"Ideal","J","VS2",62.8,55.0,2817,6.2,6.16,3.88],[462,0.71,"Good","E","SI1",62.8,64.0,2817,5.6,5.54,3.5],[463,0.7,"Premium","E","VS2",62.4,61.0,2818,5.66,5.63,3.52],[464,0.7,"Premium","E","VS2",59.3,60.0,2818,5.78,5.73,3.41],[465,0.7,"Premium","E","VS2",63.0,60.0,2818,5.64,5.6,3.54],[466,1.0,"Premium","H","I1",61.3,60.0,2818,6.43,6.39,3.93],[467,0.86,"Premium","F","SI2",59.3,62.0,2818,6.36,6.22,3.73],[468,0.8,"Ideal","H","SI1",61.0,57.0,2818,6.07,6.0,3.68],[469,0.7,"Ideal","E","VS1",62.9,57.0,2818,5.66,5.61,3.54],[470,0.7,"Premium","E","VS1",59.6,57.0,2818,5.91,5.83,3.5],[471,0.7,"Premium","F","VS2",61.8,60.0,2818,5.69,5.64,3.5],[472,0.7,"Premium","E","VS1",62.7,57.0,2818,5.68,5.64,3.55],[473,1.0,"Fair","H","SI2",65.3,62.0,2818,6.34,6.12,4.08],[474,0.72,"Very Good","G","VS1",63.8,58.0,2819,5.64,5.68,3.61],[475,0.72,"Ideal","H","VS1",62.3,56.0,2819,5.73,5.77,3.58],[476,0.7,"Good","F","VS1",59.7,63.0,2819,5.76,5.79,3.45],[477,0.86,"Good","F","SI2",64.3,60.0,2819,5.97,5.95,3.83],[478,0.71,"Ideal","G","VS1",62.9,58.0,2820,5.66,5.69,3.57],[479,0.75,"Ideal","E","SI1",62.0,57.0,2821,5.8,5.78,3.59],[480,0.73,"Premium","E","VS2",61.6,59.0,2821,5.77,5.73,3.54],[481,0.53,"Ideal","E","VVS1",61.9,55.0,2821,5.2,5.21,3.22],[482,0.73,"Premium","E","SI1",61.3,58.0,2821,5.83,5.76,3.55],[483,0.73,"Good","E","SI1",63.6,57.0,2821,5.72,5.7,3.63],[484,0.73,"Premium","E","SI1",59.6,61.0,2821,5.92,5.85,3.51],[485,0.73,"Premium","E","SI1",62.2,59.0,2821,5.77,5.68,3.56],[486,0.73,"Premium","D","SI1",61.7,55.0,2821,5.84,5.82,3.6],[487,0.73,"Very Good","E","SI1",63.2,58.0,2821,5.76,5.7,3.62],[488,0.7,"Premium","E","VS1",60.8,60.0,2822,5.74,5.71,3.48],[489,0.72,"Premium","E","VS2",60.3,59.0,2822,5.84,5.8,3.51],[490,0.72,"Premium","E","VS2",60.9,60.0,2822,5.8,5.76,3.52],[491,0.72,"Premium","E","VS2",62.4,59.0,2822,5.77,5.7,3.58],[492,0.7,"Premium","E","VS2",60.2,60.0,2822,5.73,5.7,3.44],[493,0.6,"Ideal","F","VVS2",62.0,55.0,2822,5.37,5.4,3.34],[494,0.74,"Ideal","I","VVS1",60.8,57.0,2822,5.85,5.89,3.57],[495,0.73,"Ideal","F","SI1",62.1,55.0,2822,5.75,5.78,3.58],[496,0.71,"Premium","D","SI1",62.7,60.0,2822,5.71,5.67,3.57],[497,0.71,"Premium","D","SI1",61.3,58.0,2822,5.75,5.73,3.52],[498,0.7,"Premium","D","SI1",60.2,60.0,2822,5.82,5.75,3.48],[499,0.7,"Ideal","D","SI1",60.7,56.0,2822,5.75,5.72,3.48],[500,0.9,"Good","J","VS2",64.0,61.0,2822,6.04,6.03,3.86],[501,0.71,"Ideal","D","SI1",60.2,56.0,2822,5.86,5.83,3.52],[502,0.7,"Premium","E","VS2",61.5,59.0,2822,5.73,5.68,3.51],[503,0.7,"Premium","E","VS2",62.6,56.0,2822,5.71,5.66,3.56],[504,0.7,"Ideal","D","SI1",59.7,58.0,2822,5.82,5.77,3.46],[505,0.7,"Good","E","SI1",61.4,64.0,2822,5.71,5.66,3.49],[506,0.7,"Ideal","D","SI1",62.5,57.0,2822,5.62,5.59,3.51],[507,0.7,"Ideal","D","SI1",61.8,56.0,2822,5.73,5.63,3.51],[508,0.7,"Premium","E","VS2",60.7,62.0,2822,5.72,5.68,3.46],[509,0.7,"Premium","F","VS2",60.6,58.0,2822,5.8,5.72,3.49],[510,0.7,"Ideal","D","SI1",61.4,54.0,2822,5.75,5.71,3.52],[511,0.79,"Very Good","D","SI2",62.8,59.0,2823,5.86,5.9,3.69],[512,0.9,"Good","I","SI1",63.8,57.0,2823,6.06,6.13,3.89],[513,0.71,"Premium","E","VS2",62.3,58.0,2823,5.71,5.66,3.54],[514,0.61,"Ideal","E","VVS2",61.3,54.0,2823,5.51,5.59,3.4],[515,0.9,"Fair","H","SI2",65.8,54.0,2823,6.05,5.98,3.96],[516,0.71,"Ideal","E","SI1",60.5,56.0,2823,5.77,5.73,3.47],[517,0.71,"Premium","D","VS2",61.2,59.0,2824,5.74,5.69,3.5],[518,0.77,"Ideal","I","VVS2",62.1,57.0,2824,5.84,5.86,3.63],[519,0.74,"Good","E","VS1",63.1,58.0,2824,5.73,5.75,3.62],[520,0.82,"Ideal","F","SI2",62.4,54.0,2824,6.02,5.97,3.74],[521,0.82,"Premium","E","SI2",60.8,60.0,2824,6.05,6.03,3.67],[522,0.71,"Premium","G","VS1",62.2,59.0,2825,5.73,5.66,3.54],[523,0.83,"Premium","H","SI1",60.0,59.0,2825,6.08,6.05,3.64],[524,0.73,"Very Good","G","VS1",62.0,57.0,2825,5.75,5.8,3.58],[525,0.83,"Premium","H","SI1",62.5,59.0,2825,6.02,5.95,3.74],[526,1.17,"Premium","J","I1",60.2,61.0,2825,6.9,6.83,4.13],[527,0.91,"Fair","H","SI2",61.3,67.0,2825,6.24,6.19,3.81],[528,0.73,"Premium","E","VS1",62.6,60.0,2826,5.75,5.68,3.58],[529,0.7,"Good","E","VS1",57.2,59.0,2826,5.94,5.88,3.38],[530,0.9,"Premium","I","SI2",62.2,59.0,2826,6.11,6.07,3.79],[531,0.7,"Premium","E","VS1",62.2,58.0,2826,5.66,5.6,3.5],[532,0.7,"Very Good","D","VS2",63.3,56.0,2826,5.6,5.58,3.54],[533,0.7,"Premium","E","VS1",59.4,61.0,2826,5.78,5.74,3.42],[534,0.9,"Very Good","I","SI2",63.5,56.0,2826,6.17,6.07,3.88],[535,0.78,"Premium","F","SI1",60.8,60.0,2826,5.97,5.94,3.62],[536,0.96,"Ideal","F","I1",60.7,55.0,2826,6.41,6.37,3.88],[537,0.7,"Very Good","D","SI1",62.3,59.0,2827,5.67,5.7,3.54],[538,0.72,"Good","D","VS2",64.0,54.0,2827,5.68,5.7,3.64],[539,0.79,"Premium","H","VVS2",62.6,58.0,2827,5.96,5.9,3.71],[540,0.7,"Ideal","H","VVS1",61.6,57.0,2827,5.69,5.74,3.52],[541,0.7,"Ideal","H","VVS1",62.3,55.0,2827,5.66,5.7,3.54],[542,0.7,"Ideal","D","SI2",60.6,57.0,2828,5.74,5.77,3.49],[543,1.01,"Premium","H","SI2",61.6,61.0,2828,6.39,6.31,3.91],[544,0.72,"Premium","F","VS1",62.2,58.0,2829,5.75,5.7,3.56],[545,0.8,"Good","E","SI2",63.7,54.0,2829,5.91,5.87,3.75],[546,0.59,"Ideal","E","VVS1",62.0,56.0,2829,5.36,5.38,3.33],[547,0.72,"Ideal","F","VS1",61.7,57.0,2829,5.77,5.74,3.55],[548,0.75,"Premium","E","SI2",61.9,57.0,2829,5.88,5.82,3.62],[549,0.8,"Premium","E","SI2",60.2,57.0,2829,6.05,6.01,3.63],[550,0.71,"Very Good","E","VS2",62.7,59.0,2830,5.65,5.7,3.56],[551,0.77,"Very Good","H","SI1",61.7,56.0,2830,5.84,5.89,3.62],[552,0.97,"Ideal","F","I1",60.7,56.0,2830,6.41,6.43,3.9],[553,0.53,"Ideal","F","VVS1",60.9,57.0,2830,5.23,5.29,3.19],[554,0.53,"Ideal","F","VVS1",61.8,57.0,2830,5.16,5.19,3.2],[555,0.8,"Ideal","I","VS2",62.1,54.4,2830,5.94,5.99,3.7],[556,0.9,"Premium","G","SI1",60.6,62.0,2830,6.21,6.13,3.74],[557,0.76,"Very Good","E","SI2",60.8,60.0,2831,5.89,5.98,3.61],[558,0.72,"Ideal","E","SI1",62.3,57.0,2831,5.7,5.76,3.57],[559,0.75,"Ideal","E","SI1",61.4,57.0,2831,5.82,5.87,3.59],[560,0.72,"Premium","E","SI1",62.1,58.0,2831,5.73,5.76,3.57],[561,0.79,"Ideal","G","SI1",61.8,56.0,2831,5.93,5.91,3.66],[562,0.72,"Very Good","F","VS2",62.5,58.0,2832,5.71,5.75,3.58],[563,0.91,"Very Good","I","SI2",62.8,61.0,2832,6.15,6.18,3.87],[564,0.71,"Premium","G","VVS2",62.1,57.0,2832,5.75,5.65,3.54],[565,0.81,"Premium","G","SI1",63.0,60.0,2832,5.87,5.81,3.68],[566,0.82,"Ideal","H","SI1",62.5,57.0,2832,5.91,5.97,3.71],[567,0.71,"Premium","F","VS1",62.2,58.0,2832,5.72,5.66,3.54],[568,0.9,"Good","J","SI1",64.3,63.0,2832,6.05,6.01,3.88],[569,0.8,"Very Good","I","VS2",62.0,58.0,2833,5.86,5.95,3.66],[570,0.56,"Very Good","E","IF",61.0,59.0,2833,5.28,5.34,3.24],[571,0.7,"Very Good","D","VS2",59.6,61.0,2833,5.77,5.8,3.45],[572,0.7,"Ideal","D","VS2",61.0,57.0,2833,5.74,5.76,3.51],[573,0.61,"Ideal","F","VVS2",61.7,55.0,2833,5.45,5.48,3.37],[574,0.85,"Ideal","H","SI2",62.5,57.0,2833,6.02,6.07,3.78],[575,0.7,"Ideal","F","SI1",60.7,57.0,2833,5.73,5.75,3.49],[576,0.8,"Ideal","G","VS2",62.2,56.0,2834,5.94,5.87,3.67],[577,0.8,"Ideal","H","VS2",62.8,57.0,2834,5.91,5.87,3.7],[578,0.51,"Very Good","D","VVS1",59.9,58.0,2834,5.16,5.19,3.1],[579,0.53,"Ideal","F","VVS1",61.4,57.0,2834,5.2,5.23,3.2],[580,0.78,"Ideal","I","VS2",61.8,55.0,2834,5.92,5.95,3.67],[581,0.9,"Very Good","J","SI1",63.4,54.0,2834,6.17,6.14,3.9],[582,0.9,"Fair","G","SI2",65.3,59.0,2834,6.07,6.0,3.94],[583,0.77,"Ideal","E","SI2",60.7,55.0,2834,6.01,5.95,3.63],[584,0.73,"Ideal","F","VS1",61.2,56.0,2835,5.89,5.81,3.58],[585,0.63,"Ideal","F","VVS2",61.9,57.0,2835,5.47,5.51,3.4],[586,0.7,"Ideal","E","VS2",61.5,54.0,2835,5.7,5.75,3.52],[587,0.72,"Ideal","E","VS2",62.8,57.0,2835,5.71,5.73,3.59],[588,0.72,"Ideal","E","SI1",61.0,57.0,2835,5.78,5.8,3.53],[589,0.75,"Premium","F","VS2",59.6,59.0,2835,6.04,5.94,3.57],[590,0.82,"Very Good","H","SI1",60.7,56.0,2836,6.04,6.06,3.67],[591,0.71,"Good","E","VS2",62.8,60.0,2836,5.6,5.65,3.53],[592,0.7,"Premium","E","VS1",62.6,59.0,2837,5.69,5.66,3.55],[593,0.7,"Ideal","E","VS1",61.8,56.0,2837,5.74,5.69,3.53],[594,0.71,"Ideal","F","SI1",59.8,53.0,2838,5.86,5.82,3.49],[595,0.76,"Very Good","H","SI1",60.9,55.0,2838,5.92,5.94,3.61],[596,0.82,"Fair","F","SI1",64.9,58.0,2838,5.83,5.79,3.77],[597,0.72,"Premium","F","VS1",58.8,60.0,2838,5.91,5.89,3.47],[598,0.7,"Premium","F","VS2",62.3,58.0,2838,5.72,5.64,3.54],[599,0.7,"Premium","F","VS2",61.7,58.0,2838,5.69,5.63,3.49],[600,0.7,"Premium","G","VS1",62.6,55.0,2838,5.73,5.64,3.56],[601,0.7,"Premium","F","VS2",59.4,61.0,2838,5.83,5.79,3.45],[602,0.7,"Very Good","E","SI1",63.5,59.0,2838,5.53,5.49,3.5],[603,0.7,"Premium","F","VS2",60.9,61.0,2838,5.71,5.66,3.46],[604,0.7,"Premium","F","VS2",59.5,58.0,2838,5.85,5.75,3.45],[605,0.7,"Premium","G","VS1",63.0,60.0,2838,5.64,5.57,3.53],[606,0.74,"Very Good","E","SI1",60.0,57.0,2839,5.85,5.89,3.52],[607,0.71,"Ideal","F","VS1",61.5,57.0,2839,5.74,5.71,3.52],[608,0.7,"Ideal","F","VS1",61.6,54.0,2839,5.75,5.72,3.53],[609,0.71,"Ideal","F","VS1",62.1,55.0,2839,5.82,5.68,3.57],[610,0.71,"Premium","F","VS1",59.1,61.0,2839,5.84,5.81,3.44],[611,0.71,"Premium","F","VS1",59.0,60.0,2839,5.82,5.8,3.43],[612,0.71,"Premium","F","VS1",60.5,58.0,2839,5.75,5.72,3.47],[613,0.7,"Ideal","F","VS1",62.4,53.0,2839,5.73,5.71,3.57],[614,0.73,"Ideal","G","VS2",61.8,54.0,2839,5.8,5.82,3.59],[615,0.7,"Ideal","E","VS2",62.1,54.0,2839,5.69,5.72,3.54],[616,0.7,"Ideal","G","VS1",61.3,57.0,2839,5.71,5.74,3.51],[617,0.71,"Premium","G","VVS2",60.3,58.0,2839,5.82,5.78,3.5],[618,0.71,"Premium","F","VS1",59.2,58.0,2839,5.87,5.82,3.46],[619,0.79,"Premium","G","VS2",59.3,62.0,2839,6.09,6.01,3.59],[620,0.71,"Premium","F","VS1",62.7,59.0,2839,5.7,5.62,3.55],[621,0.77,"Very Good","H","VS1",61.0,60.0,2840,5.9,5.87,3.59],[622,0.75,"Very Good","F","SI2",59.8,56.0,2840,5.85,5.92,3.52],[623,0.7,"Ideal","F","SI1",61.0,56.0,2840,5.75,5.8,3.52],[624,0.71,"Premium","F","VS2",59.3,56.0,2840,5.88,5.82,3.47],[625,0.92,"Ideal","D","SI2",61.9,56.0,2840,6.27,6.2,3.86],[626,0.83,"Premium","F","SI2",61.4,59.0,2840,6.08,6.04,3.72],[627,0.7,"Premium","H","VVS1",59.2,60.0,2840,5.87,5.78,3.45],[628,0.73,"Premium","F","VS2",60.3,59.0,2841,5.9,5.87,3.55],[629,0.71,"Very Good","D","VS1",63.4,55.0,2841,5.69,5.61,3.58],[630,0.73,"Very Good","D","SI1",63.9,57.0,2841,5.66,5.71,3.63],[631,0.82,"Ideal","F","SI2",61.7,53.0,2841,6.0,6.12,3.74],[632,0.82,"Ideal","F","SI2",62.3,56.0,2841,5.96,6.02,3.73],[633,0.82,"Very Good","F","SI2",59.7,57.0,2841,6.12,6.14,3.66],[634,0.52,"Ideal","F","VVS1",61.2,56.0,2841,5.19,5.21,3.18],[635,1.0,"Premium","F","I1",58.9,60.0,2841,6.6,6.55,3.87],[636,0.95,"Fair","G","SI1",66.7,56.0,2841,6.16,6.03,4.06],[637,0.73,"Ideal","D","SI1",61.4,57.0,2841,5.76,5.8,3.55],[638,0.73,"Premium","F","VS2",59.9,59.0,2841,5.87,5.77,3.5],[639,0.73,"Premium","G","VS1",61.4,58.0,2841,5.82,5.77,3.56],[640,0.8,"Ideal","I","VS1",62.6,54.0,2842,5.92,5.96,3.72],[641,0.7,"Premium","F","VS2",58.7,61.0,2842,5.8,5.72,3.38],[642,0.7,"Very Good","E","VS2",60.2,62.0,2843,5.71,5.75,3.45],[643,0.7,"Very Good","E","VS2",62.7,58.0,2843,5.65,5.67,3.55],[644,0.71,"Very Good","E","VS2",59.4,58.0,2843,5.76,5.82,3.44],[645,0.81,"Very Good","F","SI2",63.2,58.0,2843,5.91,5.92,3.74],[646,0.71,"Very Good","D","SI1",61.5,58.0,2843,5.73,5.79,3.54],[647,0.73,"Ideal","G","VVS2",61.3,57.0,2843,5.81,5.84,3.57],[648,0.73,"Very Good","F","VS1",61.8,59.0,2843,5.73,5.79,3.56],[649,0.72,"Ideal","E","VS2",62.0,57.0,2843,5.71,5.74,3.55],[650,0.81,"Ideal","F","SI2",62.1,57.0,2843,5.91,5.95,3.68],[651,0.71,"Ideal","G","VVS2",60.7,57.0,2843,5.81,5.78,3.52],[652,0.73,"Very Good","E","SI1",57.7,61.0,2844,5.92,5.96,3.43],[653,0.7,"Very Good","E","VS1",62.0,59.0,2844,5.65,5.68,3.51],[654,1.01,"Ideal","I","I1",61.5,57.0,2844,6.45,6.46,3.97],[655,1.01,"Good","I","I1",63.1,57.0,2844,6.35,6.39,4.02],[656,0.79,"Ideal","H","VS2",62.5,57.0,2844,5.91,5.93,3.7],[657,0.7,"Very Good","E","VS2",61.8,59.0,2845,5.65,5.68,3.5],[658,0.7,"Very Good","E","VS2",58.9,60.0,2845,5.83,5.85,3.44],[659,0.8,"Good","H","VS2",63.4,60.0,2845,5.92,5.82,3.72],[660,1.27,"Premium","H","SI2",59.3,61.0,2845,7.12,7.05,4.2],[661,0.79,"Ideal","D","SI1",61.5,56.0,2846,5.96,5.91,3.65],[662,0.72,"Very Good","F","VS1",60.2,59.0,2846,5.79,5.84,3.5],[663,0.73,"Ideal","H","VVS2",61.6,56.0,2846,5.79,5.84,3.58],[664,1.01,"Fair","H","SI2",65.4,59.0,2846,6.3,6.26,4.11],[665,1.01,"Good","H","I1",64.2,61.0,2846,6.25,6.18,3.99],[666,0.73,"Ideal","E","SI1",59.1,59.0,2846,5.92,5.95,3.51],[667,0.7,"Ideal","E","SI1",61.6,57.0,2846,5.71,5.76,3.53],[668,0.7,"Good","F","VS2",59.1,61.0,2846,5.76,5.84,3.43],[669,0.77,"Premium","E","SI1",62.9,59.0,2846,5.84,5.79,3.66],[670,0.77,"Premium","G","VS2",61.3,60.0,2846,5.91,5.81,3.59],[671,0.77,"Premium","G","VS1",61.4,58.0,2846,5.94,5.89,3.63],[672,0.84,"Very Good","H","SI1",61.2,57.0,2847,6.1,6.12,3.74],[673,0.72,"Ideal","E","SI1",60.3,57.0,2847,5.83,5.85,3.52],[674,0.76,"Premium","D","SI1",61.1,59.0,2847,5.93,5.88,3.61],[675,0.7,"Very Good","G","VVS2",62.9,59.0,2848,5.61,5.68,3.55],[676,0.54,"Ideal","D","VVS2",61.5,55.0,2848,5.25,5.29,3.24],[677,0.75,"Fair","D","SI2",64.6,57.0,2848,5.74,5.72,3.7],[678,0.79,"Good","E","SI1",64.1,54.0,2849,5.86,5.84,3.75],[679,0.74,"Very Good","E","VS1",63.1,58.0,2849,5.75,5.73,3.62],[680,0.7,"Very Good","E","VS2",61.0,60.0,2850,5.74,5.77,3.51],[681,0.7,"Ideal","F","VS2",60.8,59.0,2850,5.69,5.79,3.49],[682,0.75,"Ideal","J","SI1",61.5,56.0,2850,5.83,5.87,3.6],[683,1.2,"Very Good","H","I1",63.1,60.0,2850,6.75,6.67,4.23],[684,0.8,"Very Good","F","SI1",63.4,57.0,2851,5.89,5.82,3.71],[685,0.66,"Ideal","D","VS1",62.1,56.0,2851,5.54,5.57,3.45],[686,0.87,"Very Good","F","SI2",61.0,63.0,2851,6.22,6.07,3.75],[687,0.86,"Premium","H","SI1",62.7,59.0,2851,6.04,5.98,3.77],[688,0.74,"Ideal","F","SI1",61.0,57.0,2851,5.85,5.81,3.56],[689,0.58,"Very Good","E","IF",60.6,59.0,2852,5.37,5.43,3.27],[690,0.78,"Ideal","I","VS1",61.5,57.0,2852,5.88,5.92,3.63],[691,0.74,"Ideal","G","SI1",61.3,55.0,2852,5.85,5.86,3.59],[692,0.73,"Ideal","E","SI1",62.7,55.0,2852,5.7,5.79,3.6],[693,0.91,"Very Good","I","SI1",63.5,57.0,2852,6.12,6.07,3.87],[694,0.71,"Premium","F","VS2",62.6,58.0,2853,5.67,5.7,3.56],[695,0.71,"Good","G","VS1",63.5,55.0,2853,5.64,5.66,3.59],[696,0.79,"Ideal","D","SI2",62.8,57.0,2853,5.9,5.85,3.69],[697,0.79,"Premium","D","SI2",60.0,60.0,2853,6.07,6.03,3.63],[698,0.71,"Premium","E","SI1",62.7,58.0,2853,5.73,5.66,3.57],[699,0.82,"Premium","I","VS1",61.9,58.0,2853,5.99,5.97,3.7],[700,0.78,"Very Good","H","VS1",61.9,57.1,2854,5.87,5.95,3.66],[701,0.7,"Very Good","E","VS1",62.4,56.0,2854,5.64,5.7,3.54],[702,1.12,"Premium","H","I1",59.1,61.0,2854,6.78,6.75,4.0],[703,0.73,"Premium","E","VS2",62.0,57.0,2854,5.86,5.76,3.6],[704,0.91,"Fair","J","VS2",64.4,62.0,2854,6.06,6.03,3.89],[705,0.91,"Fair","J","VS2",65.4,60.0,2854,6.04,6.0,3.94],[706,0.91,"Good","J","VS2",64.2,58.0,2854,6.12,6.09,3.92],[707,0.91,"Fair","H","SI1",65.8,58.0,2854,6.04,6.01,3.96],[708,0.7,"Premium","E","VS1",58.4,59.0,2854,5.91,5.83,3.43],[709,0.68,"Premium","F","VVS2",61.7,57.0,2854,5.67,5.64,3.49],[710,0.73,"Very Good","F","VS2",62.5,57.0,2855,5.7,5.75,3.58],[711,1.03,"Good","J","SI1",63.6,57.0,2855,6.38,6.29,4.03],[712,0.74,"Premium","D","VS2",62.4,57.0,2855,5.8,5.74,3.6],[713,0.98,"Fair","E","SI2",53.3,67.0,2855,6.82,6.74,3.61],[714,1.02,"Fair","I","SI1",53.0,63.0,2856,6.84,6.77,3.66],[715,1.0,"Fair","G","SI2",67.8,61.0,2856,5.96,5.9,4.02],[716,1.02,"Ideal","H","SI2",61.6,55.0,2856,6.49,6.43,3.98],[717,0.6,"Ideal","F","VVS2",60.8,57.0,2856,5.44,5.49,3.32],[718,0.8,"Ideal","G","SI2",61.6,56.0,2856,5.97,6.01,3.69],[719,0.97,"Ideal","F","I1",60.7,56.0,2856,6.43,6.41,3.9],[720,1.0,"Fair","I","SI1",67.9,62.0,2856,6.19,6.03,4.15],[721,0.26,"Ideal","E","VS1",62.3,57.0,556,4.05,4.08,2.53],[722,0.26,"Ideal","E","VS1",62.1,56.0,556,4.09,4.12,2.55],[723,0.36,"Ideal","H","SI1",61.9,55.0,556,4.57,4.59,2.83],[724,0.34,"Good","G","VS2",57.5,61.0,556,4.6,4.66,2.66],[725,0.34,"Good","E","SI1",63.3,57.0,556,4.44,4.47,2.82],[726,0.34,"Good","E","SI1",63.5,55.0,556,4.44,4.47,2.83],[727,0.34,"Good","E","SI1",63.4,55.0,556,4.44,4.46,2.82],[728,0.34,"Very Good","G","VS2",59.6,62.0,556,4.54,4.56,2.71],[729,0.34,"Ideal","E","SI1",62.2,54.0,556,4.47,4.5,2.79],[730,0.32,"Good","E","VS2",64.1,54.0,556,4.34,4.37,2.79],[731,0.31,"Ideal","I","VVS1",61.6,55.0,557,4.36,4.41,2.7],[732,0.31,"Ideal","I","VVS1",61.3,56.0,557,4.36,4.38,2.68],[733,0.31,"Ideal","I","VVS1",62.3,54.0,557,4.37,4.4,2.73],[734,0.31,"Ideal","I","VVS1",62.0,54.0,557,4.37,4.4,2.72],[735,0.31,"Ideal","I","VVS1",62.7,53.0,557,4.33,4.35,2.72],[736,0.31,"Ideal","I","VVS1",62.2,53.0,557,4.36,4.38,2.72],[737,0.31,"Ideal","G","VS2",62.2,53.6,557,4.32,4.35,2.7],[738,0.31,"Ideal","H","VS1",61.6,54.8,557,4.35,4.37,2.69],[739,0.31,"Ideal","H","VS1",61.8,54.2,557,4.33,4.37,2.69],[740,0.33,"Premium","G","SI2",59.4,59.0,557,4.52,4.5,2.68],[741,0.33,"Premium","F","SI2",62.3,58.0,557,4.43,4.4,2.75],[742,0.33,"Premium","G","SI2",62.6,58.0,557,4.42,4.4,2.76],[743,0.33,"Ideal","G","SI2",61.9,56.0,557,4.45,4.41,2.74],[744,0.33,"Premium","F","SI2",63.0,58.0,557,4.42,4.4,2.78],[745,0.33,"Premium","J","VS1",62.8,58.0,557,4.41,4.38,2.76],[746,0.33,"Premium","J","VS1",61.5,61.0,557,4.46,4.39,2.72],[747,0.33,"Ideal","J","VS1",62.1,55.0,557,4.44,4.41,2.75],[748,0.33,"Ideal","I","SI1",63.0,57.0,557,4.39,4.37,2.76],[749,0.33,"Good","I","SI1",63.6,53.0,557,4.43,4.4,2.81],[750,0.33,"Premium","I","SI1",60.4,59.0,557,4.54,4.5,2.73],[751,1.0,"Fair","H","SI2",66.1,56.0,2856,6.21,5.97,4.04],[752,0.77,"Premium","F","SI1",60.8,59.0,2856,5.92,5.86,3.58],[753,0.77,"Premium","F","SI1",61.0,58.0,2856,5.94,5.9,3.61],[754,0.7,"Good","E","VVS2",60.1,63.0,2857,5.68,5.71,3.42],[755,0.9,"Very Good","G","SI2",63.1,58.0,2857,6.08,6.02,3.82],[756,0.72,"Ideal","E","SI1",62.3,57.0,2857,5.76,5.7,3.57],[757,0.9,"Premium","I","VS2",61.9,59.0,2857,6.2,6.14,3.82],[758,0.72,"Premium","E","SI1",62.1,58.0,2857,5.76,5.73,3.57],[759,0.7,"Ideal","G","VVS2",62.1,56.0,2858,5.63,5.71,3.52],[760,0.81,"Very Good","F","SI1",61.3,57.0,2858,6.02,6.05,3.7],[761,0.81,"Very Good","F","SI1",61.7,57.0,2858,6.0,6.05,3.72],[762,0.71,"Premium","E","VS2",61.0,60.0,2858,5.76,5.69,3.49],[763,0.7,"Premium","E","VS2",61.4,59.0,2858,5.73,5.7,3.51],[764,0.71,"Premium","E","VS2",61.5,60.0,2858,5.76,5.68,3.52],[765,0.71,"Very Good","E","VS2",63.5,59.0,2858,5.68,5.59,3.58],[766,0.92,"Premium","J","SI1",62.9,58.0,2858,6.22,6.18,3.9],[767,0.76,"Ideal","E","SI1",62.7,54.0,2858,5.88,5.83,3.67],[768,0.73,"Ideal","D","SI1",61.5,56.0,2858,5.84,5.8,3.58],[769,0.71,"Premium","D","VS2",60.4,62.0,2858,5.74,5.72,3.46],[770,0.7,"Good","E","VVS2",63.6,62.0,2858,5.61,5.58,3.56],[771,0.9,"Fair","G","SI2",64.5,56.0,2858,6.06,6.0,3.89],[772,0.71,"Fair","D","VS2",56.9,65.0,2858,5.89,5.84,3.34],[773,0.7,"Ideal","D","VS2",61.0,57.0,2859,5.76,5.74,3.51],[774,0.7,"Premium","D","VS2",62.4,56.0,2859,5.72,5.66,3.55],[775,0.77,"Premium","F","VS1",60.9,60.0,2859,5.91,5.88,3.59],[776,0.71,"Ideal","G","VS1",61.5,56.0,2859,5.74,5.78,3.54],[777,0.7,"Premium","D","VS2",59.6,61.0,2859,5.8,5.77,3.45],[778,0.75,"Fair","F","VS1",55.8,70.0,2859,6.09,5.98,3.37],[779,0.83,"Premium","E","SI2",59.2,60.0,2859,6.17,6.12,3.64],[780,0.71,"Very Good","F","VS2",61.3,61.0,2860,5.68,5.73,3.5],[781,0.9,"Very Good","J","SI2",63.6,58.0,2860,6.07,6.1,3.87],[782,0.6,"Ideal","E","VVS2",61.9,54.9,2860,5.41,5.44,3.35],[783,0.71,"Premium","D","VS1",62.9,57.0,2860,5.66,5.6,3.54],[784,0.53,"Ideal","F","VVS1",61.4,57.0,2860,5.23,5.2,3.2],[785,0.71,"Premium","D","SI1",60.7,58.0,2861,5.95,5.78,3.56],[786,0.62,"Ideal","G","VVS2",61.6,56.0,2861,5.45,5.48,3.37],[787,0.62,"Ideal","G","VVS2",61.6,56.0,2861,5.48,5.51,3.38],[788,0.9,"Premium","I","SI1",63.0,58.0,2861,6.09,6.01,3.81],[789,0.62,"Fair","F","IF",60.1,61.0,2861,5.53,5.56,3.33],[790,0.82,"Premium","E","SI2",61.7,59.0,2861,6.01,5.98,3.7],[791,0.66,"Premium","D","VS1",61.0,58.0,2861,5.67,5.57,3.43],[792,0.7,"Very Good","D","SI1",62.5,55.0,2862,5.67,5.72,3.56],[793,0.8,"Very Good","F","SI1",62.6,58.0,2862,5.9,5.92,3.7],[794,0.8,"Very Good","D","SI2",62.5,59.0,2862,5.88,5.92,3.69],[795,0.79,"Premium","F","SI1",62.3,54.0,2862,5.97,5.91,3.7],[796,0.71,"Very Good","F","VVS1",63.2,60.0,2862,5.65,5.61,3.56],[797,0.7,"Ideal","H","VS2",61.1,57.0,2862,5.71,5.74,3.5],[798,0.7,"Very Good","E","VS2",58.7,63.0,2862,5.73,5.69,3.35],[799,0.79,"Premium","H","VS1",60.0,60.0,2862,6.07,5.99,3.64],[800,0.7,"Premium","E","VS2",59.5,59.0,2862,5.82,5.77,3.45],[801,1.22,"Premium","E","I1",60.9,57.0,2862,6.93,6.88,4.21],[802,1.01,"Fair","E","SI2",67.6,57.0,2862,6.21,6.11,4.18],[803,0.73,"Premium","E","VS2",62.5,61.0,2862,5.78,5.64,3.59],[804,0.91,"Good","I","VS2",64.3,58.0,2863,6.05,6.09,3.9],[805,0.71,"Ideal","D","SI1",60.8,56.0,2863,5.8,5.77,3.52],[806,0.83,"Premium","G","SI1",62.3,58.0,2863,6.01,5.97,3.73],[807,0.84,"Premium","F","SI2",62.3,59.0,2863,6.06,6.01,3.76],[808,0.71,"Premium","D","SI1",61.0,61.0,2863,5.82,5.75,3.53],[809,0.71,"Premium","D","SI1",59.7,59.0,2863,5.82,5.8,3.47],[810,0.71,"Premium","D","SI1",61.7,56.0,2863,5.8,5.68,3.54],[811,0.71,"Ideal","D","SI1",61.7,57.0,2863,5.75,5.7,3.53],[812,0.71,"Premium","D","SI1",61.4,58.0,2863,5.79,5.75,3.54],[813,0.71,"Premium","D","SI1",60.6,58.0,2863,5.79,5.77,3.5],[814,0.91,"Premium","J","SI1",59.5,62.0,2863,6.4,6.18,3.74],[815,0.9,"Premium","J","VS2",59.8,62.0,2863,6.24,6.21,3.72],[816,0.71,"Premium","H","VVS2",61.5,62.0,2863,5.74,5.68,3.51],[817,0.71,"Premium","E","SI1",59.1,61.0,2863,5.84,5.8,3.44],[818,0.72,"Ideal","F","VS2",59.5,57.0,2863,5.91,5.86,3.5],[819,0.72,"Premium","E","SI1",60.9,60.0,2863,5.78,5.74,3.51],[820,0.71,"Ideal","E","VS2",61.0,55.0,2863,5.79,5.75,3.52],[821,0.81,"Ideal","E","SI2",60.3,57.0,2864,6.07,6.04,3.65],[822,0.83,"Very Good","I","VS2",61.6,58.0,2865,6.05,6.07,3.73],[823,0.73,"Premium","D","SI1",60.8,55.0,2865,5.87,5.81,3.55],[824,0.56,"Very Good","D","VVS1",62.0,56.0,2866,5.25,5.3,3.27],[825,0.56,"Very Good","D","VVS1",61.8,55.0,2866,5.27,5.31,3.27],[826,0.71,"Ideal","E","VS1",62.2,55.0,2866,5.74,5.7,3.56],[827,0.7,"Ideal","H","VVS1",62.3,58.0,2866,5.66,5.7,3.54],[828,0.96,"Premium","I","SI1",61.3,58.0,2866,6.39,6.3,3.89],[829,0.71,"Very Good","H","VVS1",62.9,57.0,2867,5.67,5.69,3.57],[830,0.7,"Ideal","D","VS2",62.4,57.0,2867,5.68,5.61,3.52],[831,0.71,"Ideal","H","VVS1",60.4,57.0,2867,5.78,5.81,3.5],[832,0.8,"Premium","H","VS2",61.2,53.0,2867,6.05,5.98,3.68],[833,0.95,"Premium","F","SI2",58.4,57.0,2867,6.49,6.41,3.77],[834,0.82,"Ideal","F","SI2",62.3,56.0,2867,5.99,5.95,3.72],[835,0.52,"Ideal","F","VVS1",61.2,56.0,2867,5.21,5.19,3.18],[836,0.82,"Ideal","F","SI2",61.7,53.0,2867,6.12,6.0,3.74],[837,0.82,"Ideal","F","SI2",62.3,56.0,2867,6.02,5.96,3.73],[838,0.82,"Premium","F","SI2",59.7,57.0,2867,6.14,6.12,3.66],[839,0.8,"Ideal","G","SI1",61.3,57.0,2867,5.96,5.91,3.64],[840,0.96,"Fair","F","SI2",68.2,61.0,2867,6.07,5.88,4.1],[841,0.72,"Ideal","I","VS1",62.4,55.0,2868,5.72,5.75,3.58],[842,0.62,"Ideal","G","IF",60.5,57.0,2868,5.52,5.56,3.35],[843,0.79,"Premium","E","SI2",61.0,58.0,2868,5.96,5.9,3.62],[844,0.75,"Very Good","E","SI1",63.1,56.0,2868,5.78,5.7,3.62],[845,1.08,"Premium","D","I1",61.9,60.0,2869,6.55,6.48,4.03],[846,0.72,"Ideal","E","SI1",60.8,55.0,2869,5.77,5.84,3.53],[847,0.62,"Ideal","G","IF",61.8,56.0,2869,5.43,5.47,3.37],[848,0.73,"Ideal","G","VVS2",61.3,57.0,2869,5.84,5.81,3.57],[849,0.72,"Ideal","H","VVS2",60.9,57.0,2869,5.79,5.77,3.52],[850,0.52,"Premium","F","VVS2",61.8,60.0,2870,5.16,5.13,3.18],[851,0.83,"Ideal","E","SI2",62.2,57.0,2870,6.0,6.05,3.75],[852,0.64,"Premium","E","VVS2",62.1,58.0,2870,5.56,5.51,3.44],[853,0.8,"Ideal","G","SI1",62.5,57.0,2870,5.94,5.9,3.7],[854,0.74,"Ideal","H","SI1",62.1,56.0,2870,5.77,5.83,3.6],[855,0.72,"Ideal","F","SI1",61.5,56.0,2870,5.72,5.79,3.54],[856,0.82,"Ideal","H","VS2",59.5,57.0,2870,6.12,6.09,3.63],[857,0.73,"Premium","E","VS1",61.3,59.0,2870,5.81,5.78,3.55],[858,1.04,"Premium","I","I1",61.6,61.0,2870,6.47,6.45,3.98],[859,0.73,"Very Good","E","SI1",61.3,58.0,2871,5.76,5.83,3.55],[860,0.73,"Good","E","SI1",63.6,57.0,2871,5.7,5.72,3.63],[861,0.9,"Premium","J","SI1",62.8,59.0,2871,6.13,6.03,3.82],[862,0.75,"Ideal","I","SI1",61.8,55.0,2871,5.83,5.85,3.61],[863,0.79,"Ideal","G","SI1",62.6,55.0,2871,5.91,5.95,3.71],[864,0.7,"Good","D","SI1",62.5,56.7,2872,5.59,5.62,3.51],[865,0.75,"Very Good","D","SI1",60.7,55.0,2872,5.87,5.92,3.58],[866,1.02,"Ideal","I","I1",61.7,56.0,2872,6.44,6.49,3.99],[867,0.7,"Very Good","G","SI2",59.0,62.0,2872,5.79,5.81,3.42],[868,0.7,"Ideal","D","SI1",61.8,56.0,2872,5.63,5.73,3.51],[869,0.7,"Good","E","SI1",61.4,64.0,2872,5.66,5.71,3.49],[870,0.7,"Ideal","D","SI1",61.4,54.0,2872,5.71,5.75,3.52],[871,0.7,"Ideal","D","SI1",60.7,56.0,2872,5.72,5.75,3.48],[872,0.7,"Very Good","D","SI1",60.2,60.0,2872,5.75,5.82,3.48],[873,0.72,"Very Good","E","VS2",58.3,57.0,2872,5.89,5.94,3.45],[874,0.74,"Ideal","E","SI1",62.3,58.0,2872,5.74,5.78,3.59],[875,0.84,"Good","G","SI1",65.1,55.0,2872,5.88,5.97,3.86],[876,0.76,"Very Good","F","VS2",62.0,58.0,2873,5.8,5.86,3.62],[877,0.77,"Very Good","E","SI1",63.2,58.0,2873,5.8,5.84,3.68],[878,0.76,"Ideal","E","SI2",62.8,56.0,2873,5.78,5.82,3.64],[879,1.0,"Ideal","I","SI2",61.7,56.0,2873,6.45,6.41,3.97],[880,1.0,"Fair","H","SI1",65.5,62.0,2873,6.14,6.07,4.0],[881,0.9,"Fair","I","SI1",65.7,58.0,2873,6.03,6.0,3.95],[882,0.9,"Premium","J","SI1",61.8,58.0,2873,6.16,6.13,3.8],[883,0.9,"Good","J","SI1",64.0,61.0,2873,6.0,5.96,3.83],[884,0.9,"Fair","I","SI1",65.3,61.0,2873,5.98,5.94,3.89],[885,0.9,"Fair","I","SI1",65.8,56.0,2873,6.01,5.96,3.94],[886,0.9,"Premium","J","SI1",60.9,61.0,2873,6.26,6.22,3.8],[887,0.78,"Premium","F","VS2",62.6,58.0,2874,5.91,5.82,3.67],[888,0.71,"Premium","D","VS2",61.2,59.0,2874,5.69,5.74,3.5],[889,0.7,"Premium","F","VS1",59.0,59.0,2874,5.79,5.77,3.41],[890,0.7,"Premium","F","VS1",60.8,62.0,2874,5.71,5.67,3.46],[891,0.7,"Premium","G","VVS2",61.8,58.0,2874,5.67,5.63,3.49],[892,0.7,"Ideal","F","VS1",61.0,55.0,2874,5.77,5.73,3.51],[893,0.7,"Ideal","F","VS1",61.6,55.0,2874,5.75,5.71,3.53],[894,0.7,"Ideal","F","VS1",62.4,56.0,2874,5.69,5.65,3.54],[895,0.7,"Premium","G","VVS2",62.9,59.0,2874,5.68,5.61,3.55],[896,1.0,"Fair","H","SI2",67.7,60.0,2875,6.11,5.98,4.09],[897,0.77,"Ideal","H","SI1",62.4,56.0,2875,5.84,5.9,3.66],[898,1.0,"Fair","J","VS1",65.5,55.0,2875,6.3,6.25,4.11],[899,1.0,"Fair","I","SI1",66.3,61.0,2875,6.08,6.03,4.01],[900,1.0,"Fair","H","SI2",69.5,55.0,2875,6.17,6.1,4.26],[901,0.73,"Premium","E","VS1",62.6,60.0,2876,5.68,5.75,3.58],[902,0.79,"Premium","E","VS2",60.6,53.0,2876,6.04,5.98,3.64],[903,0.72,"Very Good","H","VS1",62.2,54.0,2877,5.74,5.76,3.57],[904,0.71,"Ideal","E","VS1",62.4,56.0,2877,5.75,5.7,3.57],[905,0.74,"Ideal","G","VS2",62.3,55.0,2877,5.8,5.83,3.62],[906,0.7,"Good","H","VVS1",62.7,56.0,2877,5.6,5.66,3.53],[907,0.7,"Good","F","VS1",59.1,62.0,2877,5.82,5.86,3.44],[908,0.79,"Very Good","F","SI1",62.8,59.0,2878,5.86,5.89,3.69],[909,0.79,"Very Good","F","SI1",62.7,60.0,2878,5.82,5.89,3.67],[910,0.79,"Very Good","D","SI2",59.7,58.0,2878,6.0,6.07,3.6],[911,0.71,"Ideal","I","VS2",61.5,55.0,2878,5.76,5.78,3.55],[912,0.79,"Ideal","F","SI1",62.8,56.0,2878,5.88,5.9,3.7],[913,0.73,"Very Good","F","SI1",61.4,56.0,2879,5.81,5.86,3.58],[914,0.63,"Premium","E","IF",60.3,62.0,2879,5.55,5.53,3.34],[915,0.7,"Premium","F","VS1",60.4,60.0,2879,5.73,5.7,3.45],[916,0.71,"Premium","F","VS1",62.7,58.0,2879,5.71,5.67,3.57],[917,0.84,"Ideal","G","SI2",61.0,56.0,2879,6.13,6.1,3.73],[918,0.84,"Ideal","G","SI2",62.3,55.0,2879,6.08,6.03,3.77],[919,1.02,"Ideal","J","SI2",60.3,54.0,2879,6.53,6.5,3.93],[920,0.72,"Fair","F","VS1",56.9,69.0,2879,5.93,5.77,3.33],[921,0.72,"Ideal","F","VS1",62.0,56.0,2879,5.76,5.73,3.56],[922,0.92,"Very Good","J","SI2",58.7,61.0,2880,6.34,6.43,3.75],[923,0.74,"Very Good","D","SI1",63.9,57.0,2880,5.72,5.74,3.66],[924,0.7,"Ideal","H","VVS1",62.0,55.0,2881,5.74,5.71,3.55],[925,0.71,"Very Good","E","VS2",60.0,59.0,2881,5.84,5.83,3.5],[926,1.05,"Premium","H","I1",62.0,59.0,2881,6.5,6.47,4.02],[927,0.7,"Very Good","H","IF",62.8,56.0,2882,5.62,5.65,3.54],[928,0.54,"Ideal","F","VVS1",61.8,56.0,2882,5.23,5.26,3.24],[929,0.73,"Premium","F","VS2",59.9,58.0,2882,5.87,5.84,3.51],[930,0.88,"Fair","F","SI1",56.6,65.0,2882,6.39,6.32,3.6],[931,0.73,"Premium","F","VS2",58.7,57.0,2882,5.97,5.92,3.49],[932,0.72,"Ideal","D","SI1",61.8,56.0,2883,5.75,5.81,3.57],[933,0.9,"Good","H","SI2",62.7,64.0,2883,6.09,6.0,3.79],[934,0.9,"Fair","H","SI2",65.0,61.0,2883,6.01,5.96,3.89],[935,1.03,"Fair","I","SI2",65.3,55.0,2884,6.32,6.27,4.11],[936,0.84,"Very Good","F","SI1",63.8,57.0,2885,5.95,6.0,3.81],[937,1.01,"Premium","I","SI1",62.7,60.0,2885,6.36,6.27,3.96],[938,0.77,"Ideal","D","SI2",61.5,55.0,2885,5.9,5.93,3.64],[939,0.8,"Fair","E","SI1",56.3,63.0,2885,6.22,6.14,3.48],[940,0.9,"Fair","D","SI2",66.9,57.0,2885,6.02,5.9,3.99],[941,0.73,"Ideal","E","SI1",61.4,56.0,2886,5.79,5.81,3.56],[942,0.72,"Ideal","E","SI1",62.7,55.0,2886,5.64,5.69,3.55],[943,0.71,"Very Good","D","SI1",62.4,54.0,2887,5.71,5.79,3.59],[944,0.7,"Premium","E","VS1",62.6,59.0,2887,5.66,5.69,3.55],[945,0.79,"Ideal","I","VS1",61.7,59.0,2888,5.93,5.96,3.67],[946,0.72,"Very Good","G","VVS2",62.5,58.0,2889,5.68,5.72,3.56],[947,0.7,"Very Good","E","VS2",63.5,54.0,2889,5.62,5.66,3.58],[948,0.7,"Very Good","F","VS1",62.2,58.0,2889,5.64,5.75,3.54],[949,0.9,"Good","H","SI2",63.5,58.0,2889,6.09,6.14,3.88],[950,0.71,"Very Good","F","VS1",62.8,56.0,2889,5.69,5.72,3.58],[951,0.5,"Ideal","E","VVS2",62.2,54.0,2889,5.08,5.12,3.17],[952,0.5,"Ideal","E","VVS2",62.2,54.0,2889,5.09,5.11,3.17],[953,0.74,"Ideal","F","SI1",61.2,56.0,2889,5.83,5.87,3.58],[954,0.77,"Premium","F","VS2",61.8,56.0,2889,5.94,5.9,3.66],[955,0.77,"Premium","E","SI1",59.8,61.0,2889,5.99,5.95,3.57],[956,0.8,"Ideal","F","SI1",61.5,54.0,2890,6.07,6.0,3.71],[957,0.8,"Ideal","F","SI1",62.4,57.0,2890,5.9,5.87,3.67],[958,0.8,"Premium","F","SI1",61.5,60.0,2890,5.97,5.94,3.66],[959,0.8,"Good","F","SI1",63.8,59.0,2890,5.87,5.83,3.73],[960,0.66,"Ideal","G","VVS1",61.5,56.0,2890,5.61,5.58,3.44],[961,0.71,"Very Good","E","VS2",61.2,58.0,2891,5.71,5.79,3.52],[962,0.71,"Ideal","F","VS2",61.2,56.0,2891,5.73,5.77,3.52],[963,0.71,"Ideal","E","VS2",61.6,56.0,2891,5.74,5.76,3.54],[964,0.71,"Ideal","E","VS2",62.7,56.0,2891,5.71,5.75,3.59],[965,0.72,"Ideal","D","SI1",61.1,56.0,2891,5.78,5.81,3.54],[966,0.71,"Good","D","VS2",62.3,61.0,2891,5.7,5.73,3.56],[967,0.86,"Ideal","H","SI2",61.8,55.0,2892,6.12,6.14,3.79],[968,1.19,"Fair","H","I1",65.1,59.0,2892,6.62,6.55,4.29],[969,0.71,"Very Good","F","VS1",62.6,55.0,2893,5.66,5.71,3.56],[970,0.82,"Very Good","G","SI2",62.5,56.0,2893,5.99,6.04,3.76],[971,0.71,"Ideal","G","VVS2",61.5,57.0,2893,5.73,5.75,3.53],[972,0.75,"Ideal","F","VS2",62.5,57.0,2893,5.78,5.83,3.63],[973,0.7,"Very Good","H","VVS1",59.2,60.0,2893,5.87,5.78,3.45],[974,0.8,"Ideal","G","SI2",62.5,55.0,2893,5.89,5.92,3.69],[975,0.82,"Good","G","SI2",59.9,62.0,2893,6.02,6.04,3.61],[976,0.82,"Very Good","G","SI1",63.4,55.0,2893,6.0,5.93,3.78],[977,0.82,"Premium","G","SI1",59.9,59.0,2893,6.09,6.06,3.64],[978,0.81,"Very Good","E","SI2",62.4,57.0,2894,5.91,5.99,3.71],[979,0.81,"Ideal","G","SI2",62.2,57.0,2894,5.96,6.0,3.72],[980,0.76,"Ideal","F","SI1",61.4,56.0,2894,5.88,5.92,3.62],[981,0.71,"Very Good","G","VS2",60.9,56.0,2895,5.75,5.78,3.51],[982,0.7,"Very Good","F","VS1",61.8,59.0,2895,5.66,5.76,3.53],[983,0.7,"Ideal","G","VVS2",62.1,53.0,2895,5.71,5.75,3.56],[984,0.74,"Very Good","G","VS1",59.8,58.0,2896,5.85,5.89,3.51],[985,0.77,"Very Good","G","VS2",61.3,60.0,2896,5.81,5.91,3.59],[986,0.77,"Very Good","G","VS2",58.3,63.0,2896,6.0,6.05,3.51],[987,0.53,"Ideal","F","VVS1",61.6,56.0,2896,5.18,5.24,3.21],[988,0.79,"Ideal","D","SI1",61.5,56.0,2896,5.91,5.96,3.65],[989,0.73,"Ideal","E","SI2",61.5,55.0,2896,5.82,5.86,3.59],[990,0.77,"Ideal","D","SI2",62.1,56.0,2896,5.83,5.89,3.64],[991,0.77,"Premium","E","SI1",60.9,58.0,2896,5.94,5.88,3.6],[992,1.01,"Very Good","I","I1",63.1,57.0,2896,6.39,6.35,4.02],[993,1.01,"Ideal","I","I1",61.5,57.0,2896,6.46,6.45,3.97],[994,0.6,"Very Good","D","VVS2",60.6,57.0,2897,5.48,5.51,3.33],[995,0.76,"Premium","E","SI1",61.1,58.0,2897,5.91,5.85,3.59],[996,0.54,"Ideal","D","VVS2",61.4,52.0,2897,5.3,5.34,3.26],[997,0.72,"Ideal","E","SI1",62.5,55.0,2897,5.69,5.74,3.57],[998,0.72,"Good","F","VS1",59.4,61.0,2897,5.82,5.89,3.48],[999,0.74,"Premium","D","VS2",61.8,58.0,2897,5.81,5.77,3.58],[1000,1.12,"Premium","J","SI2",60.6,59.0,2898,6.68,6.61,4.03]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"_c0","type":"\"integer\"","metadata":"{}"},{"name":"carat","type":"\"double\"","metadata":"{}"},{"name":"cut","type":"\"string\"","metadata":"{}"},{"name":"color","type":"\"string\"","metadata":"{}"},{"name":"clarity","type":"\"string\"","metadata":"{}"},{"name":"depth","type":"\"double\"","metadata":"{}"},{"name":"table","type":"\"double\"","metadata":"{}"},{"name":"price","type":"\"integer\"","metadata":"{}"},{"name":"x","type":"\"double\"","metadata":"{}"},{"name":"y","type":"\"double\"","metadata":"{}"},{"name":"z","type":"\"double\"","metadata":"{}"}],"overflow":true,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1492492955165,"submitTime":1492492952680,"finishTime":1492492955238,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"770d93de-bf16-410b-b1e1-25ce3e230647"},{"version":"CommandV1","origId":2580593937400010,"guid":"f249fa6e-8147-4cfe-8dd7-e0730dc04488","subtype":"command","commandType":"auto","position":6.3828125,"command":"%md\n\n## Data Preperation","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1492492952774,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a07947c3-68b6-498e-9826-b8566858645f"},{"version":"CommandV1","origId":2580593937400011,"guid":"36c1ffc3-7f6c-458f-a924-bf68f3571860","subtype":"command","commandType":"auto","position":6.384765625,"command":"%md\n\nFor this notebook we will examine a subset of the columns and only expensive diamonds.  In the following we use the Dataframe API to subselect the data. ","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1492492952789,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d2b7a294-3eb6-42c9-ba23-44ab4199299a"},{"version":"CommandV1","origId":2580593937400012,"guid":"5a6b08cc-e2b2-4469-9b20-10334cc87efe","subtype":"command","commandType":"auto","position":6.390625,"command":"data = (\n  diamonds\n    .where(diamonds['price'] > 1000)\n    .select(['cut', 'color', 'carat', 'clarity', 'price'])\n)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1492492955248,"submitTime":1492492952839,"finishTime":1492492955318,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"db96d43c-0957-4148-b5b3-4136b6f706ea"},{"version":"CommandV1","origId":2580593937400013,"guid":"d6ce76ef-a2f1-4874-8f84-1f9d65f344ba","subtype":"command","commandType":"auto","position":6.400390625,"command":"display(data.sample(False, 0.01).select(['carat', 'price']))","commandVersion":0,"state":"finished","results":{"type":"table","data":[[0.73,2796],[0.71,2817],[0.8,2818],[0.82,2832],[0.7,2838],[0.81,2843],[0.9,2863],[0.77,2873],[1.02,2925],[0.82,2939],[0.75,3011],[0.77,3044],[0.91,3047],[0.7,3052],[0.71,3061],[0.93,3114],[1.0,3136],[0.71,3145],[1.0,3175],[0.63,3181],[0.72,3183],[0.8,3273],[0.7,3276],[0.71,3281],[0.9,3307],[0.9,3308],[0.72,3417],[0.77,3428],[1.15,3510],[1.24,3528],[1.03,3530],[0.93,3594],[1.01,3620],[1.0,3634],[0.76,3649],[0.72,3689],[1.1,3690],[0.97,3717],[0.9,3752],[0.82,3798],[0.9,3841],[1.0,3864],[0.8,3890],[1.24,3908],[0.92,3916],[1.01,3916],[0.9,3931],[0.9,3933],[0.9,3945],[0.9,3950],[0.9,3984],[0.91,3991],[1.01,3998],[0.71,4029],[1.0,4032],[1.02,4044],[0.99,4052],[0.9,4064],[1.01,4072],[1.01,4118],[0.8,4126],[1.05,4163],[1.0,4163],[1.0,4170],[1.0,4204],[1.02,4207],[0.76,4223],[0.9,4320],[1.0,4328],[0.91,4345],[1.01,4355],[1.13,4360],[1.0,4419],[1.01,4434],[1.0,4452],[0.8,4468],[1.06,4471],[1.08,4476],[0.91,4502],[1.22,4509],[1.05,4529],[1.05,4560],[1.03,4586],[1.2,4590],[1.01,4672],[1.05,4692],[1.07,4700],[1.2,4744],[1.01,4745],[1.1,4764],[1.01,4853],[1.01,4865],[1.21,4879],[1.06,4903],[1.13,4932],[1.14,4935],[1.04,4941],[1.12,4955],[1.02,4964],[1.1,4967],[0.83,4989],[1.0,5000],[1.16,5001],[1.05,5027],[1.23,5039],[1.01,5055],[1.02,5079],[1.2,5082],[1.18,5088],[1.04,5102],[1.03,5105],[1.02,5115],[0.9,5122],[1.16,5124],[1.04,5137],[1.13,5179],[1.04,5189],[1.23,5191],[1.03,5241],[1.06,5247],[1.02,5278],[1.0,5286],[1.12,5291],[1.0,5292],[1.26,5292],[1.01,5294],[1.02,5350],[1.02,5430],[1.11,5439],[1.27,5455],[1.01,5475],[1.01,5486],[1.02,5565],[1.2,5567],[1.18,5617],[1.0,5645],[1.32,5717],[1.2,5746],[1.68,5765],[1.14,5801],[1.03,5804],[1.12,6143],[1.0,6216],[1.5,6224],[1.19,6335],[1.2,6344],[1.07,6355],[1.04,6368],[1.02,6397],[1.09,6570],[1.0,6600],[1.1,6653],[1.12,6683],[1.0,6732],[1.2,6742],[1.21,6745],[1.5,6746],[1.16,6755],[1.22,6776],[1.03,6783],[0.8,6834],[1.24,6840],[1.01,7013],[1.15,7123],[1.73,7270],[1.01,7306],[1.23,7313],[1.0,7392],[1.11,7480],[1.02,7485],[1.0,7588],[1.31,7732],[1.51,7848],[1.52,7906],[1.07,8015],[1.7,8115],[1.33,8163],[1.02,8347],[1.51,8371],[1.0,8602],[1.52,8631],[1.17,8639],[1.22,8733],[1.52,8778],[1.16,8803],[1.51,8879],[1.5,8931],[1.05,8931],[1.06,8954],[1.08,8999],[1.26,9032],[1.5,9033],[1.5,9072],[1.02,9103],[1.79,9122],[1.51,9140],[1.07,9276],[1.51,9467],[2.68,9665],[1.16,9901],[1.57,9912],[1.21,9942],[1.13,10016],[1.5,10023],[1.74,10085],[1.53,10098],[1.59,10106],[1.53,10196],[1.5,10256],[1.51,10274],[1.21,10482],[1.72,10869],[1.5,10907],[1.5,10962],[1.01,11082],[1.53,11280],[1.58,11428],[1.18,11430],[1.51,11435],[1.7,11519],[1.5,11638],[1.51,11917],[1.7,11921],[1.56,12226],[1.9,12443],[1.57,12810],[2.01,12845],[1.73,12931],[1.56,13178],[1.35,13230],[1.73,13250],[1.63,13555],[2.17,13556],[2.3,13560],[1.51,13686],[1.52,13919],[1.51,13945],[1.7,14146],[2.14,14267],[1.51,14416],[1.51,14482],[2.01,15140],[2.01,15145],[2.75,15415],[2.04,15760],[2.01,15773],[1.61,15819],[1.55,15887],[2.09,16703],[1.58,17329],[1.51,17649],[2.02,17692],[2.08,17778],[2.01,18252],[1.93,18306],[2.0,18440],[2.37,18508],[2.0,18795],[2.0,18803],[0.35,1001],[0.33,1002],[0.39,1004],[0.6,1009],[0.43,1016],[0.35,1028],[0.5,1035],[0.4,1056],[0.37,1056],[0.44,1059],[0.54,1065],[0.38,1074],[0.39,1097],[0.38,1097],[0.31,1107],[0.33,1114],[0.36,1119],[0.4,1125],[0.41,1151],[0.38,1160],[0.31,1168],[0.46,1168],[0.52,1170],[0.34,1174],[0.52,1175],[0.44,1194],[0.38,1218],[0.46,1221],[0.42,1221],[0.4,1226],[0.41,1230],[0.51,1243],[0.56,1243],[0.46,1252],[0.56,1259],[0.57,1292],[0.41,1295],[0.42,1310],[0.42,1326],[0.5,1362],[0.54,1385],[0.52,1389],[0.42,1389],[0.5,1433],[0.39,1433],[0.71,1435],[0.5,1436],[0.54,1439],[0.51,1549],[0.55,1551],[0.5,1571],[0.66,1609],[0.53,1610],[0.53,1610],[0.5,1635],[0.69,1636],[0.5,1637],[0.52,1651],[0.5,1654],[0.51,1656],[0.5,1657],[0.55,1659],[0.43,1659],[0.54,1662],[0.51,1662],[0.54,1667],[0.5,1676],[0.51,1682],[0.43,1683],[0.52,1689],[0.55,1692],[0.56,1698],[0.52,1701],[0.56,1723],[0.57,1751],[0.53,1772],[0.51,1781],[0.51,1781],[0.61,1805],[0.96,1808],[0.46,1816],[0.75,1827],[0.66,1832],[0.52,1844],[0.7,1855],[0.6,1861],[0.51,1875],[0.53,1908],[0.52,1919],[0.71,1930],[0.5,1935],[0.9,1939],[0.57,1949],[0.57,1949],[0.51,1974],[0.65,1989],[0.76,2026],[0.5,2068],[0.5,2070],[0.79,2095],[0.71,2096],[0.7,2100],[0.57,2110],[0.56,2117],[0.6,2130],[0.56,2135],[0.5,2153],[0.62,2173],[0.7,2213],[0.71,2226],[0.56,2230],[0.71,2258],[0.55,2259],[0.7,2259],[0.56,2292],[0.97,2370],[0.7,2394],[0.7,2423],[0.7,2459],[0.76,2469],[0.72,2501],[0.7,2513],[0.73,2519],[0.59,2554],[0.73,2565],[0.59,2679],[0.76,2679],[0.82,2692],[0.76,2706],[0.9,2717],[0.7,2728],[0.66,2732],[0.8,2739],[0.7,2753]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"carat","type":"\"double\"","metadata":"{}"},{"name":"price","type":"\"integer\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1492492955321,"submitTime":1492492952850,"finishTime":1492492955446,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"scatterPlot","width":"670","height":"334","xColumns":[],"yColumns":["carat","price"],"pivotColumns":[],"pivotAggregation":"sum","customPlotOptions":{"barChart":[{"key":"grouped","value":true},{"key":"stacked","value":false},{"key":"100_stacked","value":false}],"lineChart":[],"scatterPlot":[{"key":"loess","value":true},{"key":"bandwidth","value":"0.3"}]},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8feb9633-753c-4610-afca-33b6f48d5779"},{"version":"CommandV1","origId":2580593937400014,"guid":"8ce50b75-b68f-4938-a6a4-df6d168a8061","subtype":"command","commandType":"auto","position":6.4013671875,"command":"%md\n# Spark RDD Exercise","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1492492952863,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d08d111e-5c32-4ac2-b228-6e3970738c07"},{"version":"CommandV1","origId":2580593937400015,"guid":"f557f494-95dd-491d-9b76-f21b48c6dbe7","subtype":"command","commandType":"auto","position":6.40185546875,"command":"%md\n\nLet's count the number of diamonds in each cut:","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1492492952880,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"604aeafa-879c-46a7-9cf1-29fd292897d2"},{"version":"CommandV1","origId":2580593937400016,"guid":"f281f049-20a8-4150-914f-fb70910c1c4f","subtype":"command","commandType":"auto","position":6.402099609375,"command":"# We can access the underlying RDD for any dataframe\nrdd = data.rdd\nrdd","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">67</span><span class=\"ansired\">]: </span>MapPartitionsRDD[415] at javaToPython at NativeMethodAccessorImpl.java:0\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1492492955450,"submitTime":1492492952897,"finishTime":1492492955521,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a7da76ab-6d5e-4837-a656-6423a4b6887a"},{"version":"CommandV1","origId":2580593937400017,"guid":"61344882-a311-4d00-90a3-041b395f1e09","subtype":"command","commandType":"auto","position":6.4022216796875,"command":"%md\nSpark is implemented in Scala (which runs in Java) and thus much of the backend of Spark is backed by java functionality (hence `JavaToPython`).  We will now try a few functions on the `rdd`.  This RDD is composed of [`Row` objects](http://spark.apache.org/docs/2.1.0/api/python/pyspark.sql.html#pyspark.sql.Row) that behave like python dictionaries and even have a convenient `toDict()` function that returns a native Python dictionary.  They keys in the row correspond to the columns in the dataframe.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1492492952908,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"3e905549-a15d-483c-96ad-2c146a97320e"},{"version":"CommandV1","origId":2580593937400018,"guid":"bba0ee77-c87b-4a6e-b92c-259d4ee320f3","subtype":"command","commandType":"auto","position":6.40228271484375,"command":"rdd.count()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">68</span><span class=\"ansired\">]: </span>39416\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1492492955524,"submitTime":1492492952938,"finishTime":1492492955794,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"af68066a-e671-4f72-b7cb-0333e22c1f14"},{"version":"CommandV1","origId":2580593937400019,"guid":"152e8bca-396f-4534-aacc-ba15589c9e40","subtype":"command","commandType":"auto","position":6.4022979736328125,"command":"%md\n\nThe following code snippet will take an RDD and transform each row into a tuple consisting of the String corresponding to the color of the diamond in that row and the integer 1.  The [`reduceByKey`](http://spark.apache.org/docs/2.1.0/api/python/pyspark.html#pyspark.RDD.reduceByKey) function assums that the input RDD consists of tuples of `(key, value)` pairs. It takes a function that takes two values (or intermediate value) and combines them to produce a new value.   Notice that nothing happens when we run this cell:","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1492492952949,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d7b00984-78e7-4e04-9272-88f9e0c9df8a"},{"version":"CommandV1","origId":2580593937400020,"guid":"7de508c3-ca96-41c4-8ed8-c03e18769057","subtype":"command","commandType":"auto","position":6.402313232421875,"command":"counts_rdd = rdd.map(lambda row: (row['color'], 1)).reduceByKey(lambda a, b: a + b)\ncounts_rdd","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">69</span><span class=\"ansired\">]: </span>PythonRDD[421] at RDD at PythonRDD.scala:44\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1492492955798,"submitTime":1492492952973,"finishTime":1492492955867,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2d8f4bda-36f4-40b5-9fd1-c734c4865ded"},{"version":"CommandV1","origId":2580593937400021,"guid":"04d7a6d9-6b85-42ff-93f0-9b3425c90fa1","subtype":"command","commandType":"auto","position":6.402320861816406,"command":"%md\n\nTo compute an actual value we instead must invoke an action like [`collect()`](http://spark.apache.org/docs/2.1.0/api/python/pyspark.html#pyspark.RDD.collect) or [`count()`](http://spark.apache.org/docs/2.1.0/api/python/pyspark.html#pyspark.RDD.count).","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1492492952983,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"07652748-7fc7-4d09-aedd-aeac54c752b8"},{"version":"CommandV1","origId":2580593937400022,"guid":"5fe90321-9c1c-46cc-9db3-7d0d35405d3c","subtype":"command","commandType":"auto","position":6.4023284912109375,"command":"counts_rdd.collect()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">70</span><span class=\"ansired\">]: </span>\n[(u&apos;E&apos;, 6747),\n (u&apos;D&apos;, 4743),\n (u&apos;G&apos;, 8118),\n (u&apos;F&apos;, 7071),\n (u&apos;I&apos;, 4191),\n (u&apos;H&apos;, 6201),\n (u&apos;J&apos;, 2345)]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1492492955870,"submitTime":1492492953000,"finishTime":1492492956244,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5cc25c98-72da-4d0c-8955-56ae6f60c7dc"},{"version":"CommandV1","origId":2580593937400023,"guid":"8abdfaf0-198f-4d11-a94e-9f78eb052aab","subtype":"command","commandType":"auto","position":6.402336120605469,"command":"%md\n\n# Least Squares Regression in Map-Reduce\n\nTo implement least squares regression in map-reduce we recall that the the optimal parameter value is given by the **normal equation**:\n\n$$\n\\hat{\\theta} = \\left(X^TX\\right)^{-1} X^T Y\n$$\n\nWe can compute a single entry in the \\\\(X^T X\\\\) matrix:\n\n$$\n\\left(X^T X\\right)_{i,j} \n= \\sum_{k=1}^n X_{i,k} X_{k,j}\n$$\n","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1492492953011,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"81759a39-ecf5-4d40-af57-bbeefd439607"},{"version":"CommandV1","origId":2580593937400024,"guid":"b4d3183f-0c1f-4b8f-9e29-9e61849c0937","subtype":"command","commandType":"auto","position":6.402339935302734,"command":"%md\nIn the following we specify the set of features and which features are categorical.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1492492953026,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b0ccc638-3713-436e-ba05-9263b9826d02"},{"version":"CommandV1","origId":2580593937400025,"guid":"9c612b90-9869-4dfb-a6a0-72869a76bcb9","subtype":"command","commandType":"auto","position":6.40234375,"command":"features = ['cut', 'color', 'carat', 'clarity']\ncategorical = set(['cut', 'color', 'clarity'])\nlabel = 'price'","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1492492956247,"submitTime":1492492953059,"finishTime":1492492956317,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"4c863ca2-131b-47b7-95a9-905844598c0d"},{"version":"CommandV1","origId":2580593937400026,"guid":"b44d26f5-52a1-4da0-abbe-e4965a0b67b7","subtype":"command","commandType":"auto","position":6.412109375,"command":"%md\nWe then define two map functions:\n1. `xtx_map`: which computes the entries of the $$ X^T X = \\sum_{i=1}^n x_i x_i^T$$ matrix\n1. `xty_map`: which computes the entries of the $$ X^T Y = \\sum_{i=1}^n x_i y_i$$ matrix\n\nThese functions are slightly more complex because they implement one hot encoding of the categorical features.  Try to figure out how they work. A few observations:\n1. They reach return multiple values using the python `yield` syntax\n1. The values correspond to entries in the matrix \\\\(x x^T\\\\) and \\\\(x y\\\\) respectively.\n1. Categorical features (e.g., `cut=\"Ideal\"`) are mapped to new features (e.g., `cut_Ideal=1.0`) with value 1.0","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1492492953069,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ad3a6096-71fe-49fa-81f6-8c359f9e8371"},{"version":"CommandV1","origId":2656932873031532,"guid":"c8a85aad-ba0a-42f6-b7bc-abc4dab255ee","subtype":"command","commandType":"auto","position":6.4169921875,"command":"def xty_map(row):\n  row = row.asDict()\n  for i in features:\n    # If the features is not categorical (e.g., carat) then:\n    #    the features name is just the name of the feature and \n    #    the value is just the value\n    # otherwise the feature is categorical and we implement a one-hot-encoding\n    #    the feature name is the name + \"_\" + value (e.g., cut_Ideal)\n    #    the feature value is 1.0\n    (ki, vi) = (i, row[i]) if i not in categorical else (i+\"_\"+row[i], 1.0)\n    yield (ki, vi * row[label])","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1492492956319,"submitTime":1492492953087,"finishTime":1492492956388,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"bd7e2ee2-602d-4620-b9b3-e341b9c4e6d6"},{"version":"CommandV1","origId":2580593937400027,"guid":"f3139621-f9b0-44a6-9b96-71e3da7741f3","subtype":"command","commandType":"auto","position":6.421875,"command":"def xtx_map(row):\n  row = row.asDict()\n  # Iterating over features = ['cut', 'carat', ...]\n  # we are computing the outer product over each feature value:\n  for i in features:\n    (ki, vi) = (i, row[i]) if i not in categorical else (i+\"_\"+row[i], 1.0)\n    for j in features:\n      (kj, vj) = (j, row[j]) if j not in categorical else (j+\"_\"+row[j], 1.0)\n      yield ((ki,kj), vi * vj)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1492492956390,"submitTime":1492492953097,"finishTime":1492492956460,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"3f9ff18a-6ab9-468b-93c4-5018a3ae5640"},{"version":"CommandV1","origId":2580593937400029,"guid":"a6824700-ef94-4bba-9e55-1954fe445e52","subtype":"command","commandType":"auto","position":6.443359375,"command":"%md\n\n## Debugging\n\nBecause debugging in Spark can be difficult we will want to test these functions outside of Spark first:","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1492492953107,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"42e51a69-762b-4501-a520-251d3c760de4"},{"version":"CommandV1","origId":2580593937400030,"guid":"20c3d3c5-2de4-4b2a-9187-44fbe947a3f5","subtype":"command","commandType":"auto","position":6.4443359375,"command":"row = data.take(1)[0]\nrow","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">74</span><span class=\"ansired\">]: </span>Row(cut=u&apos;Ideal&apos;, color=u&apos;E&apos;, carat=0.7, clarity=u&apos;SI1&apos;, price=2757)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;data&apos; is not defined","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-1-6f332aa8bf64&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>row <span class=\"ansiyellow\">=</span> data<span class=\"ansiyellow\">.</span>take<span class=\"ansiyellow\">(</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">0</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      2</span> row<span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">NameError</span>: name &apos;data&apos; is not defined</div>","workflows":[],"startTime":1492492956463,"submitTime":1492492953123,"finishTime":1492492956534,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8dadf0e3-f016-455f-8999-5fa141c1009c"},{"version":"CommandV1","origId":2580593937400031,"guid":"bc7982c7-20e0-4227-8268-6358bb2badf8","subtype":"command","commandType":"auto","position":6.44482421875,"command":"[a for a in xtx_map(row)]","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">75</span><span class=\"ansired\">]: </span>\n[((u&apos;cut_Ideal&apos;, u&apos;cut_Ideal&apos;), 1.0),\n ((u&apos;cut_Ideal&apos;, u&apos;color_E&apos;), 1.0),\n ((u&apos;cut_Ideal&apos;, &apos;carat&apos;), 0.7),\n ((u&apos;cut_Ideal&apos;, u&apos;clarity_SI1&apos;), 1.0),\n ((u&apos;color_E&apos;, u&apos;cut_Ideal&apos;), 1.0),\n ((u&apos;color_E&apos;, u&apos;color_E&apos;), 1.0),\n ((u&apos;color_E&apos;, &apos;carat&apos;), 0.7),\n ((u&apos;color_E&apos;, u&apos;clarity_SI1&apos;), 1.0),\n ((&apos;carat&apos;, u&apos;cut_Ideal&apos;), 0.7),\n ((&apos;carat&apos;, u&apos;color_E&apos;), 0.7),\n ((&apos;carat&apos;, &apos;carat&apos;), 0.48999999999999994),\n ((&apos;carat&apos;, u&apos;clarity_SI1&apos;), 0.7),\n ((u&apos;clarity_SI1&apos;, u&apos;cut_Ideal&apos;), 1.0),\n ((u&apos;clarity_SI1&apos;, u&apos;color_E&apos;), 1.0),\n ((u&apos;clarity_SI1&apos;, &apos;carat&apos;), 0.7),\n ((u&apos;clarity_SI1&apos;, u&apos;clarity_SI1&apos;), 1.0)]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1492492956537,"submitTime":1492492953139,"finishTime":1492492956574,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"40e1ca36-b1ca-4375-adbb-fc322dce07e5"},{"version":"CommandV1","origId":2580593937400032,"guid":"bb5739d7-7137-4ec0-a7e7-4a0ebb90b799","subtype":"command","commandType":"auto","position":6.445068359375,"command":"[a for a in xty_map(row)]","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">76</span><span class=\"ansired\">]: </span>\n[(u&apos;cut_Ideal&apos;, 2757.0),\n (u&apos;color_E&apos;, 2757.0),\n (&apos;carat&apos;, 1929.8999999999999),\n (u&apos;clarity_SI1&apos;, 2757.0)]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1492492956577,"submitTime":1492492953149,"finishTime":1492492956589,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"696c001f-c884-49b5-adb8-75c7c961ddc8"},{"version":"CommandV1","origId":2580593937400033,"guid":"98133681-c2fe-4854-bda4-ea4994bbcbdb","subtype":"command","commandType":"auto","position":6.4451904296875,"command":"%md \n## FlatMap and Reduce\n\nHere we use the [`flatMap`](http://spark.apache.org/docs/2.1.0/api/python/pyspark.html#pyspark.RDD.flatMap) function which is nearly identical to the [`map`](http://spark.apache.org/docs/2.1.0/api/python/pyspark.html#pyspark.RDD.map) function except that it may output multiple values which are all concatenated to the output.\n\nThe following lines will trigger computation across the data center by shipping our `xtx_map` and `xty_map` functions to remote workers wher ethe data is stored. ","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1492492953159,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"06ca5a05-7f3b-4543-ab51-1309902ffb9b"},{"version":"CommandV1","origId":2580593937400034,"guid":"b4a59bc1-bda8-4e72-9fc9-9fada8a2222c","subtype":"command","commandType":"auto","position":6.4453125,"command":"xtx_data = ( data.rdd\n  .flatMap(xtx_map)\n  .reduceByKey(lambda a, b: a + b)\n  .collect()\n)\n\nxty_data = ( data.rdd\n  .flatMap(xty_map)\n  .reduceByKey(lambda a, b: a + b)\n  .collect()\n)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 132.0 failed 1 times, most recent failure: Lost task 0.0 in stage 132.0 (TID 660, localhost, executor driver): org.apache.spark.api.python.PythonException: Traceback (most recent call last):","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">Py4JJavaError</span>                             Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-221-b655e687ccb4&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      1</span> <span class=\"ansigreen\">from</span> operator <span class=\"ansigreen\">import</span> add<span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      2</span> xtx_data <span class=\"ansiyellow\">=</span> diamonds<span class=\"ansiyellow\">.</span>rdd<span class=\"ansiyellow\">.</span>flatMap<span class=\"ansiyellow\">(</span>xtx_map<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>reduceByKey<span class=\"ansiyellow\">(</span>add<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>collect<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 3</span><span class=\"ansiyellow\"> </span>xty_data <span class=\"ansiyellow\">=</span> diamonds<span class=\"ansiyellow\">.</span>rdd<span class=\"ansiyellow\">.</span>flatMap<span class=\"ansiyellow\">(</span>xty_map<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>reduceByKey<span class=\"ansiyellow\">(</span>add<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>collect<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/rdd.pyc</span> in <span class=\"ansicyan\">collect</span><span class=\"ansiblue\">(self)</span>\n<span class=\"ansigreen\">    806</span>         &quot;&quot;&quot;\n<span class=\"ansigreen\">    807</span>         <span class=\"ansigreen\">with</span> SCCallSiteSync<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>context<span class=\"ansiyellow\">)</span> <span class=\"ansigreen\">as</span> css<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 808</span><span class=\"ansiyellow\">             </span>port <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>ctx<span class=\"ansiyellow\">.</span>_jvm<span class=\"ansiyellow\">.</span>PythonRDD<span class=\"ansiyellow\">.</span>collectAndServe<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>_jrdd<span class=\"ansiyellow\">.</span>rdd<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    809</span>         <span class=\"ansigreen\">return</span> list<span class=\"ansiyellow\">(</span>_load_from_socket<span class=\"ansiyellow\">(</span>port<span class=\"ansiyellow\">,</span> self<span class=\"ansiyellow\">.</span>_jrdd_deserializer<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    810</span> <span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.10.4-src.zip/py4j/java_gateway.py</span> in <span class=\"ansicyan\">__call__</span><span class=\"ansiblue\">(self, *args)</span>\n<span class=\"ansigreen\">   1131</span>         answer <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>gateway_client<span class=\"ansiyellow\">.</span>send_command<span class=\"ansiyellow\">(</span>command<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1132</span>         return_value = get_return_value(\n<span class=\"ansigreen\">-&gt; 1133</span><span class=\"ansiyellow\">             answer, self.gateway_client, self.target_id, self.name)\n</span><span class=\"ansigreen\">   1134</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1135</span>         <span class=\"ansigreen\">for</span> temp_arg <span class=\"ansigreen\">in</span> temp_args<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/utils.pyc</span> in <span class=\"ansicyan\">deco</span><span class=\"ansiblue\">(*a, **kw)</span>\n<span class=\"ansigreen\">     61</span>     <span class=\"ansigreen\">def</span> deco<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">*</span>a<span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">**</span>kw<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     62</span>         <span class=\"ansigreen\">try</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 63</span><span class=\"ansiyellow\">             </span><span class=\"ansigreen\">return</span> f<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">*</span>a<span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">**</span>kw<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     64</span>         <span class=\"ansigreen\">except</span> py4j<span class=\"ansiyellow\">.</span>protocol<span class=\"ansiyellow\">.</span>Py4JJavaError <span class=\"ansigreen\">as</span> e<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     65</span>             s <span class=\"ansiyellow\">=</span> e<span class=\"ansiyellow\">.</span>java_exception<span class=\"ansiyellow\">.</span>toString<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.10.4-src.zip/py4j/protocol.py</span> in <span class=\"ansicyan\">get_return_value</span><span class=\"ansiblue\">(answer, gateway_client, target_id, name)</span>\n<span class=\"ansigreen\">    317</span>                 raise Py4JJavaError(\n<span class=\"ansigreen\">    318</span>                     <span class=\"ansiblue\">&quot;An error occurred while calling {0}{1}{2}.\\n&quot;</span><span class=\"ansiyellow\">.</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 319</span><span class=\"ansiyellow\">                     format(target_id, &quot;.&quot;, name), value)\n</span><span class=\"ansigreen\">    320</span>             <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    321</span>                 raise Py4JError(\n\n<span class=\"ansired\">Py4JJavaError</span>: An error occurred while calling z:org.apache.spark.api.python.PythonRDD.collectAndServe.\n: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 132.0 failed 1 times, most recent failure: Lost task 0.0 in stage 132.0 (TID 660, localhost, executor driver): org.apache.spark.api.python.PythonException: Traceback (most recent call last):\n  File &quot;/databricks/spark/python/pyspark/worker.py&quot;, line 174, in main\n    process()\n  File &quot;/databricks/spark/python/pyspark/worker.py&quot;, line 169, in process\n    serializer.dump_stream(func(split_index, iterator), outfile)\n  File &quot;/databricks/spark/python/pyspark/rdd.py&quot;, line 2406, in pipeline_func\n    return func(split, prev_func(split, iterator))\n  File &quot;/databricks/spark/python/pyspark/rdd.py&quot;, line 2406, in pipeline_func\n    return func(split, prev_func(split, iterator))\n  File &quot;/databricks/spark/python/pyspark/rdd.py&quot;, line 345, in func\n    return f(iterator)\n  File &quot;/databricks/spark/python/pyspark/rdd.py&quot;, line 1827, in combineLocally\n    merger.mergeValues(iterator)\n  File &quot;/databricks/spark/python/pyspark/shuffle.py&quot;, line 236, in mergeValues\n    for k, v in iterator:\n  File &quot;&lt;ipython-input-220-9ff3b27d1927&gt;&quot;, line 6, in xty_map\nKeyError: &apos;zprice&apos;\n\n\tat org.apache.spark.api.python.PythonRunner$$anon$1.read(PythonRDD.scala:193)\n\tat org.apache.spark.api.python.PythonRunner$$anon$1.&lt;init&gt;(PythonRDD.scala:234)\n\tat org.apache.spark.api.python.PythonRunner.compute(PythonRDD.scala:152)\n\tat org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:63)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:323)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:287)\n\tat org.apache.spark.api.python.PairwiseRDD.compute(PythonRDD.scala:390)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:323)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:287)\n\tat org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:96)\n\tat org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:53)\n\tat org.apache.spark.scheduler.Task.run(Task.scala:99)\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:322)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n\tat java.lang.Thread.run(Thread.java:745)\n\nDriver stacktrace:\n\tat org.apache.spark.scheduler.DAGScheduler.org$apache$spark$scheduler$DAGScheduler$$failJobAndIndependentStages(DAGScheduler.scala:1442)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1430)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1429)\n\tat scala.collection.mutable.ResizableArray$class.foreach(ResizableArray.scala:59)\n\tat scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:47)\n\tat org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:1429)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:803)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:803)\n\tat scala.Option.foreach(Option.scala:236)\n\tat org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:803)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:1657)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1612)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1601)\n\tat org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:48)\n\tat org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:628)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:1926)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:1939)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:1952)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:1966)\n\tat org.apache.spark.rdd.RDD$$anonfun$collect$1.apply(RDD.scala:936)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:112)\n\tat org.apache.spark.rdd.RDD.withScope(RDD.scala:362)\n\tat org.apache.spark.rdd.RDD.collect(RDD.scala:935)\n\tat org.apache.spark.api.python.PythonRDD$.collectAndServe(PythonRDD.scala:453)\n\tat org.apache.spark.api.python.PythonRDD.collectAndServe(PythonRDD.scala)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\n\tat py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\n\tat py4j.Gateway.invoke(Gateway.java:280)\n\tat py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\n\tat py4j.commands.CallCommand.execute(CallCommand.java:79)\n\tat py4j.GatewayConnection.run(GatewayConnection.java:214)\n\tat java.lang.Thread.run(Thread.java:745)\nCaused by: org.apache.spark.api.python.PythonException: Traceback (most recent call last):\n  File &quot;/databricks/spark/python/pyspark/worker.py&quot;, line 174, in main\n    process()\n  File &quot;/databricks/spark/python/pyspark/worker.py&quot;, line 169, in process\n    serializer.dump_stream(func(split_index, iterator), outfile)\n  File &quot;/databricks/spark/python/pyspark/rdd.py&quot;, line 2406, in pipeline_func\n    return func(split, prev_func(split, iterator))\n  File &quot;/databricks/spark/python/pyspark/rdd.py&quot;, line 2406, in pipeline_func\n    return func(split, prev_func(split, iterator))\n  File &quot;/databricks/spark/python/pyspark/rdd.py&quot;, line 345, in func\n    return f(iterator)\n  File &quot;/databricks/spark/python/pyspark/rdd.py&quot;, line 1827, in combineLocally\n    merger.mergeValues(iterator)\n  File &quot;/databricks/spark/python/pyspark/shuffle.py&quot;, line 236, in mergeValues\n    for k, v in iterator:\n  File &quot;&lt;ipython-input-220-9ff3b27d1927&gt;&quot;, line 6, in xty_map\nKeyError: &apos;zprice&apos;\n\n\tat org.apache.spark.api.python.PythonRunner$$anon$1.read(PythonRDD.scala:193)\n\tat org.apache.spark.api.python.PythonRunner$$anon$1.&lt;init&gt;(PythonRDD.scala:234)\n\tat org.apache.spark.api.python.PythonRunner.compute(PythonRDD.scala:152)\n\tat org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:63)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:323)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:287)\n\tat org.apache.spark.api.python.PairwiseRDD.compute(PythonRDD.scala:390)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:323)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:287)\n\tat org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:96)\n\tat org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:53)\n\tat org.apache.spark.scheduler.Task.run(Task.scala:99)\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:322)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n\t... 1 more\n</div>","workflows":[],"startTime":1492492956592,"submitTime":1492492953193,"finishTime":1492492958602,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"198bd5e5-ae67-4f8d-8496-e9af53785f16"},{"version":"CommandV1","origId":2580593937400035,"guid":"39a4f58f-3582-421e-a051-082eeb20df7c","subtype":"command","commandType":"auto","position":6.447265625,"command":"%md\nIn the following block of code we compute the index in the feature vector for each of the string features.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1492492953204,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9ffccf86-3045-4192-8d4f-2036baff9150"},{"version":"CommandV1","origId":2580593937400036,"guid":"b6650278-17da-4ed4-b8eb-e645519632e8","subtype":"command","commandType":"auto","position":6.44921875,"command":"index = dict(zip([r[0] for r in xty_data], range(len(xty_data))))\np = len(index)\nprint(\"Dimensions\", p)\nindex","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">(&apos;Dimensions&apos;, 21)\n<span class=\"ansired\">Out[</span><span class=\"ansired\">78</span><span class=\"ansired\">]: </span>\n{&apos;carat&apos;: 10,\n u&apos;clarity_I1&apos;: 20,\n u&apos;clarity_IF&apos;: 14,\n u&apos;clarity_SI1&apos;: 5,\n u&apos;clarity_SI2&apos;: 2,\n u&apos;clarity_VS1&apos;: 17,\n u&apos;clarity_VS2&apos;: 19,\n u&apos;clarity_VVS1&apos;: 1,\n u&apos;clarity_VVS2&apos;: 0,\n u&apos;color_D&apos;: 9,\n u&apos;color_E&apos;: 8,\n u&apos;color_F&apos;: 7,\n u&apos;color_G&apos;: 6,\n u&apos;color_H&apos;: 11,\n u&apos;color_I&apos;: 4,\n u&apos;color_J&apos;: 3,\n u&apos;cut_Fair&apos;: 15,\n u&apos;cut_Good&apos;: 12,\n u&apos;cut_Ideal&apos;: 16,\n u&apos;cut_Premium&apos;: 18,\n u&apos;cut_Very Good&apos;: 13}\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">ValueError</span>: too many values to unpack","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">ValueError</span>                                Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-93-2f77cb9599a8&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      6</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      7</span> xtx <span class=\"ansiyellow\">=</span> np<span class=\"ansiyellow\">.</span>zeros<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">(</span>p<span class=\"ansiyellow\">,</span>p<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 8</span><span class=\"ansiyellow\"> </span><span class=\"ansigreen\">for</span> <span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">(</span>k1<span class=\"ansiyellow\">,</span>k2<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span>v<span class=\"ansiyellow\">)</span> <span class=\"ansigreen\">in</span> xty_data<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      9</span>   xtx<span class=\"ansiyellow\">[</span>index<span class=\"ansiyellow\">[</span>k1<span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> index<span class=\"ansiyellow\">[</span>k2<span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">]</span> <span class=\"ansiyellow\">=</span> v<span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">ValueError</span>: too many values to unpack</div>","workflows":[],"startTime":1492492958606,"submitTime":1492492953222,"finishTime":1492492958644,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"4f0da98b-d37e-4884-ae23-f77b197064aa"},{"version":"CommandV1","origId":2580593937400037,"guid":"2368549a-600a-4540-bc76-e94f549e519b","subtype":"command","commandType":"auto","position":6.44970703125,"command":"%md\nUsing the index which translates each feature name to a particular location in an `x` vector we then fill out the entries of the local `XTY` and `XTX` matrices.  Notice that this is done entirely in this python notebook and not by calling Spark.  For very high dimensional problems this could be an issue.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1492492953232,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"77743452-2dbf-44ac-8623-2d712c4922be"},{"version":"CommandV1","origId":2580593937400038,"guid":"f427ec7b-70e5-4c21-88eb-6f3d25247893","subtype":"command","commandType":"auto","position":6.4501953125,"command":"import numpy as np\nXTY = np.zeros((p,1))\nfor (k,v) in xty_data:\n  XTY[index[k]] = v\n\nXTX = np.zeros((p,p))\nfor ((k1,k2),v) in xtx_data:\n  XTX[index[k1], index[k2]] = v","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;np&apos; is not defined","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-11-7bb5078331ef&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>xty <span class=\"ansiyellow\">=</span> np<span class=\"ansiyellow\">.</span>zeros<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">(</span>p<span class=\"ansiyellow\">,</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      2</span> <span class=\"ansigreen\">for</span> <span class=\"ansiyellow\">(</span>k<span class=\"ansiyellow\">,</span>v<span class=\"ansiyellow\">)</span> <span class=\"ansigreen\">in</span> xty_data<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      3</span>   xty<span class=\"ansiyellow\">[</span>index<span class=\"ansiyellow\">[</span>k<span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">]</span> <span class=\"ansiyellow\">=</span> v<span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      4</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      5</span> xtx <span class=\"ansiyellow\">=</span> np<span class=\"ansiyellow\">.</span>zeros<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">(</span>p<span class=\"ansiyellow\">,</span>p<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">NameError</span>: name &apos;np&apos; is not defined</div>","workflows":[],"startTime":1492492958647,"submitTime":1492492953254,"finishTime":1492492958684,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"72653ae2-191a-4469-b7d6-59bd46d5c779"},{"version":"CommandV1","origId":2656932873031533,"guid":"f318843d-d87f-418b-9d97-c78e72f44cb2","subtype":"command","commandType":"auto","position":6.45068359375,"command":"%md\nTo compute the optimal \\\\(\\hat{\\theta}\\\\) value we need to solve the \\\\(p \\times p\\\\) system of linear equations.  This is done by calling the linear algebra library in numpy.  This computation is running locally inside of this notebook.  ","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1492492953264,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"45679898-de07-4ba2-a81e-31cbcbb15d27"},{"version":"CommandV1","origId":2580593937400039,"guid":"5c855e68-af2f-4244-8185-ec7311956bf6","subtype":"command","commandType":"auto","position":6.451171875,"command":"theta = np.linalg.solve(XTX, XTY)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1492492958687,"submitTime":1492492953280,"finishTime":1492492958725,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2efa7529-c04f-4c6b-b752-ebd21fe146cf"},{"version":"CommandV1","origId":2656932873031534,"guid":"d38c4349-eaf6-4924-ae09-f5bf42cc1b0b","subtype":"command","commandType":"auto","position":6.4521484375,"command":"%md\n# Rendering Predictions\n\nIn the following block of code we define a new **user defined function** to run on the PySpark dataframe and render predictions.  We first demonstrate how this function can be applied to the raw:","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1492492953289,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0dba5ef0-d049-4282-b8a4-9da7023b2534"},{"version":"CommandV1","origId":2656932873031535,"guid":"0837b9c8-c6f1-4c52-b6a4-20318c0593da","subtype":"command","commandType":"auto","position":6.45263671875,"command":"def predict(row):\n  row = row.asDict()\n  pred = 0.0\n  for i in features:\n    (ki, vi) = (i, row[i]) if i not in categorical else (i+\"_\"+row[i], 1.0)\n    pred += vi * theta[index[ki],0]\n  return float(pred)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1492492958731,"submitTime":1492492953320,"finishTime":1492492958756,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d1f4d2ed-7fb9-4997-bf0b-92399a26fedf"},{"version":"CommandV1","origId":2656932873031537,"guid":"4c0ce6a8-5f06-46eb-b5bb-84e0d0584c84","subtype":"command","commandType":"auto","position":6.4527587890625,"command":"%md\nThe following function computes the root mean squared error in the predicted price by running a sequence of map functions which run across the datacenter.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1492492953329,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"fbb5aeb1-7ae6-4800-a6b5-3f8d0a0e0815"},{"version":"CommandV1","origId":2656932873031536,"guid":"aee21e20-2b0a-43c6-9e64-9140d5a6095b","subtype":"command","commandType":"auto","position":6.452880859375,"command":"rmse = np.sqrt(data.rdd\n   .map(lambda row: (row[label], predict(row)))\n   .map(lambda (y,yhat): (yhat - y) * (yhat - y) )\n   .mean()\n )\nprint(\"RMSE:\", rmse)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">(&apos;RMSE:&apos;, 1177.1119669613029)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1492492958760,"submitTime":1492492953344,"finishTime":1492492959869,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"479e3930-c663-4a12-b053-892ba8fda6bf"},{"version":"CommandV1","origId":2656932873031538,"guid":"0f995086-ca0c-493f-a4ca-e0daf0974b4e","subtype":"command","commandType":"auto","position":6.4530029296875,"command":"%md\nIdeally we would like to add the predictions directly into our dataframe.  The following block of code creates a **user defined function** (UDF) and then uses the UDF to add an additional column to the Dataframe.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1492492953353,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"977cd237-30a7-41bb-b903-a4249e2eb906"},{"version":"CommandV1","origId":2580593937400040,"guid":"864a7923-1a78-4811-95a1-457c86f42b2e","subtype":"command","commandType":"auto","position":6.453125,"command":"from pyspark.sql.functions import udf, struct\nfrom pyspark.sql.types import FloatType\n\n# A UDF must have a defined return type\npredict_udf = udf(predict, FloatType())\n\n# the Struct of features states which columns in the dataframe are given to the UDF\ndata = data.withColumn(\"pred\", predict_udf(struct(features)))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">AnalysisException</span>: u&quot;cannot resolve &apos;&#96;bias&#96;&apos; given input columns: [price, mean_resid, pred, carat, resid, cut, clarity, color];;\\n&apos;Project [cut#42, color#43, carat#41, clarity#44, price#47, predict(named_struct(cut, cut#42, color, color#43, carat, carat#41, clarity, clarity#44, NamePlaceholder, &apos;bias)) AS pred#4795, resid#3369, mean_resid#4437]\\n+- Project [cut#42, color#43, carat#41, clarity#44, price#47, pred#2224, resid#3369, (cast(pred#2224 as double) - 5120.93147453) AS mean_resid#4437]\\n   +- Project [cut#42, color#43, carat#41, clarity#44, price#47, pred#2224, resid#3369, (cast(pred#2224 as double) - 5120.93147453) AS mean_resid#3786]\\n      +- Project [cut#42, color#43, carat#41, clarity#44, price#47, pred#2224, (pred#2224 - cast(price#47 as float)) AS resid#3369, mean_resid#3138]\\n         +- Project [cut#42, color#43, carat#41, clarity#44, price#47, pred#2224, resid#2239, (cast(pred#2224 as double) - 5120.93147453) AS mean_resid#3138]\\n            +- Project [cut#42, color#43, carat#41, clarity#44, price#47, pred#2224, resid#2239, (pred#2224 - cast(price#47 as float)) AS mean_resid#2973]\\n               +- Project [cut#42, color#43, carat#41, clarity#44, price#47, pred#2224, resid#2239, (pred#2224 - cast(price#47 as float)) AS mean_resid#2822]\\n                  +- Project [cut#42, color#43, carat#41, clarity#44, price#47, pred#2224, resid#2239, (pred#2224 - cast(price#47 as float)) AS mean_resid#2678]\\n                     +- Project [cut#42, color#43, carat#41, clarity#44, price#47, pred#2224, (pred#2224 - cast(price#47 as float)) AS resid#2239]\\n                        +- Project [cut#42, color#43, carat#41, clarity#44, price#47, predict(named_struct(cut, cut#42, color, color#43, carat, carat#41, clarity, clarity#44)) AS pred#2224]\\n                           +- Project [cut#42, color#43, carat#41, clarity#44, price#47]\\n                              +- Filter (price#47 &gt; 1000)\\n                                 +- Relation[_c0#40,carat#41,cut#42,color#43,clarity#44,depth#45,table#46,price#47,x#48,y#49,z#50] csv\\n&quot;","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">AnalysisException</span>                         Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-79-04f205314f3e&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">     13</span> predict_udf <span class=\"ansiyellow\">=</span> udf<span class=\"ansiyellow\">(</span>predict<span class=\"ansiyellow\">,</span> FloatType<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     14</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 15</span><span class=\"ansiyellow\"> </span>data <span class=\"ansiyellow\">=</span> data<span class=\"ansiyellow\">.</span>withColumn<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;pred&quot;</span><span class=\"ansiyellow\">,</span> predict_udf<span class=\"ansiyellow\">(</span>struct<span class=\"ansiyellow\">(</span>features<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/dataframe.py</span> in <span class=\"ansicyan\">withColumn</span><span class=\"ansiblue\">(self, colName, col)</span>\n<span class=\"ansigreen\">   1500</span>         &quot;&quot;&quot;\n<span class=\"ansigreen\">   1501</span>         <span class=\"ansigreen\">assert</span> isinstance<span class=\"ansiyellow\">(</span>col<span class=\"ansiyellow\">,</span> Column<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> <span class=\"ansiblue\">&quot;col should be Column&quot;</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">-&gt; 1502</span><span class=\"ansiyellow\">         </span><span class=\"ansigreen\">return</span> DataFrame<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>_jdf<span class=\"ansiyellow\">.</span>withColumn<span class=\"ansiyellow\">(</span>colName<span class=\"ansiyellow\">,</span> col<span class=\"ansiyellow\">.</span>_jc<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> self<span class=\"ansiyellow\">.</span>sql_ctx<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1503</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1504</span>     <span class=\"ansiyellow\">@</span>ignore_unicode_prefix<span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.10.4-src.zip/py4j/java_gateway.py</span> in <span class=\"ansicyan\">__call__</span><span class=\"ansiblue\">(self, *args)</span>\n<span class=\"ansigreen\">   1131</span>         answer <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>gateway_client<span class=\"ansiyellow\">.</span>send_command<span class=\"ansiyellow\">(</span>command<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1132</span>         return_value = get_return_value(\n<span class=\"ansigreen\">-&gt; 1133</span><span class=\"ansiyellow\">             answer, self.gateway_client, self.target_id, self.name)\n</span><span class=\"ansigreen\">   1134</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1135</span>         <span class=\"ansigreen\">for</span> temp_arg <span class=\"ansigreen\">in</span> temp_args<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/utils.py</span> in <span class=\"ansicyan\">deco</span><span class=\"ansiblue\">(*a, **kw)</span>\n<span class=\"ansigreen\">     67</span>                                              e.java_exception.getStackTrace()))\n<span class=\"ansigreen\">     68</span>             <span class=\"ansigreen\">if</span> s<span class=\"ansiyellow\">.</span>startswith<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;org.apache.spark.sql.AnalysisException: &apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 69</span><span class=\"ansiyellow\">                 </span><span class=\"ansigreen\">raise</span> AnalysisException<span class=\"ansiyellow\">(</span>s<span class=\"ansiyellow\">.</span>split<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;: &apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> stackTrace<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     70</span>             <span class=\"ansigreen\">if</span> s<span class=\"ansiyellow\">.</span>startswith<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;org.apache.spark.sql.catalyst.analysis&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     71</span>                 <span class=\"ansigreen\">raise</span> AnalysisException<span class=\"ansiyellow\">(</span>s<span class=\"ansiyellow\">.</span>split<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;: &apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> stackTrace<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">AnalysisException</span>: u&quot;cannot resolve &apos;&#96;bias&#96;&apos; given input columns: [price, mean_resid, pred, carat, resid, cut, clarity, color];;\\n&apos;Project [cut#42, color#43, carat#41, clarity#44, price#47, predict(named_struct(cut, cut#42, color, color#43, carat, carat#41, clarity, clarity#44, NamePlaceholder, &apos;bias)) AS pred#4795, resid#3369, mean_resid#4437]\\n+- Project [cut#42, color#43, carat#41, clarity#44, price#47, pred#2224, resid#3369, (cast(pred#2224 as double) - 5120.93147453) AS mean_resid#4437]\\n   +- Project [cut#42, color#43, carat#41, clarity#44, price#47, pred#2224, resid#3369, (cast(pred#2224 as double) - 5120.93147453) AS mean_resid#3786]\\n      +- Project [cut#42, color#43, carat#41, clarity#44, price#47, pred#2224, (pred#2224 - cast(price#47 as float)) AS resid#3369, mean_resid#3138]\\n         +- Project [cut#42, color#43, carat#41, clarity#44, price#47, pred#2224, resid#2239, (cast(pred#2224 as double) - 5120.93147453) AS mean_resid#3138]\\n            +- Project [cut#42, color#43, carat#41, clarity#44, price#47, pred#2224, resid#2239, (pred#2224 - cast(price#47 as float)) AS mean_resid#2973]\\n               +- Project [cut#42, color#43, carat#41, clarity#44, price#47, pred#2224, resid#2239, (pred#2224 - cast(price#47 as float)) AS mean_resid#2822]\\n                  +- Project [cut#42, color#43, carat#41, clarity#44, price#47, pred#2224, resid#2239, (pred#2224 - cast(price#47 as float)) AS mean_resid#2678]\\n                     +- Project [cut#42, color#43, carat#41, clarity#44, price#47, pred#2224, (pred#2224 - cast(price#47 as float)) AS resid#2239]\\n                        +- Project [cut#42, color#43, carat#41, clarity#44, price#47, predict(named_struct(cut, cut#42, color, color#43, carat, carat#41, clarity, clarity#44)) AS pred#2224]\\n                           +- Project [cut#42, color#43, carat#41, clarity#44, price#47]\\n                              +- Filter (price#47 &gt; 1000)\\n                                 +- Relation[_c0#40,carat#41,cut#42,color#43,clarity#44,depth#45,table#46,price#47,x#48,y#49,z#50] csv\\n&quot;</div>","workflows":[],"startTime":1492492959874,"submitTime":1492492953381,"finishTime":1492492959944,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a95ec7b2-8134-4720-b3e4-64f940f60372"},{"version":"CommandV1","origId":2580593937400041,"guid":"c37e27d9-ad8a-4add-b048-8789172e5c7e","subtype":"command","commandType":"auto","position":6.45703125,"command":"from pyspark.sql.functions import mean\ndata = data.withColumn(\"resid\", data['pred'] - data['price'])\nnp.sqrt(data.select(mean(data['resid'] * data['resid'])).collect()[0][0])","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">84</span><span class=\"ansired\">]: </span>1177.1119664574273\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1492492959947,"submitTime":1492492953391,"finishTime":1492492960955,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f1d4a007-0d5f-4963-ab2c-24ed64b0d47d"},{"version":"CommandV1","origId":2656932873031539,"guid":"c2e21c34-d31e-4cc7-8f64-30afed281207","subtype":"command","commandType":"auto","position":6.458984375,"command":"display(data.sample(False, 0.1).select('resid'))","commandVersion":0,"state":"finished","results":{"type":"table","data":[[76.85034],[-484.5432],[938.9199],[553.41064],[995.44824],[-82.81445],[-111.70825],[-235.8667],[182.45679],[108.236084],[-736.9021],[732.7344],[814.0674],[-985.21643],[1096.2976],[613.0808],[1352.189],[-79.72925],[637.0325],[736.5137],[697.5244],[-1022.97253],[252.24268],[1267.0798],[809.56494],[138.46216],[353.0774],[198.72656],[621.0283],[315.79858],[-943.51685],[828.8933],[-556.0569],[30.405273],[968.2407],[880.67993],[277.44897],[990.188],[961.2407],[861.9199],[-788.1179],[1416.0947],[-63.927734],[94.90723],[590.969],[1717.3647],[658.2927],[1038.21],[77.18335],[505.68945],[-89.65137],[973.188],[759.62305],[262.29712],[585.0283],[798.64355],[1529.5815],[964.3308],[114.96362],[909.02954],[735.7329],[859.81396],[1404.1719],[1004.9629],[578.7505],[-2514.1692],[827.40625],[903.2009],[881.7002],[1086.0754],[1277.189],[945.3845],[720.34937],[1054.7976],[314.3357],[-128.94092],[1115.4219],[-483.20337],[928.67847],[-2636.226],[803.43384],[-46.344727],[1151.1323],[142.98047],[-174.75293],[1006.4414],[709.56494],[1138.1323],[243.57056],[-788.50366],[549.5542],[293.6731],[760.9199],[765.57227],[633.9158],[805.7002],[1347.1812],[168.29712],[551.2927],[1186.5996],[685.14185],[911.5386],[-804.63525],[-547.1189],[1246.4194],[658.0786],[1137.8848],[-505.4297],[1043.4983],[1362.5269],[719.9199],[-94.16528],[-271.82983],[1132.8491],[709.40625],[511.29272],[-1287.5149],[962.07544],[520.9712],[-629.0],[46.996826],[-440.761],[976.5093],[976.5093],[-498.08105],[604.56494],[520.3323],[536.30054],[887.2532],[200.85547],[1035.5662],[1494.5835],[-444.844],[1016.56714],[455.01074],[479.0852],[-132.39062],[181.12329],[425.5061],[1231.9121],[356.88647],[499.12012],[112.38672],[-260.47876],[451.9431],[503.47412],[345.45532],[566.59326],[-1372.0233],[-326.64722],[625.9077],[719.9646],[521.9126],[-548.3906],[1440.5835],[695.9768],[-588.4175],[557.97266],[1188.1562],[383.57373],[172.40845],[67.51782],[1336.3081],[610.1987],[823.532],[732.4031],[732.4031],[748.8916],[1519.8853],[752.0337],[1191.5493],[597.3987],[481.32446],[-1236.9097],[764.9617],[301.625],[733.4524],[386.08936],[666.1963],[-141.36523],[-643.4175],[852.59204],[731.2976],[-116.87671],[338.45874],[651.3845],[-1019.90186],[441.75708],[79.87964],[651.25977],[1288.5283],[-159.10864],[1489.4883],[281.31763],[419.62305],[794.09033],[1322.1489],[-102.55005],[597.08936],[648.7571],[630.97363],[801.59204],[-155.4768],[538.7002],[305.73438],[892.6489],[1032.7324],[166.46533],[966.9219],[-924.4971],[728.6294],[604.93945],[551.9768],[1255.876],[-156.65039],[221.7876],[-131.93555],[573.1963],[-98.41992],[1101.3701],[52.896973],[-26.144531],[695.07544],[1245.5942],[748.5322],[-273.53467],[725.09033],[1491.456],[-412.94873],[-421.26245],[-215.32129],[1021.6948],[620.23804],[998.19336],[871.8916],[1013.5923],[7.4084473],[1188.5283],[-737.9011],[640.56226],[413.12427],[672.4597],[755.8706],[705.2947],[1244.0952],[662.41064],[946.2344],[44.975586],[44.975586],[1280.794],[643.81396],[1168.0552],[-269.61694],[490.08936],[778.1472],[1255.8501],[-205.44922],[692.31006],[-267.08862],[868.1245],[594.7888],[365.17358],[-486.4546],[300.90918],[663.80835],[-307.33374],[863.70557],[-61.425293],[601.07544],[283.8772],[481.74097],[1012.99854],[317.0962],[864.73],[33.72119],[719.86523],[246.07861],[-97.20581],[167.53662],[1037.5645],[1164.3647],[-100.59155],[926.54395],[-644.06934],[1353.0498],[-11.389648],[654.1323],[991.75195],[797.70557],[179.32886],[1055.5508],[369.15308],[1251.9067],[456.91553],[-29.534668],[916.041],[207.90918],[858.26074],[390.68262],[950.83154],[535.8611],[419.4751],[728.33984],[590.29785],[1167.6426],[639.07983],[108.53662],[-607.2046],[-1529.5413],[-1443.1028],[1023.1421],[757.4155],[-860.07666],[-1391.3247],[735.1245],[-3.041748],[107.91577],[412.41187],[329.08936],[590.91797],[539.0691],[689.62305],[421.02148],[-1585.1597],[1178.6924],[1365.8657],[575.1472],[180.17358],[842.9331],[328.35376],[-1461.8384],[1480.3657],[764.6948],[-417.93555],[35.369385],[286.19214],[1164.7036],[14.526855],[-701.2046],[862.35693],[1184.0166],[512.91797],[983.90283],[1252.7388],[621.5874],[-39.8396],[-279.59155],[157.96606],[1041.625],[-388.2627],[335.24902],[-167.35645],[521.3667],[-11.525879],[-1600.9181],[-1526.8384],[1070.9067],[-788.1848],[-324.2058],[358.56323],[1299.7954],[681.6948],[101.36157],[501.12598],[1012.9092],[803.56445],[230.35376],[354.9485],[-260.4995],[991.47314],[-14.261475],[-764.15625],[830.3623],[825.59424],[452.4038],[607.56006],[1074.4775],[-241.53003],[989.24805],[156.35376],[348.13232],[348.13232],[348.13232],[348.13232],[-258.39502],[-327.63525],[1023.0166],[-388.08765],[298.3191],[703.8052],[570.56006],[963.98975],[729.98975],[254.47388],[-57.468994],[-1220.3552],[1046.3047],[-17.943115],[461.09814],[-5.20459],[390.4038],[221.56323],[221.70142],[540.99805],[506.4839],[575.23145],[-247.26562],[-307.53003],[-214.46338],[-1055.79],[-117.40674],[-26.20459],[171.4226],[25.976807],[24.026855],[523.56006],[985.7212],[157.7976],[-264.26562],[-128.41626],[-675.37085],[714.30273],[73.35376],[475.3623],[457.2461],[-193.77441],[33.740967],[503.9668],[1302.5908],[-304.54126],[610.8052],[76.801025],[154.70142],[925.96484],[966.70557],[1207.8452],[123.410645],[-649.2627],[161.23438],[-442.76514],[869.3638],[585.0381],[-427.11353],[-1205.104],[2385.0537],[704.897],[-14.302734],[107.70557],[1083.7944],[-964.4595],[829.5254],[455.27295],[-767.8845],[620.4238],[1561.7134],[1996.9253],[668.6885],[-399.63208],[663.6885],[-998.15625],[1949.041],[1130.3789],[-254.26147],[643.4839],[553.1221],[-587.4133],[-515.20044],[-1655.7249],[477.6172],[-36.1084],[1090.815],[750.8506],[479.5371],[656.86523],[-1096.2373],[196.40381],[334.19336],[611.6885],[-169.92163],[349.56006],[726.5381],[353.8042],[-424.0569],[723.8506],[-231.60132],[284.0088],[-24.540283],[-292.82642],[509.42383],[509.42383],[1485.189],[89.4917],[-365.0],[198.68945],[557.6885],[297.56006],[471.52832],[-34.436768],[63.91797],[785.59424],[-227.41211],[30.479492],[332.23145],[-246.18945],[-517.84937],[781.9868],[-36.193848],[716.1831],[-833.4209],[1027.7134],[-15.407959],[-5.772705],[344.5039],[850.3198],[393.31885],[-789.03516],[-438.75342],[1330.5381],[582.1616],[141.01172],[-1686.1543],[1402.4292],[403.59717],[1342.1646],[593.16846],[1285.7466],[91.0376],[-71.93799],[271.23145],[10.005371],[-18.019043],[-285.16504],[-285.16504],[2117.337],[1898.1206],[1205.7231],[979.64795],[594.6924],[916.42773],[187.96094],[124.72998],[-458.8081],[569.9541],[458.68848],[1348.0967],[1272.814],[702.874],[813.0469],[487.3252],[608.3638],[-151.54028],[523.1797],[222.23145],[-885.9773],[-25.367188],[-1293.6963],[356.85986],[581.4326],[-1025.8845],[812.1636],[914.1885],[1976.9204],[31.305664],[319.23535],[288.0381],[848.7954],[-612.03735],[796.26953],[263.56445],[521.6924],[356.38672],[516.98975],[639.5415],[-589.7925],[510.66602],[-188.93799],[382.89697],[185.0332],[640.7886],[382.89697],[-514.88696],[-230.07568],[238.33008],[503.9297],[-616.19385],[146.23145],[77.97656],[-763.1135],[714.06006],[988.47705],[-206.93799],[977.76025],[315.6211],[-57.475586],[736.13135],[-293.21118],[412.15186],[685.5464],[711.1001],[691.59863],[423.16846],[1247.9922],[401.15186],[463.38232],[721.2739],[401.15186],[559.9868],[736.4258],[447.69238],[-707.0569],[645.03564],[1481.4331],[24.25879],[-368.35547],[78.27295],[-381.7422],[284.0952],[822.4336],[112.17871],[1851.0039],[-565.2219],[-666.7925],[220.86084],[139.05469],[313.28955],[1071.4248],[740.42773],[740.42773],[644.93066],[704.6587],[763.15674],[1467.7241],[486.16016],[-387.63428],[-24.757812],[837.5908],[949.5166],[1620.4136],[276.0464],[1355.4346],[1406.0532],[716.65967],[596.145],[348.16846],[898.0552],[-617.2219],[371.69238],[791.48486],[-118.31055],[224.09521],[-269.66577],[579.4956],[462.90723],[345.58984],[881.9834],[578.04346],[-205.95898],[538.7031],[-23.305176],[651.042],[-115.901855],[454.35254],[2176.5527],[1257.4072],[1070.1646],[1086.916],[292.42822],[912.05176],[519.7031],[-48.626465],[-73.36084],[579.32227],[371.36377],[271.1953],[-871.57837],[1692.769],[-134.03174],[265.16162],[-60.845215],[422.59424],[235.65088],[1565.9746],[443.5415],[520.3076],[950.7656],[-140.82568],[222.64697],[-201.25977],[274.10352],[855.05176],[720.5908],[922.30664],[398.43896],[1496.9341],[-802.0867],[998.16895],[1960.3481],[939.6338],[-229.45166],[410.4204],[997.7612],[125.095215],[277.5376],[-131.76758],[724.9951],[157.79395],[-210.43799],[-288.6963],[-99.25195],[232.09912],[913.1089],[974.1323],[1279.0269],[134.89697],[722.2378],[183.42822],[1527.2764],[-366.03442],[-21.917969],[603.5762],[-822.0],[262.43262],[611.06006],[374.53613],[1739.8662],[321.90723],[107.80957],[223.69238],[-379.5083],[251.43262],[533.36426],[533.36426],[435.30762],[2033.541],[1352.6113],[458.32227],[256.21826],[934.89795],[1168.8042],[286.15576],[811.72314],[444.99072],[525.4136],[-145.58252],[117.359375],[814.875],[-738.8362],[658.9951],[-112.82422],[-176.60205],[44.095215],[-226.6377],[167.8667],[719.25],[-571.24536],[-264.55225],[-291.438],[-535.96655],[1213.9468],[1642.4531],[121.16162],[301.48975],[739.57666],[739.57666],[214.21826],[1635.4531],[64.793945],[1339.3745],[-626.91626],[-585.2024],[332.3496],[1006.05225],[449.8628],[434.5166],[333.93408],[-635.9946],[2691.0781],[-455.99463],[546.1572],[361.89795],[1334.5566],[8.374512],[1131.8608],[1185.7285],[319.40967],[944.18945],[364.33203],[1221.6919],[754.32324],[438.65527],[83.103516],[151.2085],[352.97852],[901.64453],[-1352.9773],[-750.25903],[-872.6384],[1378.9644],[866.4292],[746.0791],[-25.236816],[167.01074],[905.9551],[750.60156],[899.33154],[722.4248],[736.54834],[-14.674805],[661.2632],[92.625],[8.306641],[202.93408],[775.37305],[406.03564],[-27.43164],[260.95996],[314.00293],[965.7197],[375.3789],[-24.838379],[-167.14014],[307.00293],[111.40283],[925.89355],[60.36377],[2255.4058],[194.2168],[1103.5752],[578.05176],[578.05176],[638.3164],[380.18848],[208.71436],[-134.90479],[802.2422],[397.82812],[309.708],[312.1001],[717.16455],[94.35254],[827.67285],[-88.640625],[250.97852],[-422.7959],[208.30762],[599.04834],[814.33154],[664.42236],[107.68164],[1273.77],[-90.43164],[755.4292],[572.1284],[232.35889],[591.3164],[221.97852],[948.26074],[1409.5972],[331.34375],[5.2182617],[-203.62451],[828.08936],[905.7368],[-507.58838],[763.2212],[506.7627],[-245.69727],[-372.9668],[-748.938],[-305.9619],[-61.026367],[172.99072],[-785.68555],[623.18506],[999.3174],[695.45654],[-924.6343],[2701.605],[1296.333],[-148.69336],[271.18848],[426.53613],[874.05615],[1404.1045],[867.146],[1056.9883],[-124.0459],[744.25635],[749.61475],[224.04785],[-334.01025],[414.16113],[-804.938],[801.9961],[17.934082],[551.58594],[341.3872],[435.93066],[1510.7109],[-103.21582],[-147.0459],[481.3579],[848.35547],[-545.88086],[977.50195],[1109.9746],[935.3174],[132.37451],[301.60596],[1003.78516],[-22.125977],[495.71973],[-44.013184],[630.9922],[433.12842],[745.2954],[152.41357],[606.4292],[668.3198],[289.6543],[547.6162],[1315.7988],[724.0005],[-212.0459],[-151.78174],[722.25195],[275.02588],[741.3135],[483.18506],[804.0571],[962.3745],[391.53467],[603.4302],[9.365723],[853.3174],[1059.1548],[493.13232],[2847.2505],[798.3003],[-1027.1084],[627.1758],[748.8164],[914.78516],[1322.3677],[495.60645],[800.8838],[542.9922],[834.1626],[519.4282],[592.61475],[1653.2544],[453.88672],[851.84326],[194.77002],[762.5845],[581.25635],[390.54834],[-391.10303],[819.3418],[970.8418],[2009.1841],[335.8413],[868.63574],[204.21387],[420.13232],[1393.8433],[770.5752],[913.69824],[630.3135],[-97.93994],[313.71973],[579.9961],[-197.21143],[1121.1079],[2374.8496],[843.09814],[-28.586426],[673.4453],[1204.5835],[43.200684],[640.10596],[1310.2212],[-257.64746],[700.5791],[446.23877],[741.0576],[1006.00146],[215.9414],[421.9922],[-230.21143],[-289.20117],[-51.69873],[233.15771],[562.3135],[324.21484],[118.15918],[524.0005],[-412.0459],[1300.9414],[1305.3296]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"resid","type":"\"float\"","metadata":"{}"}],"overflow":true,"aggData":[[-9840.82451171875,1],[-9125.12818359375,1],[-8588.3559375,1],[-8051.58369140625,1],[-7872.659609375,2],[-7335.88736328125,1],[-6441.266953125,1],[-5725.570625,1],[-5546.6465429687505,2],[-5367.722460937501,2],[-4830.9502148437505,3],[-4652.0261328125,1],[-4473.10205078125,4],[-4294.17796875,3],[-4115.25388671875,8],[-3936.3298046875,4],[-3757.40572265625,10],[-3578.481640625,14],[-3399.5575585937504,12],[-3220.6334765625,17],[-3041.70939453125,25],[-2862.7853125,17],[-2683.8612304687504,20],[-2504.9371484375,23],[-2326.01306640625,20],[-2147.088984375,26],[-1968.16490234375,32],[-1789.2408203125,51],[-1610.31673828125,65],[-1431.39265625,70],[-1252.46857421875,76],[-1073.5444921875,98],[-894.62041015625,140],[-715.696328125,178],[-536.77224609375,220],[-357.8481640625,232],[-178.92408203125,296],[0.0,340],[178.92408203125,408],[357.8481640625,369],[536.77224609375,334],[715.696328125,299],[894.62041015625,183],[1073.5444921875,116],[1252.46857421875,87],[1431.39265625,36],[1610.31673828125,26],[1789.2408203125,18],[1968.16490234375,20],[2147.088984375,10],[2326.01306640625,9],[2504.9371484375,8],[2683.8612304687504,9],[2862.7853125,6],[3041.70939453125,3],[3220.6334765625,3],[3399.5575585937504,5],[3578.481640625,1],[3757.40572265625,3],[3936.3298046875,3],[4115.25388671875,1],[4294.17796875,2],[4473.10205078125,2],[4652.0261328125,3],[5367.722460937501,1],[5725.570625,1],[5904.49470703125,1],[6262.342871093751,1],[7335.88736328125,1],[8051.58369140625,1]],"aggSchema":[{"name":"__DATABRICKS_INTERNAL_HISTOGRAM_BIN_FIELD__","type":"\"double\"","metadata":"{\"aggRole\":\"groupBy\"}"},{"name":"resid","type":"\"float\"","metadata":"{\"aggRole\":\"agg\"}"}],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"histogram","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1492492960958,"submitTime":1492492953400,"finishTime":1492492964033,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"histogram","width":"632","height":"456","xColumns":[],"yColumns":["resid"],"pivotColumns":[],"pivotAggregation":"sum","customPlotOptions":{"histogram":[{"key":"bins","value":"100"}]},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d57892f4-e08c-44de-aad2-94cbf1bfa1e2"},{"version":"CommandV1","origId":2580593937400043,"guid":"5f34f4fa-7519-42c2-88a0-d0c7b75d76fb","subtype":"command","commandType":"auto","position":6.9609375,"command":"display(data.sample(False, 0.01))","commandVersion":0,"state":"finished","results":{"type":"table","data":[["Ideal","F",0.53,"IF",2802,3719.6575,917.6575],["Ideal","E",0.74,"SI1",2872,3315.4106,443.41064],["Premium","F",0.71,"VS1",2879,3800.2407,921.2407],["Very Good","H",0.74,"VVS2",2944,3784.6394,840.6394],["Good","E",0.7,"VS1",2973,3629.3245,656.32446],["Ideal","G",0.71,"VVS2",2978,4364.251,1386.251],["Good","E",0.57,"VVS1",2990,3227.0466,237.04663],["Very Good","F",0.83,"SI1",3010,3875.2905,865.2905],["Ideal","E",0.78,"SI1",3014,3707.638,693.63794],["Very Good","G",0.7,"VVS2",3039,4068.5671,1029.5671],["Very Good","J",0.9,"SI1",3061,1934.4337,-1126.5663],["Good","D",0.75,"SI1",3078,3172.3274,94.32739],["Ideal","E",0.61,"VVS1",3084,4075.029,991.02905],["Premium","D",0.81,"SI1",3135,3958.532,823.532],["Ideal","F",0.73,"VVS2",3193,4890.362,1697.3618],["Very Good","E",0.75,"VS2",3206,3993.5767,787.57666],["Very Good","I",0.9,"VS2",3209,3699.1736,490.17358],["Fair","J",1.03,"SI2",3246,1410.3147,-1835.6853],["Good","F",0.9,"SI2",3267,3264.6062,-2.3937988],["Ideal","I",1.24,"SI2",3312,5414.0425,2102.0425],["Ideal","F",0.74,"VS1",3340,4352.3027,1012.30273],["Good","G",0.91,"SI1",3344,4071.62,727.6201],["Very Good","D",0.9,"SI2",3371,3862.3538,491.35376],["Very Good","G",0.8,"VS1",3381,4413.0195,1032.0195],["Premium","E",1.04,"SI2",3392,4960.2695,1568.2695],["Premium","H",1.01,"SI2",3394,3534.943,140.94312],["Premium","D",0.91,"SI2",3403,3900.1462,497.14624],["Ideal","F",0.71,"VS2",3405,3673.9727,268.97266],["Ideal","E",1.02,"SI2",3455,5022.048,1567.0479],["Ideal","G",0.77,"VS2",3544,3932.3167,388.31665],["Ideal","E",0.76,"SI1",3584,3511.5244,-72.475586],["Very Good","H",0.9,"SI1",3643,3555.5366,-87.46338],["Premium","G",1.02,"SI2",3656,4309.155,653.1548],["Premium","J",1.21,"VS2",3694,5691.667,1997.667],["Very Good","E",0.72,"VVS2",3719,4719.6816,1000.68164],["Good","H",0.9,"SI1",3730,3297.4084,-432.59155],["Fair","F",1.0,"SI2",3740,3743.3987,3.3986816],["Very Good","H",0.91,"SI1",3771,3653.5933,-117.40674],["Fair","G",1.01,"SI2",3816,3511.4587,-304.54126],["Premium","J",1.0,"VVS2",3864,4652.7495,788.7495],["Fair","D",1.01,"SI2",3871,4181.075,310.0752],["Very Good","I",1.01,"SI1",3888,4000.062,112.06201],["Very Good","F",0.91,"SI1",3936,4659.745,723.7451],["Ideal","I",0.91,"VS1",3954,4379.0176,425.01758],["Ideal","D",1.02,"SI2",4044,5236.6626,1192.6626],["Premium","I",1.12,"SI1",4077,5018.423,941.42285],["Premium","H",1.05,"SI2",4116,3927.1704,-188.82959],["Premium","H",1.0,"SI1",4144,4475.8403,331.84033],["Good","H",0.9,"VS2",4156,4075.145,-80.85498],["Very Good","F",1.08,"SI2",4167,5287.7573,1120.7573],["Very Good","H",1.0,"SI2",4172,3497.1506,-674.84937],["Good","D",0.9,"SI1",4193,4643.1797,450.1797],["Ideal","I",1.03,"VS1",4199,5555.699,1356.6992],["Premium","F",0.84,"VVS2",4243,5711.095,1468.0952],["Very Good","F",1.0,"SI2",4255,4503.3027,248.30273],["Premium","G",1.04,"SI2",4277,4505.2686,228.26855],["Premium","H",1.19,"SI2",4332,5299.966,967.9658],["Premium","H",1.13,"SI2",4350,4711.625,361.625],["Good","D",1.1,"SI2",4361,5565.362,1204.3618],["Premium","E",1.01,"SI1",4399,5705.053,1306.0532],["Good","G",1.1,"SI2",4457,4895.7456,438.7456],["Ideal","H",1.1,"SI2",4537,4675.346,138.34619],["Premium","D",1.25,"SI2",4543,7234.078,2691.0781],["Very Good","G",1.01,"SI1",4588,5310.3164,722.3164],["Ideal","H",1.06,"SI1",4602,5322.0728,720.07275],["Very Good","H",1.02,"SI1",4604,4732.2183,128.21826],["Ideal","G",1.08,"SI2",4627,5155.387,528.3872],["Premium","J",1.21,"VS1",4675,6075.827,1400.8271],["Premium","H",1.13,"SI1",4689,5750.579,1061.5791],["Ideal","E",0.81,"VS1",4764,5163.7046,399.7046],["Premium","J",1.2,"SI1",4778,4815.874,37.874023],["Premium","E",1.01,"SI2",4790,4666.099,-123.90088],["Premium","E",1.0,"SI1",4805,5606.996,801.9961],["Premium","H",1.01,"SI1",4836,4573.897,-262.10303],["Fair","J",1.2,"SI1",4838,4116.2344,-721.7656],["Premium","F",0.9,"VS2",4838,5279.1606,441.16064],["Premium","H",0.9,"VVS1",4890,5529.6294,639.6294],["Premium","I",1.17,"SI1",4914,5508.707,594.70703],["Good","I",1.26,"SI2",4953,5154.4004,201.40039],["Very Good","J",1.23,"VS2",4960,5948.0454,988.0454],["Premium","H",1.2,"SI2",4973,5398.0225,425.02246],["Ideal","J",1.24,"SI1",5000,5465.9927,465.99268],["Premium","G",1.01,"SI1",5006,5250.052,244.05176],["Premium","J",1.26,"VS2",5015,6181.951,1166.9512],["Premium","J",2.0,"I1",5051,8722.504,3671.504],["Premium","H",1.22,"SI1",5063,6633.0903,1570.0903],["Premium","D",1.03,"SI2",5076,5076.828,0.828125],["Premium","D",1.0,"SI1",5096,5821.6113,725.6113],["Ideal","J",1.15,"VS2",5125,5361.218,236.21777],["Ideal","G",1.16,"SI2",5206,5939.842,733.8418],["Premium","E",1.01,"SI1",5226,5705.053,479.05322],["Very Good","H",1.07,"VS2",5254,6000.239,746.2388],["Very Good","G",1.13,"SI1",5280,6486.998,1206.998],["Very Good","H",1.14,"SI1",5367,5908.9,541.8999],["Premium","H",1.2,"SI2",5376,5398.0225,22.02246],["Very Good","E",1.01,"SI1",5461,5765.3174,304.31738],["Premium","H",1.03,"VS1",5523,5931.907,408.90723],["Premium","F",1.05,"SI1",5557,5972.2764,415.27637],["Premium","D",1.01,"SI1",5599,5919.6685,320.66846],["Premium","I",1.23,"VS2",5622,6874.784,1252.7842],["Good","G",1.0,"VS2",5645,5731.868,86.868164],["Premium","E",1.01,"SI1",5646,5705.053,59.053223],["Premium","J",1.21,"VVS2",5674,6711.943,1037.9429],["Ideal","H",1.21,"SI2",5692,5753.971,61.97119],["Ideal","I",1.2,"VS2",5699,6838.5054,1139.5054],["Good","G",1.01,"VS2",5701,5829.925,128.9248],["Premium","E",1.01,"SI1",5749,5705.053,-43.946777],["Premium","D",1.08,"SI1",5758,6606.066,848.0659],["Good","G",1.02,"VS2",5816,5927.9814,111.981445],["Ideal","G",1.02,"VS2",5915,6383.737,468.73682],["Ideal","G",0.92,"VS2",5989,5403.169,-585.83105],["Ideal","I",1.17,"VS1",6013,6928.4946,915.4946],["Very Good","F",1.0,"VS1",6021,6704.153,683.15283],["Ideal","D",1.02,"SI1",6158,6275.6167,117.6167],["Good","D",1.0,"VS2",6163,6401.4844,238.48438],["Premium","G",1.01,"VS1",6163,6411.948,248.94824],["Ideal","I",1.35,"SI1",6199,7531.621,1332.6211],["Premium","I",1.3,"VS2",6246,7561.182,1315.1821],["Very Good","F",1.01,"VS2",6257,6418.05,161.0498],["Premium","H",1.62,"SI2",6350,9516.409,3166.4092],["Good","E",1.02,"VS2",6462,6382.983,-79.01709],["Good","F",1.02,"VS2",6479,6257.9785,-221.02148],["Premium","G",1.08,"VS2",6532,6714.186,182.18604],["Premium","G",1.08,"VS2",6532,6714.186,182.18604],["Very Good","G",1.21,"SI1",6549,7271.4526,722.45264],["Premium","H",1.29,"SI1",6588,7319.488,731.4878],["Ideal","F",1.02,"VS2",6597,6713.734,116.73389],["Very Good","D",1.22,"SI2",6607,7000.172,393.17188],["Premium","F",1.0,"VS2",6608,6259.7285,-348.27148],["Very Good","G",1.01,"VS1",6613,6472.2124,-140.7876],["Very Good","E",1.01,"VS2",6666,6543.054,-122.9458],["Very Good","F",1.03,"VS1",6733,6998.323,265.32324],["Ideal","E",1.11,"SI1",6737,6943.5127,206.5127],["Premium","I",1.31,"VS2",6921,7659.239,738.2388],["Premium","E",1.05,"VS2",6930,6875.017,-54.98291],["Very Good","G",1.01,"VS1",6936,6472.2124,-463.7876],["Premium","F",1.56,"SI2",6971,9934.22,2963.2197],["Very Good","J",1.45,"VS2",6980,8105.295,1125.2949],["Very Good","G",1.07,"VS1",6998,7060.5537,62.55371],["Ideal","I",1.33,"VS2",7186,8113.244,927.24414],["Ideal","G",1.13,"VS2",7290,7462.362,172.36182],["Ideal","D",0.9,"VS1",7393,6260.831,-1132.169],["Very Good","J",1.56,"SI1",7424,8406.184,982.1836],["Premium","F",1.02,"VS1",7539,6840.002,-698.99805],["Ideal","E",1.01,"VS1",7565,7124.841,-440.15918],["Very Good","J",1.54,"VS2",7695,8987.807,1292.8066],["Very Good","H",1.27,"VS2",7715,7961.3755,246.37549],["Very Good","G",1.0,"VS2",7743,5989.996,-1753.0039],["Premium","E",1.03,"VS1",7778,7063.063,-714.937],["Ideal","H",1.51,"SI1",7780,9734.63,1954.6299],["Ideal","G",1.08,"VS1",7925,7356.238,-568.7622],["Very Good","G",1.19,"VS1",7989,8237.235,248.23535],["Very Good","H",2.01,"I1",8104,10501.928,2397.9277],["Ideal","H",1.26,"SI1",8110,7283.209,-826.791],["Ideal","F",1.01,"VS1",8133,6999.837,-1133.1631],["Ideal","J",1.54,"VS1",8207,9569.594,1362.5938],["Premium","F",1.52,"SI2",8342,9541.992,1199.9922],["Fair","I",1.51,"SI1",8355,8142.999,-212.00098],["Good","J",1.5,"VS1",8467,8721.611,254.61133],["Ideal","I",1.6,"SI2",8530,8944.088,414.0879],["Very Good","H",1.28,"VS1",8645,8443.592,-201.4082],["Premium","J",1.74,"SI2",8690,9071.988,381.98828],["Premium","I",1.64,"SI1",8716,10117.377,1401.377],["Premium","J",1.55,"VS1",8749,9409.759,660.7588],["Ideal","G",1.1,"VS1",8775,7552.351,-1222.6489],["Premium","F",1.2,"VS2",8796,8220.865,-575.13477],["Good","H",1.7,"SI1",9158,11141.954,1983.9541],["Very Good","H",1.5,"VS1",9173,10600.842,1427.8418],["Very Good","I",1.51,"VS1",9343,10064.799,721.7988],["Premium","G",1.35,"VS2",9471,9361.721,-109.2793],["Very Good","E",1.51,"SI2",9513,9629.204,116.2041],["Very Good","E",1.2,"VS2",9529,8406.134,-1122.8662],["Ideal","J",1.6,"VS2",9681,9773.774,92.774414],["Premium","G",1.51,"SI1",9710,10152.893,442.89258],["Premium","F",1.0,"VVS1",9724,7516.349,-2207.651],["Ideal","G",1.13,"VVS1",9872,8718.982,-1153.0176],["Premium","J",1.61,"IF",10165,11424.647,1259.6475],["Very Good","I",1.51,"VS1",10215,10064.799,-150.20117],["Premium","F",1.6,"SI2",10286,10326.447,40.447266],["Premium","H",1.7,"VVS2",10337,13137.829,2800.829],["Ideal","D",1.15,"VS2",10546,8328.092,-2217.9082],["Ideal","G",1.26,"VVS2",10556,9757.376,-798.624],["Premium","G",1.52,"VS1",10640,11412.846,772.8457],["Ideal","F",1.05,"VVS1",10872,8264.525,-2607.4746],["Ideal","I",1.5,"VVS2",10931,10800.485,-130.51465],["Premium","G",1.51,"SI1",10951,10152.893,-798.1074],["Premium","G",1.22,"IF",11104,9897.689,-1206.3105],["Ideal","I",1.52,"VVS1",11168,11232.944,64.944336],["Fair","H",1.51,"VS1",11263,9938.995,-1324.0049],["Premium","H",1.5,"VS2",11322,10156.418,-1165.582],["Very Good","G",1.28,"VVS2",11478,9755.862,-1722.1377],["Very Good","I",1.73,"SI1",11554,11060.153,-493.84668],["Premium","E",1.51,"SI1",11565,10607.894,-957.10645],["Ideal","E",1.68,"SI2",11781,11493.798,-287.20215],["Ideal","G",1.51,"VS2",12210,11188.521,-1021.4785],["Premium","E",1.53,"SI1",12499,10804.008,-1694.9922],["Very Good","J",2.02,"SI1",12598,12916.797,318.79688],["Good","G",2.0,"SI2",12654,13720.859,1066.8594],["Ideal","E",1.55,"SI1",13171,11258.013,-1912.9873],["Very Good","D",1.01,"VVS1",13312,8014.2896,-5297.7104],["Premium","H",2.01,"VS2",13342,15157.315,1815.3154],["Premium","I",1.91,"SI1",13367,12764.911,-602.08887],["Ideal","D",1.29,"VS1",13485,10085.047,-3399.9531],["Fair","J",2.01,"VS2",13744,12836.573,-907.42676],["Good","F",1.51,"VS2",13819,11062.763,-2756.2373],["Premium","G",1.64,"VS2",14201,12205.368,-1995.6318],["Premium","J",2.05,"VS1",14224,14312.6,88.59961],["Premium","F",1.51,"VS2",14247,11260.626,-2986.374],["Premium","H",2.07,"SI1",14476,14967.92,491.91992],["Ideal","G",1.52,"VS1",14787,11670.737,-3116.2627],["Premium","F",1.62,"VS2",14961,12339.251,-2621.749],["Very Good","F",1.53,"VS1",15079,11901.164,-3177.836],["Premium","F",1.51,"VS2",15253,11260.626,-3992.374],["Ideal","J",2.24,"VS2",15316,16049.411,733.41113],["Good","I",2.01,"SI1",15371,13547.616,-1823.3838],["Ideal","J",2.2,"VS2",15384,15657.184,273.1836],["Premium","I",2.1,"SI1",15615,14627.991,-987.0088],["Premium","H",2.01,"SI2",15773,13340.625,-2432.375],["Very Good","G",2.02,"SI2",15877,14175.101,-1701.8994],["Premium","I",2.05,"VS2",15897,14915.443,-981.55664],["Premium","G",2.01,"SI2",15977,14016.779,-1960.2207],["Premium","E",1.5,"VS1",16023,11671.733,-4351.2666],["Premium","H",2.58,"SI2",16195,18929.863,2734.8633],["Premium","J",2.42,"SI2",16198,15739.852,-458.14844],["Premium","E",1.87,"SI1",16232,14137.939,-2094.0605],["Ideal","G",1.63,"VS1",16241,12749.362,-3491.6377],["Ideal","H",2.24,"SI2",16300,15853.823,-446.17676],["Good","I",2.01,"VS2",16304,14325.353,-1978.6475],["Very Good","G",2.13,"SI2",16462,15253.726,-1208.2744],["Very Good","I",2.22,"SI2",16547,14825.983,-1721.0166],["Ideal","F",1.69,"VS2",16789,13283.541,-3505.459],["Premium","G",1.7,"VVS2",17228,13813.984,-3414.0156],["Premium","D",2.05,"SI1",17776,16117.577,-1658.4229],["Very Good","H",2.02,"SI1",18236,14537.9,-3698.0996],["Ideal","F",1.62,"VS2",18281,12597.143,-5683.8574],["Ideal","D",2.01,"SI2",18674,14944.288,-3729.712],["Ideal","F",0.34,"VVS2",1003,1066.1459,63.145874],["Very Good","D",0.5,"SI2",1015,-59.918964,-1074.919],["Premium","F",0.42,"VS1",1031,956.59296,-74.40704],["Premium","I",0.45,"VS1",1035,-389.48773,-1424.4878],["Premium","D",0.42,"SI1",1040,134.31604,-905.68396],["Ideal","E",0.44,"SI1",1040,373.70618,-666.2938],["Ideal","D",0.3,"VVS2",1041,1013.53796,-27.462036],["Premium","G",0.31,"VVS1",1046,420.43182,-625.5682],["Very Good","H",0.41,"VS1",1061,-87.35124,-1148.3512],["Ideal","E",0.35,"VS1",1063,653.0911,-409.90887],["Ideal","E",0.35,"VS1",1063,653.0911,-409.90887],["Premium","D",0.38,"VS1",1067,903.98505,-163.01495],["Ideal","F",0.41,"VS1",1076,1116.4279,40.427856],["Ideal","E",0.41,"VS1",1076,1241.432,165.432],["Premium","G",0.42,"VS2",1087,242.43626,-844.5637],["Very Good","H",0.54,"SI2",1099,-1013.4628,-2112.463],["Very Good","I",0.51,"SI2",1105,-1941.7327,-3046.7327],["Premium","D",0.51,"SI2",1109,-22.126537,-1131.1266],["Premium","E",0.38,"VS2",1112,305.2101,-806.7899],["Ideal","F",0.33,"IF",1114,1758.5211,644.5211],["Ideal","F",0.31,"IF",1122,1562.4075,440.40747],["Ideal","E",0.4,"VS1",1125,1143.3752,18.375244],["Premium","G",0.36,"IF",1148,1464.803,316.80298],["Premium","H",0.54,"SI1",1154,-34.773304,-1188.7733],["Ideal","D",0.52,"SI2",1158,333.82196,-824.17804],["Ideal","F",0.4,"VVS1",1168,1890.8318,722.8318],["Ideal","E",0.38,"VVS2",1176,1583.3773,407.37732],["Premium","D",0.42,"VS1",1179,1296.2123,117.21228],["Premium","F",0.41,"VVS2",1192,1494.6519,302.65186],["Very Good","G",0.59,"SI2",1210,152.97609,-1057.0239],["Ideal","D",0.34,"VVS1",1211,1642.1102,431.11023],["Ideal","J",0.65,"SI1",1214,-319.35944,-1533.3594],["Ideal","F",0.36,"IF",1215,2052.6917,837.69165],["Fair","G",0.5,"VS1",1234,711.4112,-522.5888],["Good","D",0.5,"SI1",1235,720.90686,-514.09314],["Ideal","G",0.42,"VVS1",1245,1756.9485,511.9485],["Very Good","E",0.6,"SI2",1250,706.03406,-543.96594],["Premium","H",0.51,"SI1",1250,-328.94376,-1578.9437],["Very Good","J",0.59,"VS2",1257,-327.59113,-1584.5911],["Very Good","H",0.5,"VS2",1262,411.00037,-850.99963],["Ideal","F",0.55,"SI2",1263,288.37308,-974.62695],["Premium","D",0.41,"VVS2",1356,1834.2712,478.27124],["Very Good","E",0.52,"SI1",1369,960.5334,-408.4666],["Ideal","G",0.45,"IF",1377,2605.206,1228.206],["Ideal","H",0.5,"VS1",1384,992.7874,-391.2126],["Premium","E",0.53,"SI1",1395,998.32587,-396.67413],["Very Good","D",0.51,"SI1",1420,1077.0918,-342.9082],["Premium","H",0.53,"VS2",1428,644.90643,-783.09357],["Ideal","F",0.57,"SI2",1432,484.48672,-947.5133],["Ideal","E",0.51,"SI1",1437,1060.1039,-376.89612],["Very Good","D",0.51,"SI1",1569,1077.0918,-491.9082],["Premium","F",0.57,"SI1",1571,1265.549,-305.45105],["Very Good","D",0.53,"SI1",1576,1273.2054,-302.79456],["Very Good","H",0.51,"VVS2",1577,1529.3326,-47.66736],["Very Good","E",0.52,"VS1",1601,2122.4297,521.4297],["Ideal","H",0.53,"VS2",1604,902.7981,-701.2019],["Ideal","E",0.5,"VS2",1614,1739.7836,125.78357],["Ideal","E",0.52,"VS2",1617,1935.8972,318.89722],["Very Good","E",0.55,"VS2",1629,2032.4404,403.44043],["Premium","D",0.53,"SI1",1631,1212.941,-418.05896],["Premium","I",0.69,"SI1",1636,801.97955,-834.02045],["Very Good","G",0.57,"VS2",1641,1773.5529,132.55286],["Ideal","G",0.51,"VS1",1656,1766.999,110.99902],["Ideal","F",0.54,"VS2",1662,2007.0067,345.0067],["Premium","E",0.51,"VS2",1662,1579.9487,-82.05127],["Very Good","D",0.52,"VS2",1664,1952.8851,288.88513],["Ideal","E",0.55,"VS2",1667,2230.0676,563.0676],["Ideal","E",0.55,"SI1",1668,1452.3312,-215.66882],["Ideal","D",0.52,"VS2",1677,2150.5125,473.51245],["Ideal","D",0.5,"VS2",1678,1954.3988,276.3988],["Premium","E",0.5,"VS2",1684,1481.892,-202.10803],["Ideal","E",0.57,"VS2",1698,2426.1814,728.1814],["Ideal","E",0.56,"SI1",1698,1550.388,-147.61206],["Very Good","D",0.5,"VS2",1712,1756.7715,44.771484],["Premium","D",0.51,"VS2",1716,1794.564,78.563965],["Premium","D",0.54,"SI1",1720,1310.9978,-409.0022],["Ideal","E",0.52,"VS2",1743,1935.8972,192.89722],["Ideal","F",0.72,"SI2",1743,1955.339,212.33899],["Very Good","H",0.51,"VVS1",1744,1765.6777,21.677734],["Ideal","I",0.5,"VVS1",1747,1231.1488,-515.8512],["Ideal","G",0.54,"VS1",1754,2061.1694,307.16943],["Very Good","E",0.52,"VS1",1767,2122.4297,355.4297],["Premium","F",0.54,"VS1",1773,2133.275,360.2749],["Ideal","D",0.63,"SI1",1779,2451.401,672.4009],["Ideal","D",0.59,"SI1",1783,2059.1736,276.17358],["Ideal","D",0.51,"VS2",1787,2052.4556,265.45557],["Premium","E",0.58,"SI1",1794,1488.61,-305.39],["Ideal","D",0.5,"VS2",1808,1954.3988,146.3988],["Ideal","D",0.55,"SI1",1819,1666.9463,-152.05371],["Very Good","E",0.68,"SI2",1821,1490.4885,-330.51147],["Good","H",0.61,"VVS2",1821,2251.7727,430.7727],["Ideal","E",0.43,"VVS1",1827,2310.0063,483.00635],["Ideal","J",0.7,"SI2",1832,-868.0293,-2700.0293],["Ideal","J",0.72,"SI1",1864,367.03827,-1496.9617],["Premium","E",0.56,"VS2",1864,2070.233,206.23291],["Premium","F",0.58,"VS2",1869,2141.3423,272.3423],["Ideal","G",0.52,"VVS2",1878,2501.1716,623.17163],["Good","G",0.51,"VVS2",1885,1947.3594,62.359375],["Ideal","F",0.55,"VS1",1890,2489.2234,599.2234],["Ideal","G",0.52,"VVS2",1911,2501.1716,590.17163],["Very Good","F",0.7,"SI2",1940,1561.598,-378.40198],["Ideal","G",0.53,"VVS2",1948,2599.2285,651.2285],["Ideal","G",0.51,"VVS1",1963,2639.46,676.45996],["Ideal","F",0.6,"VS2",1970,2595.3477,625.34766],["Ideal","J",0.7,"SI1",1974,170.92464,-1803.0753],["Ideal","D",0.59,"VS2",1978,2836.9102,858.91016],["Very Good","F",0.5,"VVS2",2003,2437.4277,434.42773],["Premium","F",0.56,"SI1",2016,1167.4922,-848.5078],["Very Good","F",0.51,"VVS2",2041,2535.4844,494.48438],["Ideal","E",0.54,"VS1",2041,2516.1707,475.17065],["Fair","F",0.62,"VVS2",2088,2854.2058,766.2058],["Very Good","D",0.61,"VS1",2096,3219.5562,1123.5562],["Very Good","G",1.01,"I1",2108,1372.4009,-735.5991],["Very Good","E",0.5,"VVS1",2148,2798.7769,650.77686],["Very Good","F",0.63,"VS1",2149,3076.0505,927.05054],["Ideal","F",0.5,"VVS2",2160,2635.055,475.05493],["Fair","H",0.7,"SI1",2176,834.4964,-1341.5037],["Ideal","E",0.63,"VS2",2205,3014.5222,809.5222],["Premium","H",1.01,"I1",2206,635.9816,-1570.0183],["Ideal","H",0.57,"IF",2210,3105.733,895.7329],["Very Good","G",0.66,"VVS2",2211,3676.3398,1465.3398],["Ideal","G",0.71,"SI1",2233,2566.239,333.239],["Ideal","G",0.52,"IF",2267,3291.6038,1024.6038],["Good","G",0.66,"VS1",2275,2782.096,507.09595],["Very Good","E",0.74,"SI2",2282,2078.8296,-203.17041],["Ideal","E",0.5,"VVS2",2297,2760.059,463.05908],["Very Good","J",0.79,"VS2",2300,1633.5453,-666.4547],["Premium","E",0.7,"SI1",2310,2665.2917,355.29175],["Very Good","E",0.51,"VVS2",2320,2660.4885,340.48853],["Ideal","D",0.59,"VS2",2352,2836.9102,484.91016],["Fair","D",0.7,"SI1",2352,2180.2676,-171.73242],["Very Good","G",0.7,"VS2",2353,3048.2915,695.2915],["Very Good","D",0.3,"VVS2",2366,815.91064,-1550.0894],["Ideal","G",0.75,"SI2",2378,1919.5125,-458.48755],["Very Good","H",0.7,"VS1",2389,2756.2964,367.2964],["Ideal","F",0.62,"VS1",2406,3175.621,769.6211],["Very Good","D",0.7,"SI1",2409,2940.1714,531.1714],["Fair","I",0.81,"VS2",2414,2056.7585,-357.24146],["Premium","F",0.7,"SI1",2415,2540.2876,125.2876],["Good","H",0.7,"VS1",2421,2498.1685,77.16846],["Good","E",0.67,"VS1",2427,3335.1538,908.1538],["Premium","F",0.74,"SI1",2452,2932.515,480.5149],["Good","F",0.91,"SI2",2461,3362.663,901.6631],["Premium","I",0.91,"SI1",2475,2959.2295,484.2295],["Ideal","G",0.7,"SI1",2478,2468.1824,-9.817627],["Very Good","G",0.6,"VVS1",2485,3324.344,839.344],["Ideal","H",0.71,"VS1",2487,3051.9805,564.98047],["Very Good","E",0.5,"VVS1",2495,2798.7769,303.77686],["Very Good","E",0.51,"VVS1",2501,2896.8337,395.83374],["Very Good","D",0.53,"VVS2",2542,3071.2175,529.2175],["Ideal","H",0.71,"VS2",2572,2667.8208,95.8208],["Very Good","E",0.7,"SI1",2604,2725.5562,121.55615],["Ideal","I",0.71,"VVS1",2606,3290.342,684.34204],["Ideal","F",0.78,"SI2",2622,2543.68,-78.32007],["Premium","F",0.7,"VS2",2648,3318.0242,670.0242],["Premium","E",0.7,"VS2",2673,3443.0283,770.0283],["Premium","I",0.82,"VS2",2716,2854.4548,138.45483],["Premium","E",0.77,"SI2",2723,2312.7356,-410.2644],["Fair","G",0.84,"VS1",2724,4045.343,1321.343],["Premium","D",0.72,"SI1",2732,3076.0205,344.0205],["Premium","E",0.71,"SI1",2743,2763.3486,20.348633],["Premium","E",0.71,"SI1",2743,2763.3486,20.348633]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"cut","type":"\"string\"","metadata":"{}"},{"name":"color","type":"\"string\"","metadata":"{}"},{"name":"carat","type":"\"double\"","metadata":"{}"},{"name":"clarity","type":"\"string\"","metadata":"{}"},{"name":"price","type":"\"integer\"","metadata":"{}"},{"name":"pred","type":"\"float\"","metadata":"{}"},{"name":"resid","type":"\"float\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1492492964039,"submitTime":1492492953413,"finishTime":1492492965492,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"scatterPlot","width":"497","height":"329","xColumns":[],"yColumns":["pred","price"],"pivotColumns":[],"pivotAggregation":"avg","customPlotOptions":{"scatterPlot":[{"key":"loess","value":false},{"key":"bandwidth","value":"0.3"}]},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"cf7c746a-e19a-45a8-a981-7708007536f2"},{"version":"CommandV1","origId":2580593937400044,"guid":"0b9da4e3-f8a9-4f92-ac3a-82257142712f","subtype":"command","commandType":"auto","position":7.4609375,"command":"from pyspark.sql.functions import lit\navg_price = data.select(mean(data['price'])).collect()[0][0]\ndata = data.withColumn(\"mean_resid\", data['pred'] - lit(avg_price))\nnp.sqrt(data.select(mean(data['mean_resid'] * data['mean_resid'])).collect()[0][0])","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">87</span><span class=\"ansired\">]: </span>3891.2572090876479\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1492492965497,"submitTime":1492492953426,"finishTime":1492492966471,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b62153f4-a898-48f2-84b1-d3c1210c0f5f"}],"dashboards":[],"guid":"04ff7d40-737e-4935-94e7-b24df94bd2a5","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}};</script>
<script
 src="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/js/notebook-main.js"
 onerror="window.mainJsLoadError = true;"></script>
</head>
<body>
  <script>
if (window.mainJsLoadError) {
  var u = 'https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/js/notebook-main.js';
  var b = document.getElementsByTagName('body')[0];
  var c = document.createElement('div');
  c.innerHTML = ('<h1>Network Error</h1>' +
    '<p><b>Please check your network connection and try again.</b></p>' +
    '<p>Could not load a required resource: ' + u + '</p>');
  c.style.margin = '30px';
  c.style.padding = '20px 50px';
  c.style.backgroundColor = '#f5f5f5';
  c.style.borderRadius = '5px';
  b.appendChild(c);
}
</script>
</body>
</html>
